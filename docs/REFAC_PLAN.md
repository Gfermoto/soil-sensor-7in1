# План рефакторинга JXCT Soil Sensor (ESP32, PlatformIO)

## Приоритет 1: Простые и безопасные улучшения

- Провести ревизию include/ и src/: удалить неиспользуемые функции, привести к единому стилю.
- Обновить README: добавить разделы по безопасности, OTA, API.
- Сгенерировать и проверить актуальность Doxygen-документации.
- Документировать API (описание эндпоинтов, примеры запросов/ответов, коды ошибок).
- Добавить визуальные индикаторы статуса (WiFi, MQTT, ThingSpeak, датчик) на главную страницу web-интерфейса.
- Улучшить оформление форм и сообщений об ошибках на web-страницах.
- Сделать web-интерфейс адаптивным для мобильных устройств.
- Добавить отображение статуса последней публикации ThingSpeak на web.

## Приоритет 2: Средней сложности, не влияющие на критическую работу

- Вынести все строки и параметры, которые могут меняться, в отдельный файл/секцию (например, для локализации).
- Добавить экспорт/импорт конфигурации (JSON-файл через web).
- Добавить возможность настройки QoS для MQTT через web.
- Добавить отдельную страницу/секцию для OTA (заглушка или stub).
- Добавить unit-тесты для функций форматирования и логики работы с конфигом (если возможно).
- Добавить версионирование API (например, /api/v1/sensor).

## Приоритет 3: Сложные и потенциально рискованные изменения

- Добавить авторизацию на web-интерфейс (минимум — пароль на доступ к настройкам и сервису).
- Реализовать защиту от CSRF для POST-запросов (например, через токены).
- Реализовать полноценную загрузку и обновление прошивки через web-интерфейс (OTA с прогресс-баром и валидацией).
- Для ThingSpeak — добавить обработку ошибок сети и повторные попытки публикации.
- Для MQTT — добавить обработку ошибок сети и информирование пользователя о неудачных публикациях.
- Реализовать возможность получения истории показаний (например, хранить последние N значений в памяти).
- Разделить большие файлы (например, wifi_manager.cpp) на логические модули: web, WiFi, сервисы.
- Добавить краткое руководство пользователя (user manual) в docs.

---

**План составлен на основе QA-аудита.** 