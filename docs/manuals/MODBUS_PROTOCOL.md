# üì° –ü—Ä–æ—Ç–æ–∫–æ–ª Modbus RTU –¥–ª—è JXCT 7-–≤-1

**–î–∞—Ç–∞:** –ò—é–ª—å 2025
**–í–µ—Ä—Å–∏—è:** 3.10.0

**–ê–≤—Ç–æ—Ä:** JXCT Development Team

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ {#Soderzhanie}

- [–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ](#Soderzhanie)
- [–û–±–∑–æ—Ä](#Obzor)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏](#Tehnicheskie-harakteristiki)
  - [–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä—Ç–∞ (UART2)](#Nastroyki-porta-uart2)
  - [–ü–∞—Ä–∞–º–µ—Ç—Ä—ã MODBUS](#Parametry-modbus)
- [–ö–∞—Ä—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤](#Karta-registrov)
  - [–û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è](#Osnovnye-izmereniya)
  - [–°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã](#Sistemnye-registry)
- [–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ—Ç–æ–∫–æ–ª–∞](#Primery-protokola)
  - [1. –ß—Ç–µ–Ω–∏–µ pH –ø–æ—á–≤—ã (—Ä–µ–≥–∏—Å—Ç—Ä 0x0006)](#1-Chtenie-ph-pochvy-registr-0x0006)
  - [2. –ß—Ç–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ—á–≤—ã (—Ä–µ–≥–∏—Å—Ç—Ä 0x0013)](#2-Chtenie-temperatury-pochvy-registr-0x0013)
  - [3. –ß—Ç–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ (NPK)](#3-Chtenie-neskolkih-registrov-npk)
- [–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ESP32](#Shema-podklyucheniya-esp32)
  - [–§–∏–∑–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ](#Fizicheskoe-podklyuchenie)
    - [RS-485 –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å](#rs-485-interfeys)
    - [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ SP3485E](#Podklyuchenie-sp3485e)
    - [–í–∞–∂–Ω–æ—Å—Ç—å —Ä–∞–∑–¥–µ–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è DE –∏ RE](#Vazhnost-razdelnogo-upravleniya-de-i-re)
    - [–í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è](#Vremennye-diagrammy-pereklyucheniya)
  - [–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –¥–∞—Ç—á–∏–∫—É JXCT](#Podklyuchenie-k-datchiku-jxct)
  - [–ü–∏—Ç–∞–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞ (–æ—Ç–¥–µ–ª—å–Ω–æ–µ!)](#Pitanie-datchika-otdelnoe)
- [–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∫–æ–¥–µ ESP32](#Realizatsiya-v-kode-esp32)
  - [–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UART –∏ SP3485E](#Initsializatsiya-uart-i-sp3485e)
  - [–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö](#Chtenie-dannyh)
- [–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –æ—Ç–ª–∞–¥–∫–∞](#Diagnostika-i-otladka)
  - [–ö–æ–¥—ã –æ—à–∏–±–æ–∫ ModbusMaster](#Kody-oshibok-modbusmaster)
  - [–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏](#Proverka-svyazi)
- [–†–∞—Å—á–µ—Ç CRC16](#Raschet-crc16)
- [–¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è](#Tipichnye-problemy-i-resheniya)
  - [1. –¢–∞–π–º–∞—É—Ç –æ—Ç–≤–µ—Ç–∞ (ku8MBResponseTimedOut)](#1-Taymaut-otveta-ku8mbresponsetimedout)
  - [2. –û—à–∏–±–∫–∞ CRC (ku8MBInvalidCRC)](#2-Oshibka-crc-ku8mbinvalidcrc)
  - [3. –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –∞–¥—Ä–µ—Å –¥–∞–Ω–Ω—ã—Ö (ku8MBIllegalDataAddress)](#3-Nedopustimyy-adres-dannyh-ku8mbillegaldataaddress)
- [–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö](#Validatsiya-dannyh)
  - [–î–æ–ø—É—Å—Ç–∏–º—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã](#Dopustimye-diapazony)
- [–°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è](#Spravochnaya-informatsiya)
  - [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è](#Dokumentatsiya-proizvoditelya)
  - [–°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞](#Svyazannye-fayly-proekta)
- [–ü–æ–¥–¥–µ—Ä–∂–∫–∞](#Podderzhka)
  - [–°–≤—è–∑—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏](#Svyaz-s-razrabotchikami)
  - [–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã](#Dopolnitelnye-resursy)
  - [–ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏](#Poleznye-ssylki)

---

## üìñ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ {#Soderzhanie}

1. **üìã –û–±–∑–æ—Ä**
2. **üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏**
3. **üìä –ö–∞—Ä—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤**
4. **üîç –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ—Ç–æ–∫–æ–ª–∞**
5. **üîß –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ESP32**
6. **‚ö° –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
7. **üêõ –û—Ç–ª–∞–¥–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞**
8. **üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
9. **üìã –°–≤—è–∑–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**

---

## üìã –û–±–∑–æ—Ä {#Obzor}

–î–∞—Ç—á–∏–∫ JXCT 7-–≤-1 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ—Ç–æ–∫–æ–ª **Modbus RTU** —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å **RS485** –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π –ø–æ—á–≤—ã. –≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–Ω—É—é —Ç–µ—Ö–Ω–∏—á–µ—Å–∫—É—é —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é –ø—Ä–æ—Ç–æ–∫–æ–ª–∞.

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ {#Tehnicheskie-harakteristiki}

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ—Ä—Ç–∞ (UART2) {#Nastroyki-porta-uart2}
```
–ü–∞—Ä–∞–º–µ—Ç—Ä            ‚îÇ –ó–Ω–∞—á–µ–Ω–∏–µ
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏   ‚îÇ 9600 baud
–ë–∏—Ç—ã –¥–∞–Ω–Ω—ã—Ö         ‚îÇ 8 bits
–ß–µ—Ç–Ω–æ—Å—Ç—å            ‚îÇ None (N)
–°—Ç–æ–ø –±–∏—Ç—ã           ‚îÇ 1 bit
–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–º  ‚îÇ None
–§–æ—Ä–º–∞—Ç              ‚îÇ 8N1
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å           ‚îÇ RS485 –ø–æ–ª—É–¥—É–ø–ª–µ–∫—Å
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã MODBUS {#Parametry-modbus}
```
–ü–∞—Ä–∞–º–µ—Ç—Ä                ‚îÇ –ó–Ω–∞—á–µ–Ω–∏–µ
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
–ü—Ä–æ—Ç–æ–∫–æ–ª                ‚îÇ Modbus RTU
–ê–¥—Ä–µ—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞        ‚îÇ 1 (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)
–§—É–Ω–∫—Ü–∏—è —á—Ç–µ–Ω–∏—è          ‚îÇ 0x03 (Read Holding Registers)
–§—É–Ω–∫—Ü–∏—è –∑–∞–ø–∏—Å–∏          ‚îÇ 0x06 (Write Single Register)
–¢–∞–π–º–∞—É—Ç –æ—Ç–≤–µ—Ç–∞          ‚îÇ 1000 –º—Å
–ú–∞–∫—Å–∏–º—É–º –ø–æ–ø—ã—Ç–æ–∫        ‚îÇ 3
–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å               ‚îÇ RS485 –ø–æ–ª—É–¥—É–ø–ª–µ–∫—Å
```

## üìä –ö–∞—Ä—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ {#Karta-registrov}

### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ—Ä–µ–Ω–∏—è {#Osnovnye-izmereniya}
```
–†–µ–≥–∏—Å—Ç—Ä ‚îÇ –ê–¥—Ä–µ—Å ‚îÇ –ü–∞—Ä–∞–º–µ—Ç—Ä           ‚îÇ –§–æ—Ä–º—É–ª–∞        ‚îÇ –ï–¥–∏–Ω–∏—Ü—ã ‚îÇ –î–∏–∞–ø–∞–∑–æ–Ω
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
0x0006  ‚îÇ 6     ‚îÇ pH –ø–æ—á–≤—ã           ‚îÇ –∑–Ω–∞—á–µ–Ω–∏–µ √∑ 100 ‚îÇ pH      ‚îÇ 0.00-14.00
0x0012  ‚îÇ 18    ‚îÇ –í–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã    ‚îÇ –∑–Ω–∞—á–µ–Ω–∏–µ √∑ 10  ‚îÇ %       ‚îÇ 0.0-100.0
0x0013  ‚îÇ 19    ‚îÇ –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –ø–æ—á–≤—ã  ‚îÇ –∑–Ω–∞—á–µ–Ω–∏–µ √∑ 10  ‚îÇ ¬∞C      ‚îÇ -10.0-50.0
0x0015  ‚îÇ 21    ‚îÇ –≠–ª–µ–∫—Ç—Ä–æ–ø—Ä–æ–≤–æ–¥–Ω–æ—Å—Ç—å ‚îÇ –∫–∞–∫ –µ—Å—Ç—å       ‚îÇ ¬µS/cm   ‚îÇ 0-20000
0x001E  ‚îÇ 30    ‚îÇ –ê–∑–æ—Ç (N)           ‚îÇ –∫–∞–∫ –µ—Å—Ç—å       ‚îÇ –º–≥/–∫–≥   ‚îÇ 0-2000
0x001F  ‚îÇ 31    ‚îÇ –§–æ—Å—Ñ–æ—Ä (P)         ‚îÇ –∫–∞–∫ –µ—Å—Ç—å       ‚îÇ –º–≥/–∫–≥   ‚îÇ 0-2000
0x0020  ‚îÇ 32    ‚îÇ –ö–∞–ª–∏–π (K)          ‚îÇ –∫–∞–∫ –µ—Å—Ç—å       ‚îÇ –º–≥/–∫–≥   ‚îÇ 0-2000
```

### –°–∏—Å—Ç–µ–º–Ω—ã–µ —Ä–µ–≥–∏—Å—Ç—Ä—ã {#Sistemnye-registry}
```
–†–µ–≥–∏—Å—Ç—Ä ‚îÇ –ê–¥—Ä–µ—Å ‚îÇ –ü–∞—Ä–∞–º–µ—Ç—Ä           ‚îÇ –§–æ—Ä–º—É–ª–∞        ‚îÇ –ï–¥–∏–Ω–∏—Ü—ã ‚îÇ –î–æ—Å—Ç—É–ø
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
0x0007  ‚îÇ 7     ‚îÇ –í–µ—Ä—Å–∏—è –ø—Ä–æ—à–∏–≤–∫–∏    ‚îÇ –∫–∞–∫ –µ—Å—Ç—å       ‚îÇ –≤–µ—Ä—Å–∏—è  ‚îÇ –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ
0x0008  ‚îÇ 8     ‚îÇ –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞         ‚îÇ –∫–∞–∫ –µ—Å—Ç—å       ‚îÇ —Ñ–ª–∞–≥–∏   ‚îÇ –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å
0x000B  ‚îÇ 11    ‚îÇ –°—Ç–∞—Ç—É—Å –æ—à–∏–±–æ–∫      ‚îÇ –∫–∞–∫ –µ—Å—Ç—å       ‚îÇ —Ñ–ª–∞–≥–∏   ‚îÇ –¢–æ–ª—å–∫–æ —á—Ç–µ–Ω–∏–µ
0x000C  ‚îÇ 12    ‚îÇ –ê–¥—Ä–µ—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞   ‚îÇ –∫–∞–∫ –µ—Å—Ç—å       ‚îÇ –∞–¥—Ä–µ—Å   ‚îÇ –ß—Ç–µ–Ω–∏–µ/–∑–∞–ø–∏—Å—å
```

## üîç –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ—Ç–æ–∫–æ–ª–∞ {#Primery-protokola}

### 1. –ß—Ç–µ–Ω–∏–µ pH –ø–æ—á–≤—ã (—Ä–µ–≥–∏—Å—Ç—Ä 0x0006) {#1-Chtenie-ph-pochvy-registr-0x0006}

**–ó–∞–ø—Ä–æ—Å:**
```
–ë–∞–π—Ç ‚îÇ Hex ‚îÇ –û–ø–∏—Å–∞–Ω–∏–µ
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
0    ‚îÇ 01  ‚îÇ –ê–¥—Ä–µ—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (1)
1    ‚îÇ 03  ‚îÇ –§—É–Ω–∫—Ü–∏—è (Read Holding Registers)
2    ‚îÇ 00  ‚îÇ –ê–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞ (High byte)
3    ‚îÇ 06  ‚îÇ –ê–¥—Ä–µ—Å —Ä–µ–≥–∏—Å—Ç—Ä–∞ (Low byte) - 0x0006
4    ‚îÇ 00  ‚îÇ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ (High byte)
5    ‚îÇ 01  ‚îÇ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ (Low byte) - 1
6    ‚îÇ 64  ‚îÇ CRC16 (High byte)
7    ‚îÇ 0B  ‚îÇ CRC16 (Low byte)
```

**–û—Ç–≤–µ—Ç:**
```
–ë–∞–π—Ç ‚îÇ Hex ‚îÇ –û–ø–∏—Å–∞–Ω–∏–µ
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
0    ‚îÇ 01  ‚îÇ –ê–¥—Ä–µ—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (1)
1    ‚îÇ 03  ‚îÇ –§—É–Ω–∫—Ü–∏—è (Read Holding Registers)
2    ‚îÇ 02  ‚îÇ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–π—Ç –¥–∞–Ω–Ω—ã—Ö (2)
3    ‚îÇ 02  ‚îÇ –ó–Ω–∞—á–µ–Ω–∏–µ pH (High byte)
4    ‚îÇ BC  ‚îÇ –ó–Ω–∞—á–µ–Ω–∏–µ pH (Low byte)
5    ‚îÇ 38  ‚îÇ CRC16 (High byte)
6    ‚îÇ 05  ‚îÇ CRC16 (Low byte)
```

**–†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è:**
```
Hex –∑–Ω–∞—á–µ–Ω–∏–µ: 0x02BC = 700 (decimal)
pH = 700 √∑ 100 = 7.00
```

### 2. –ß—Ç–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –ø–æ—á–≤—ã (—Ä–µ–≥–∏—Å—Ç—Ä 0x0013) {#2-Chtenie-temperatury-pochvy-registr-0x0013}

**–ó–∞–ø—Ä–æ—Å:**
```
01 03 00 13 00 01 74 0F
```

**–û—Ç–≤–µ—Ç:**
```
01 03 02 00 ED 78 B8
```

**–†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è:**
```
Hex –∑–Ω–∞—á–µ–Ω–∏–µ: 0x00ED = 237 (decimal)
–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ = 237 √∑ 10 = 23.7¬∞C
```

### 3. –ß—Ç–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤ (NPK) {#3-Chtenie-neskolkih-registrov-npk}

**–ó–∞–ø—Ä–æ—Å (—Ä–µ–≥–∏—Å—Ç—Ä—ã 0x001E-0x0020):**
```
01 03 00 1E 00 03 65 CC
```

**–û—Ç–≤–µ—Ç:**
```
01 03 06 01 5E 01 F3 03 D6 XX XX
```

**–†–∞—Å—á–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–π:**
```
–ê–∑–æ—Ç (N):    0x015E = 350 –º–≥/–∫–≥
–§–æ—Å—Ñ–æ—Ä (P):  0x01F3 = 499 –º–≥/–∫–≥
–ö–∞–ª–∏–π (K):   0x03D6 = 982 –º–≥/–∫–≥
```

## üîß –°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è ESP32 {#Shema-podklyucheniya-esp32}

### –§–∏–∑–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ {#Fizicheskoe-podklyuchenie}

#### RS-485 –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å {#rs-485-interfeys}
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç—Ä–∞–Ω—Å–∏–≤–µ—Ä SP3485E
- –°–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏: –¥–æ 10 Mbps
- –ó–∞—â–∏—Ç–∞ –æ—Ç ESD: ¬±15kV HBM
- –ü–∏—Ç–∞–Ω–∏–µ: 3.3V (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è ESP32)

#### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ SP3485E {#Podklyuchenie-sp3485e}
```
ESP32 GPIO   ‚îÇ SP3485E Pin ‚îÇ –§—É–Ω–∫—Ü–∏—è
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
GPIO16       ‚îÇ RO         ‚îÇ Receive Output (–∫ UART RX)
GPIO17       ‚îÇ DI         ‚îÇ Data Input (–æ—Ç UART TX)
GPIO4        ‚îÇ DE         ‚îÇ Driver Enable (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫–æ–º)
GPIO5        ‚îÇ RE         ‚îÇ Receiver Enable (—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏–µ–º–Ω–∏–∫–æ–º)
GND          ‚îÇ GND        ‚îÇ –û–±—â–∏–π –ø—Ä–æ–≤–æ–¥
3.3V         ‚îÇ VCC        ‚îÇ –ü–∏—Ç–∞–Ω–∏–µ –º–æ–¥—É–ª—è
```

#### –í–∞–∂–Ω–æ—Å—Ç—å —Ä–∞–∑–¥–µ–ª—å–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è DE –∏ RE {#Vazhnost-razdelnogo-upravleniya-de-i-re}
- **DE (Driver Enable)** - —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫–æ–º:
  - HIGH: –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫ –∞–∫—Ç–∏–≤–µ–Ω (–¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö)
  - LOW: –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫ –≤ –≤—ã—Å–æ–∫–æ–∏–º–ø–µ–¥–∞–Ω—Å–Ω–æ–º —Å–æ—Å—Ç–æ—è–Ω–∏–∏
- **RE (Receiver Enable)** - —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–µ–º–Ω–∏–∫–æ–º:
  - HIGH: –ø—Ä–∏–µ–º–Ω–∏–∫ –æ—Ç–∫–ª—é—á–µ–Ω (–≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ–¥–∞—á–∏)
  - LOW: –ø—Ä–∏–µ–º–Ω–∏–∫ –∞–∫—Ç–∏–≤–µ–Ω (–¥–ª—è –ø—Ä–∏–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö)

–†–∞–∑–¥–µ–ª—å–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —ç—Ç–∏–º–∏ –ø–∏–Ω–∞–º–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
1. –ë–æ–ª–µ–µ —Ç–æ—á–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –≤—Ä–µ–º–µ–Ω–µ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è
2. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ç–æ–Ω–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–¥–µ—Ä–∂–µ–∫
3. –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –∫–æ–ª–ª–∏–∑–∏–π –Ω–∞ —à–∏–Ω–µ RS-485
4. –£–ª—É—á—à–µ–Ω–Ω—É—é –ø–æ–º–µ—Ö–æ–∑–∞—â–∏—â–µ–Ω–Ω–æ—Å—Ç—å

#### –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∏–∞–≥—Ä–∞–º–º—ã –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è {#Vremennye-diagrammy-pereklyucheniya}

```
DE ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
     ‚îÇ          ‚îÇ        ‚îÇ          ‚îÇ
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

RE ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
     ‚îÇ          ‚îÇ        ‚îÇ          ‚îÇ
     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îú‚îÄ –ø—Ä–∏–µ–º ‚îÄ‚îÄ‚î§‚îú‚îÄ –ø–µ—Ä–µ–¥–∞—á–∞ ‚îÄ‚î§‚îú‚îÄ –ø—Ä–∏–µ–º ‚îÄ‚îÄ‚î§

     ‚îÇ‚óÑ‚îÄ 50¬µs ‚îÄ‚ñ∫‚îÇ          ‚îÇ‚óÑ‚îÄ 50¬µs ‚îÄ‚ñ∫‚îÇ
```

–ó–∞–¥–µ—Ä–∂–∫–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è:
- 50 –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥ –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π (preTransmission)
- 50 –º–∏–∫—Ä–æ—Å–µ–∫—É–Ω–¥ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–¥–∞—á–∏ (postTransmission)

### –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –¥–∞—Ç—á–∏–∫—É JXCT {#Podklyuchenie-k-datchiku-jxct}
```
Transceiver  ‚îÇ JXCT Sensor ‚îÇ –¶–≤–µ—Ç –ø—Ä–æ–≤–æ–¥–∞ ‚îÇ –§—É–Ω–∫—Ü–∏—è
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
A+ Terminal  ‚îÇ A+          ‚îÇ –ñ–µ–ª—Ç—ã–π       ‚îÇ RS485 Data+
B- Terminal  ‚îÇ B-          ‚îÇ –°–∏–Ω–∏–π        ‚îÇ RS485 Data-
```

### –ü–∏—Ç–∞–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞ (–æ—Ç–¥–µ–ª—å–Ω–æ–µ!) {#Pitanie-datchika-otdelnoe}
```
–ò—Å—Ç–æ—á–Ω–∏–∫     ‚îÇ JXCT Sensor ‚îÇ –¶–≤–µ—Ç –ø—Ä–æ–≤–æ–¥–∞ ‚îÇ –§—É–Ω–∫—Ü–∏—è
‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
12-24V DC+   ‚îÇ VCC         ‚îÇ –ö—Ä–∞—Å–Ω—ã–π      ‚îÇ –ü–∏—Ç–∞–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞
GND          ‚îÇ GND         ‚îÇ –ß–µ—Ä–Ω—ã–π       ‚îÇ –û–±—â–∏–π –º–∏–Ω—É—Å
```

## ‚öôÔ∏è –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –≤ –∫–æ–¥–µ ESP32 {#Realizatsiya-v-kode-esp32}

### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è UART –∏ SP3485E {#Initsializatsiya-uart-i-sp3485e}

```cpp
void setupModbus() {
    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ UART2 –¥–ª—è Modbus
    Serial2.begin(9600, SERIAL_8N1, MODBUS_RX_PIN, MODBUS_TX_PIN);

    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–∏–Ω–æ–≤ SP3485E
    pinMode(MODBUS_DE_PIN, OUTPUT);    // GPIO4
    pinMode(MODBUS_RE_PIN, OUTPUT);    // GPIO5
    digitalWrite(MODBUS_DE_PIN, LOW);  // –ü–µ—Ä–µ–¥–∞—Ç—á–∏–∫ –≤—ã–∫–ª—é—á–µ–Ω
    digitalWrite(MODBUS_RE_PIN, LOW);  // –ü—Ä–∏–µ–º–Ω–∏–∫ –≤–∫–ª—é—á–µ–Ω

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Modbus
    node.begin(SENSOR_ID, Serial2);

    // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ä–µ–∂–∏–º–∞
    node.preTransmission(preTransmission);   // –ü–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ–π
    node.postTransmission(postTransmission); // –ü–æ—Å–ª–µ –ø–µ—Ä–µ–¥–∞—á–∏
}

// –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –ø–µ—Ä–µ–¥–∞—á–∏ SP3485E
void preTransmission() {
    digitalWrite(MODBUS_DE_PIN, HIGH);  // –†–µ–∂–∏–º –ø–µ—Ä–µ–¥–∞—á–∏
    delayMicroseconds(50);
}

void postTransmission() {
    delayMicroseconds(50);
    digitalWrite(MODBUS_RE_PIN, LOW);   // –†–µ–∂–∏–º –ø—Ä–∏–µ–º–∞
}
```

### –ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö {#Chtenie-dannyh}
```cpp
void readSensorData() {
    // –ß—Ç–µ–Ω–∏–µ pH
    uint8_t result = modbus.readHoldingRegisters(0x0006, 1);
    if (result == modbus.ku8MBSuccess) {
        uint16_t ph_raw = modbus.getResponseBuffer(0);
        float ph = ph_raw / 100.0;
    }

    // –ß—Ç–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã
    result = modbus.readHoldingRegisters(0x0013, 1);
    if (result == modbus.ku8MBSuccess) {
        uint16_t temp_raw = modbus.getResponseBuffer(0);
        float temperature = temp_raw / 10.0;
    }

    // –ß—Ç–µ–Ω–∏–µ NPK (3 —Ä–µ–≥–∏—Å—Ç—Ä–∞ –∑–∞ –æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å)
    result = modbus.readHoldingRegisters(0x001E, 3);
    if (result == modbus.ku8MBSuccess) {
        uint16_t nitrogen = modbus.getResponseBuffer(0);
        uint16_t phosphorus = modbus.getResponseBuffer(1);
        uint16_t potassium = modbus.getResponseBuffer(2);
    }
}
```

## üõ†Ô∏è –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –æ—Ç–ª–∞–¥–∫–∞ {#Diagnostika-i-otladka}

### –ö–æ–¥—ã –æ—à–∏–±–æ–∫ ModbusMaster {#Kody-oshibok-modbusmaster}
```
–ö–æ–¥ ‚îÇ –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞              ‚îÇ –û–ø–∏—Å–∞–Ω–∏–µ
‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
0   ‚îÇ ku8MBSuccess           ‚îÇ –£—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
1   ‚îÇ ku8MBIllegalFunction   ‚îÇ –ù–µ–¥–æ–ø—É—Å—Ç–∏–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è
2   ‚îÇ ku8MBIllegalDataAddress‚îÇ –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –∞–¥—Ä–µ—Å –¥–∞–Ω–Ω—ã—Ö
3   ‚îÇ ku8MBIllegalDataValue  ‚îÇ –ù–µ–¥–æ–ø—É—Å—Ç–∏–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
4   ‚îÇ ku8MBSlaveDeviceFailure‚îÇ –û—à–∏–±–∫–∞ –≤–µ–¥–æ–º–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
224 ‚îÇ ku8MBInvalidSlaveID    ‚îÇ –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π ID —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
225 ‚îÇ ku8MBInvalidFunction   ‚îÇ –ù–µ–¥–æ–ø—É—Å—Ç–∏–º–∞—è —Ñ—É–Ω–∫—Ü–∏—è
226 ‚îÇ ku8MBResponseTimedOut  ‚îÇ –¢–∞–π–º–∞—É—Ç –æ—Ç–≤–µ—Ç–∞
227 ‚îÇ ku8MBInvalidCRC        ‚îÇ –û—à–∏–±–∫–∞ CRC
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏ {#Proverka-svyazi}
```cpp
bool testModbusConnection() {
    logSystem("–¢–µ—Å—Ç —Å–≤—è–∑–∏ —Å –¥–∞—Ç—á–∏–∫–æ–º JXCT...");

    // –ü–æ–ø—ã—Ç–∫–∞ —á—Ç–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ –ø—Ä–æ—à–∏–≤–∫–∏
    uint8_t result = modbus.readHoldingRegisters(0x0007, 1);

    if (result == modbus.ku8MBSuccess) {
        uint16_t version = modbus.getResponseBuffer(0);
        logSuccess("–î–∞—Ç—á–∏–∫ –Ω–∞–π–¥–µ–Ω! –í–µ—Ä—Å–∏—è –ø—Ä–æ—à–∏–≤–∫–∏: %d.%d",
                  (version >> 8) & 0xFF, version & 0xFF);
        return true;
    } else {
        logError("–û—à–∏–±–∫–∞ —Å–≤—è–∑–∏ —Å –¥–∞—Ç—á–∏–∫–æ–º: %d", result);
        return false;
    }
}
```

## üîç –†–∞—Å—á–µ—Ç CRC16 {#Raschet-crc16}

MODBUS RTU –∏—Å–ø–æ–ª—å–∑—É–µ—Ç CRC16 —Å –ø–æ–ª–∏–Ω–æ–º–æ–º 0xA001:

```cpp
uint16_t calculateCRC16(uint8_t* data, size_t length) {
    uint16_t crc = 0xFFFF;

    for (size_t i = 0; i < length; i++) {
        crc ^= (uint16_t)data[i];
        for (int j = 0; j < 8; j++) {
            if (crc & 0x0001) {
                crc = (crc >> 1) ^ 0xA001;
            } else {
                crc = crc >> 1;
            }
        }
    }

    return crc;
}
```

## üö® –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–µ—à–µ–Ω–∏—è {#Tipichnye-problemy-i-resheniya}

### 1. –¢–∞–π–º–∞—É—Ç –æ—Ç–≤–µ—Ç–∞ (ku8MBResponseTimedOut) {#1-Taymaut-otveta-ku8mbresponsetimedout}
**–ü—Ä–∏—á–∏–Ω—ã:**
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ A+/B-
- –ù–µ–∏—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—å –∫–∞–±–µ–ª—è RS485
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∏—Ç–∞–Ω–∏–µ–º –¥–∞—Ç—á–∏–∫–∞

**–†–µ—à–µ–Ω–∏–µ:**
```cpp
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
if (!testModbusConnection()) {
    logError("–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ RS485 –∏ –ø–∏—Ç–∞–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞");
}
```

### 2. –û—à–∏–±–∫–∞ CRC (ku8MBInvalidCRC) {#2-Oshibka-crc-ku8mbinvalidcrc}
**–ü—Ä–∏—á–∏–Ω—ã:**
- –ü–æ–º–µ—Ö–∏ –≤ –ª–∏–Ω–∏–∏ RS485
- –ü–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ –∫–∞–±–µ–ª—è
- –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø–µ—Ä–µ–¥–∞—á–∏

**–†–µ—à–µ–Ω–∏–µ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–∞–±–µ–ª—å
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–∑–µ–º–ª–µ–Ω–∏–µ
- –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑–∏—Å—Ç–æ—Ä—ã (120 –û–º)

### 3. –ù–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–π –∞–¥—Ä–µ—Å –¥–∞–Ω–Ω—ã—Ö (ku8MBIllegalDataAddress) {#3-Nedopustimyy-adres-dannyh-ku8mbillegaldataaddress}
**–ü—Ä–∏—á–∏–Ω—ã:**
- –ó–∞–ø—Ä–æ—Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞
- –†–∞–∑–ª–∏—á–∏—è –≤ –≤–µ—Ä—Å–∏—è—Ö –ø—Ä–æ—à–∏–≤–∫–∏ –¥–∞—Ç—á–∏–∫–∞

**–†–µ—à–µ–Ω–∏–µ:**
```cpp
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —Ä–µ–≥–∏—Å—Ç—Ä–æ–≤
const uint16_t test_registers[] = {0x0006, 0x0012, 0x0013, 0x0015};
for (int i = 0; i < 4; i++) {
    uint8_t result = modbus.readHoldingRegisters(test_registers[i], 1);
    if (result != modbus.ku8MBSuccess) {
        logWarn("–†–µ–≥–∏—Å—Ç—Ä 0x%04X –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω: %d", test_registers[i], result);
    }
}
```

## üìê –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö {#Validatsiya-dannyh}

### –î–æ–ø—É—Å—Ç–∏–º—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã {#Dopustimye-diapazony}
```cpp
bool validateSensorData(SensorData& data) {
    // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: -45¬∞C –¥–æ +115¬∞C (–¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç—á–∏–∫–∞ JXCT 7-in-1)
    if (data.temperature < SENSOR_TEMP_MIN || data.temperature > SENSOR_TEMP_MAX) return false;

    // –í–ª–∞–∂–Ω–æ—Å—Ç—å: 0% –¥–æ 100%
    if (data.humidity < SENSOR_HUMIDITY_MIN || data.humidity > SENSOR_HUMIDITY_MAX) return false;

    // pH: 3.0 –¥–æ 9.0 (—Ä–∞–±–æ—á–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç—á–∏–∫–∞ JXCT 7-in-1)
    if (data.ph < SENSOR_PH_MIN || data.ph > SENSOR_PH_MAX) return false;

    // EC: 0 –¥–æ 10000 ¬µS/cm (—Ä–∞–±–æ—á–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç—á–∏–∫–∞ JXCT 7-in-1)
    if (data.ec < SENSOR_EC_MIN || data.ec > SENSOR_EC_MAX) return false;

    // NPK: 0 –¥–æ 1999 –º–≥/–∫–≥ (—Ä–∞–±–æ—á–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç—á–∏–∫–∞ JXCT 7-in-1)
    if (data.nitrogen < SENSOR_NPK_MIN || data.nitrogen > SENSOR_NPK_MAX) return false;
    if (data.phosphorus < SENSOR_NPK_MIN || data.phosphorus > SENSOR_NPK_MAX) return false;
    if (data.potassium < SENSOR_NPK_MIN || data.potassium > SENSOR_NPK_MAX) return false;

    return true;
}
```

## üìã –°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è {#Spravochnaya-informatsiya}

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—è {#Dokumentatsiya-proizvoditelya}
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å:** JXCT (Jingxun Changtong)
- **–ú–æ–¥–µ–ª—å:** JXBS-3001 7-in-1 Soil Sensor
- **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å:** RS485 Modbus RTU
- **–ü–∏—Ç–∞–Ω–∏–µ:** 12-24V DC
- **–ü—Ä–æ—Ç–æ–∫–æ–ª:** Modbus RTU

### –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ {#Svyazannye-fayly-proekta}
- `src/modbus_sensor.h` - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä
- `src/modbus_sensor.cpp` - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–π
- `include/jxct_config_vars.h` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∏–Ω–æ–≤
- `docs/API.md` - REST API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

---

*–î–æ–∫—É–º–µ–Ω—Ç –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –≤–µ—Ä—Å–∏–∏ JXCT v3.10.0*

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞ {#Podderzhka}

### üí¨ –°–≤—è–∑—å —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏ {#Svyaz-s-razrabotchikami}
- **Telegram:** [@Gfermoto](https://t.me/Gfermoto)
- **GitHub Issues:** [–°–æ–æ–±—â–∏—Ç—å –æ –ø—Ä–æ–±–ª–µ–º–µ](https://github.com/Gfermoto/soil-sensor-7in1/issues)
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:** [GitHub Pages](https://gfermoto.github.io/soil-sensor-7in1/)

### üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã {#Dopolnitelnye-resursy}
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è](USER_GUIDE.md)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](TECHNICAL_DOCS.md)
- [–ê–≥—Ä–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏](AGRO_RECOMMENDATIONS.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏](COMPENSATION_GUIDE.md)
- [API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è](API.md)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π](CONFIG_MANAGEMENT.md)
- [–°—Ö–µ–º–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è](WIRING_DIAGRAM.md)
- [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏—è–º–∏](VERSION_MANAGEMENT.md)

### üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏ {#Poleznye-ssylki}

- [üå± GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π](https://github.com/Gfermoto/soil-sensor-7in1) - –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞
- [üìã –ü–ª–∞–Ω —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞](../dev/REFACTORING_PLAN.md) - –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è
- [üìä –û—Ç—á–µ—Ç –æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–º –¥–æ–ª–≥–µ](../dev/TECHNICAL_DEBT_REPORT.md) - –ê–Ω–∞–ª–∏–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º
- [üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](../dev/ARCH_OVERALL.md) - –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
