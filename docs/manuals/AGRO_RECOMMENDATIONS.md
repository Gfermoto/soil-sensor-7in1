# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ JXCT –ø–æ –∞–≥—Ä–æ-–ø—Ä–æ—Ñ–∏–ª—é, –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –ø–æ–∫–∞–∑–∞–Ω–∏–π –∏ —Å–∏—Å—Ç–µ–º–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

> –í–µ—Ä—Å–∏—è: v2.6.0 (draft, 2025-06-16)
> 
> –î–æ–∫—É–º–µ–Ω—Ç –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏–∑:
> 1. `CROPS_DATABASE.md`
> 2. `SENSOR_COMPENSATION.md`
> 3. `RECOMMENDATIONS_SYSTEM.md`
>
> **–ö–ª—é—á–µ–≤—ã–µ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏—è**:
> ‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å—Ä–µ–¥–∞ –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏—è ¬´indoor¬ª (–ø–æ–º–µ—â–µ–Ω–∏–µ) –Ω–∞—Ä—è–¥—É —Å `outdoor` –∏ `greenhouse`  
> ‚Ä¢ –£—á—ë—Ç —Å–µ–∑–æ–Ω–Ω—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –≤—ã–Ω–µ—Å–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å; –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–∫–ª—é—á–∏—Ç—å –∏—Ö —á–µ—Ä–µ–∑ —á–µ–∫–±–æ–∫—Å ¬´Seasonal Adjust¬ª –≤ UI –Ω–∞—Å—Ç—Ä–æ–µ–∫  
> ‚Ä¢ –í—Å–µ —Ñ–æ—Ä–º—É–ª—ã –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –∫ –µ–¥–∏–Ω–æ–º—É —Å—Ç–∏–ª—é; —Å—Å—ã–ª–∫–∏ –º–µ–∂–¥—É —Ä–∞–∑–¥–µ–ª–∞–º–∏ —Å–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω—ã

---

## 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∞–≥—Ä–æ-–ø—Ä–æ—Ñ–∏–ª—è

```json
{
  "latitude": 55.7558,
  "longitude": 37.6173,
  "environment_type": "outdoor | greenhouse | indoor",
  "cropId": "tomato",
  "soil_type": "loam",
  "stage": "vegetative",
  "isGreenhouse": false,       // <- —É—Å—Ç–∞—Ä–µ–ª–æ, –∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ environment_type
  "seasonalAdjustEnabled": true,
  "irrigationSpikeThreshold": 15,
  "irrigationHoldMinutes": 5,
  "postIrrigationHoldMinutes": 180
}
```

*–ü–µ—Ä–µ—Ö–æ–¥ —Å —Ñ–ª–∞–≥–∞ `isGreenhouse`*: –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ –ø—Ä–æ—à–∏–≤–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è:

```cpp
if (oldConfig.flags.isGreenhouse) {
    config.environment_type = "greenhouse";
}
```

---

## 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫—É–ª—å—Ç—É—Ä (—Å–æ–∫—Ä–∞—â—ë–Ω–Ω–æ)

–†–∞–∑–¥–µ–ª –ø–æ–¥—Ä–æ–±–Ω–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç JSON-—Å—Ö–µ–º—É –∫–∞–∂–¥–æ–π –∫—É–ª—å—Ç—É—Ä—ã. –ù–∏–∂–µ –ø—Ä–∏–≤–µ–¥—ë–Ω —Ñ—Ä–∞–≥–º–µ–Ω—Ç —Å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–º –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ–º `environment_type`:

```jsonc
{
  "name": "–¢–æ–º–∞—Ç—ã",
  "type": "vegetable",
  "environment_type": "both | indoor",  // –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  "soil_types": ["loam", "clay"],
  // ... –æ—Å—Ç–∞–ª—å–Ω–æ–µ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π ...
}
```

–ü–æ–ª–Ω–∞—è –±–∞–∑–∞ –≤—ã–Ω–µ—Å–µ–Ω–∞ –≤ `data/crops_v1.json`; —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è —Å–º. –≤ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –ê.

---

## 3. –ö–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ø–æ–∫–∞–∑–∞–Ω–∏–π —Å–µ–Ω—Å–æ—Ä–∞

### 3.1 –í—ã–±–æ—Ä –ø—Ä–æ—Ñ–∏–ª—è –ø–æ —Å—Ä–µ–¥–µ

| environment_type | –ü—Ä–æ—Ñ–∏–ª—å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ |
|------------------|----------------------|
| outdoor          | `field_correction()` |
| greenhouse       | `greenhouse_correction()` |
| indoor           | `indoor_correction()` |

–§—É–Ω–∫—Ü–∏—è `indoor_correction()` –Ω–∞—Å–ª–µ–¥—É–µ—Ç –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã ¬´—Ç–µ–ø–ª–∏—Ü–∞¬ª, –Ω–æ –æ—Å–ª–∞–±–ª—è–µ—Ç –≤–ª–∞–∂–Ω–æ—Å—Ç–Ω—É—é –∫–æ—Ä—Ä–µ–∫—Ü–∏—é (Œ∏) –∏ —É–±–∏—Ä–∞–µ—Ç –∑–∞—Å–æ–ª–µ–Ω–∏–µ >3 000 ¬µS/cm, —Ç.–∫. –≤ –ø–æ–º–µ—â–µ–Ω–∏–∏ —Å—É–±—Å—Ç—Ä–∞—Ç –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–π.

### 3.2 –°–µ–∑–æ–Ω–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã

–°–µ–∑–æ–Ω–Ω–æ—Å—Ç—å –≤–ª–∏—è–µ—Ç –Ω–∞:
‚Ä¢ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç EC (`k_ec_temp`)  
‚Ä¢ –≤–ª–∞–∂–Ω–æ—Å—Ç–Ω—É—é –∫–æ—Ä—Ä–µ–∫—Ü–∏—é pH / NPK (`k_humidity_factor`)

–ù–∞–±–æ—Ä –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ `SeasonalTable[12]`. –ü—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ —á–µ–∫–±–æ–∫—Å–∞ ¬´Seasonal Adjust¬ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ñ–ª–∞–≥ `config.flags.seasonalAdjustEnabled = false`, —á—Ç–æ —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ `k_humidity_factor = 1.0` –∏ –≤—ã–±–æ—Ä—É ¬´—Å—É—Ö–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞¬ª –¥–ª—è `k_ec_temp`.

```cpp
float k_ec_temp = config.flags.seasonalAdjustEnabled ? SeasonalTable[month].k_ec_temp
                                                    : DEFAULT_K_EC_TEMP;
```

–ü–æ–¥—Ä–æ–±–Ω–æ–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–º. –≤ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ B.

---

## 4. –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

–ê–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏–∑–∞ –∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –Ω–æ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤–æ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–æ–≤–æ–µ –ø–æ–ª–µ `environment_type` –∏ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ñ–ª–∞–≥–∞ `seasonalAdjustEnabled`.

```python
optimal = get_optimal_range(crop, param, stage, environment_type)
if not config.seasonalAdjustEnabled:
    optimal = remove_seasonal_bias(optimal)
```

–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `/readings` –≤ –Ω–æ–≤–æ–º —Å—Ç–æ–ª–±—Ü–µ ¬´–†–µ–∫–æ–º.¬ª.

### 4.1 –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (v2.6.0-pre)
–°–µ—Ä–≤–µ—Ä–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `computeRecommendations()` (—Å–º. `src/web/routes_data.cpp`) —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏:
1. **–ë–∞–∑–æ–≤—ã–π –ø—Ä–æ—Ñ–∏–ª—å –∫—É–ª—å—Ç—É—Ä—ã** ‚Äì –±–µ—Ä—ë—Ç—Å—è –∏–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è (`tomato`, `cucumber`, ‚Ä¶). –ï—Å–ª–∏ –∫—É–ª—å—Ç—É—Ä–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞ ‚Äì –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ¬´generic¬ª.  
2. **–ö–æ—Ä—Ä–µ–∫—Ü–∏—è –ø–æ —Ç–∏–ø—É –ø–æ—á–≤—ã** (`config.soilProfile`):  
   ‚Ä¢ _sand_ ‚Üí Œ∏ ‚àí 5 %  
   ‚Ä¢ _loam_ ‚Üí Œ∏ + 5 %  
   ‚Ä¢ _peat_ ‚Üí Œ∏ + 10 %, pH ‚àí 0.3  
3. **–ö–æ—Ä—Ä–µ–∫—Ü–∏—è –ø–æ —Å—Ä–µ–¥–µ –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏—è** (`environmentType`):  
   ‚Ä¢ _greenhouse_ ‚Üí Œ∏ + 10 %, EC + 300 ¬µS, N + 5 –º–≥/–∫–≥, K + 5 –º–≥/–∫–≥, T + 2 ¬∞C  
   ‚Ä¢ _indoor_     ‚Üí Œ∏ ‚àí 5 %, EC ‚àí 200 ¬µS, T + 1 ¬∞C  
   ‚Ä¢ _outdoor_ ‚Äì –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π  
4. **–°–µ–∑–æ–Ω–Ω–∞—è –ø–æ–ø—Ä–∞–≤–∫–∞** (–µ—Å–ª–∏ `seasonalAdjustEnabled = true`):  
   ‚Ä¢ –∞–ø—Ä–µ–ª—å-–∏—é–Ω—å, –æ–∫—Ç—è–±—Ä—å ‚Üí Œ∏ + 5 %, EC ‚àí 100 ¬µS  
   ‚Ä¢ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–µ—Å—è—Ü—ã     ‚Üí Œ∏ ‚àí 2 %, EC + 100 ¬µS  
5. **NPK** –æ—Å—Ç–∞—ë—Ç—Å—è –∏–∑ –±–∞–∑–æ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è; —Å–µ–∑–æ–Ω –∏ —Å—Ç–∞–¥–∏—è —Ä–æ—Å—Ç–∞ –ø–æ–∫–∞ –Ω–µ –≤–ª–∏—è—é—Ç.

### 4.2 –ü–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è
‚Ä¢ –£—á—ë—Ç —Å—Ç–∞–¥–∏–∏ —Ä–æ—Å—Ç–∞ (`config.stage`) –¥–ª—è NPK/EC/Œ∏ –∏ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ø–æ–¥–¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤.  
‚Ä¢ –í–≤–µ–¥–µ–Ω–∏–µ —Å–µ–∑–æ–Ω–Ω—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –¥–ª—è NPK.  
‚Ä¢ –ü–µ—Ä–µ–Ω–æ—Å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∏ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –≤ SPIFFS/JSON, –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –ø–µ—Ä–µ–ø—Ä–æ—à–∏–≤–∫–∏ (—Å–º. `DEVELOPMENT_ROADMAP_2025.md`).  
‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ ML-–º–æ–¥—É–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.

---

## 5. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ UI

1. –°—Ç—Ä–∞–Ω–∏—Ü–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (`/`):
   ‚Ä¢ –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å ¬´–°—Ä–µ–¥–∞ –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏—è¬ª: `Outdoor`, `Greenhouse`, `Indoor`  
   ‚Ä¢ –ß–µ–∫–±–æ–∫—Å ¬´Seasonal Adjust¬ª (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á—ë–Ω)
2. –¢–∞–±–ª–∏—Ü–∞ –ø–æ–∫–∞–∑–∞–Ω–∏–π (`/readings`):
   ‚Ä¢ –ë–µ–π–¥–∂ üí¶ (¬´–ù–µ–¥–∞–≤–Ω–∏–π –ø–æ–ª–∏–≤¬ª) –ø–µ—Ä–µ–º–µ—â—ë–Ω –Ω–∞–¥ —Ç–∞–±–ª–∏—Ü–µ–π  
   ‚Ä¢ 4-–π —Å—Ç–æ–ª–±–µ—Ü ¬´–†–µ–∫–æ–º.¬ª –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ä–∞—Å—á—ë—Ç–Ω—ã–µ –æ–ø—Ç–∏–º—É–º—ã

---

## 6. API

`GET /api/v1/recommendations` –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–æ–≤—ã–µ query-–ø–∞—Ä–∞–º–µ—Ç—Ä—ã:

```
?env=outdoor|greenhouse|indoor&seasonal=0|1
```

---

## 7. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è

‚Ä¢ **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ê** ‚Äì –ü–æ–ª–Ω–∞—è JSON-—Å—Ö–µ–º–∞ `crops_v1.json`  
‚Ä¢ **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ B** ‚Äì –¢–∞–±–ª–∏—Ü—ã —Å–µ–∑–æ–Ω–Ω—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∏ derivation  
‚Ä¢ **–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ C** ‚Äì –ü—Å–µ–≤–¥–æ–∫–æ–¥ indoor-–ø—Ä–æ—Ñ–∏–ª—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏

---

¬© JXCT, 2025 
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫—É–ª—å—Ç—É—Ä

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

–ö–∞–∂–¥–∞—è –∫—É–ª—å—Ç—É—Ä–∞ –æ–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
```json
{
  "name": "–ù–∞–∑–≤–∞–Ω–∏–µ –∫—É–ª—å—Ç—É—Ä—ã",
  "type": "vegetable|fruit|berry|grain|herb",
  "environment_type": "outdoor|greenhouse|both",
  "soil_types": ["sand", "loam", "clay", "peat"],
  "stages": ["germination", "vegetative", "flowering", "fruiting"],
  "temperature": {
    "min": 10,
    "optimal": 18,
    "max": 30,
    "stages": {
      "germination": {"min": 12, "optimal": 20, "max": 25},
      "vegetative": {"min": 15, "optimal": 22, "max": 28},
      "flowering": {"min": 18, "optimal": 24, "max": 30},
      "fruiting": {"min": 16, "optimal": 23, "max": 28}
    }
  },
  "moisture": {
    "min_ppv": 60,
    "optimal_ppv": 70,
    "max_ppv": 80,
    "soil_type_adjustments": {
      "sand": {"min": -5, "optimal": -5, "max": -5},
      "clay": {"min": +5, "optimal": +5, "max": +5},
      "peat": {"min": +10, "optimal": +10, "max": +10}
    }
  },
  "ph": {
    "min": 5.5,
    "optimal": 6.3,
    "max": 7.0,
    "sensor_limits": {
      "absolute_min": 3.0,
      "absolute_max": 9.0,
      "accuracy": 0.3
    }
  },
  "ec": {
    "stages": {
      "germination": {"min": 500, "optimal": 800, "max": 1200},
      "vegetative": {"min": 1000, "optimal": 1500, "max": 2000},
      "flowering": {"min": 1200, "optimal": 1800, "max": 2200},
      "fruiting": {"min": 1500, "optimal": 2000, "max": 2500}
    },
    "sensor_limits": {
      "absolute_min": 0,
      "absolute_max": 10000,
      "resolution": 10
    }
  },
  "npk": {
    "stages": {
      "germination": {
        "N": {"min": 100, "optimal": 150, "max": 200},
        "P": {"min": 50, "optimal": 75, "max": 100},
        "K": {"min": 50, "optimal": 75, "max": 100}
      },
      "vegetative": {
        "N": {"min": 150, "optimal": 200, "max": 250},
        "P": {"min": 75, "optimal": 100, "max": 125},
        "K": {"min": 100, "optimal": 150, "max": 200}
      },
      "flowering": {
        "N": {"min": 125, "optimal": 175, "max": 225},
        "P": {"min": 100, "optimal": 150, "max": 200},
        "K": {"min": 150, "optimal": 200, "max": 250}
      },
      "fruiting": {
        "N": {"min": 100, "optimal": 150, "max": 200},
        "P": {"min": 125, "optimal": 175, "max": 225},
        "K": {"min": 175, "optimal": 225, "max": 275}
      }
    },
    "sensor_limits": {
      "absolute_min": 0,
      "absolute_max": 1999,
      "accuracy": "2%"
    }
  }
}
```

## –û–≤–æ—â–Ω—ã–µ –∫—É–ª—å—Ç—É—Ä—ã

### –¢–æ–º–∞—Ç—ã
```json
{
  "name": "–¢–æ–º–∞—Ç—ã",
  "type": "vegetable",
  "environment_type": "both",
  "soil_types": ["loam", "clay"],
  "stages": ["germination", "vegetative", "flowering", "fruiting"],
  "temperature": {
    "min": 15,
    "optimal": 22,
    "max": 30,
    "stages": {
      "germination": {"min": 20, "optimal": 25, "max": 30},
      "vegetative": {"min": 18, "optimal": 24, "max": 28},
      "flowering": {"min": 18, "optimal": 23, "max": 27},
      "fruiting": {"min": 17, "optimal": 22, "max": 26}
    }
  },
  "moisture": {
    "min_ppv": 65,
    "optimal_ppv": 75,
    "max_ppv": 85,
    "soil_type_adjustments": {
      "sand": {"min": -5, "optimal": -5, "max": -5},
      "clay": {"min": +5, "optimal": +5, "max": +5},
      "peat": {"min": +10, "optimal": +10, "max": +10}
    }
  },
  "ph": {
    "min": 5.5,
    "optimal": 6.3,
    "max": 6.8
  },
  "ec": {
    "stages": {
      "germination": {"min": 0.5, "optimal": 0.8, "max": 1.2},
      "vegetative": {"min": 1.0, "optimal": 1.5, "max": 1.8},
      "flowering": {"min": 1.2, "optimal": 1.8, "max": 2.2},
      "fruiting": {"min": 1.5, "optimal": 2.0, "max": 2.5}
    }
  }
}
```

### –û–≥—É—Ä—Ü—ã
```json
{
  "name": "–û–≥—É—Ä—Ü—ã",
  "type": "vegetable",
  "environment_type": "both",
  "soil_types": ["loam", "sand"],
  "stages": ["germination", "vegetative", "flowering", "fruiting"],
  "temperature": {
    "min": 18,
    "optimal": 24,
    "max": 32,
    "stages": {
      "germination": {"min": 22, "optimal": 28, "max": 32},
      "vegetative": {"min": 20, "optimal": 25, "max": 30},
      "flowering": {"min": 20, "optimal": 24, "max": 28},
      "fruiting": {"min": 19, "optimal": 23, "max": 27}
    }
  },
  "moisture": {
    "min_ppv": 70,
    "optimal_ppv": 80,
    "max_ppv": 85,
    "soil_type_adjustments": {
      "sand": {"min": -5, "optimal": -5, "max": -5},
      "clay": {"min": +5, "optimal": +5, "max": +5},
      "peat": {"min": +10, "optimal": +10, "max": +10}
    }
  },
  "ph": {
    "min": 5.5,
    "optimal": 6.5,
    "max": 7.0
  },
  "ec": {
    "stages": {
      "germination": {"min": 0.5, "optimal": 0.8, "max": 1.2},
      "vegetative": {"min": 1.2, "optimal": 1.7, "max": 2.0},
      "flowering": {"min": 1.4, "optimal": 1.9, "max": 2.3},
      "fruiting": {"min": 1.6, "optimal": 2.1, "max": 2.5}
    }
  }
}
```

## –¢–∏–ø—ã –ø–æ—á–≤ –∏ –∏—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏

### –ü–µ—Å—á–∞–Ω—ã–µ –ø–æ—á–≤—ã (sand)
- –ë—ã—Å—Ç—Ä–æ –ø—Ä–æ–≥—Ä–µ–≤–∞—é—Ç—Å—è
- –•–æ—Ä–æ—à–∞—è –∞—ç—Ä–∞—Ü–∏—è
- –ù–∏–∑–∫–∞—è –≤–ª–∞–≥–æ—ë–º–∫–æ—Å—Ç—å
- –ë—ã—Å—Ç—Ä–æ–µ –≤—ã–º—ã–≤–∞–Ω–∏–µ –ø–∏—Ç–∞—Ç–µ–ª—å–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤
- –¢—Ä–µ–±—É—é—Ç —á–∞—Å—Ç–æ–≥–æ –ø–æ–ª–∏–≤–∞ –∏ –ø–æ–¥–∫–æ—Ä–º–æ–∫

### –°—É–≥–ª–∏–Ω–∏—Å—Ç—ã–µ –ø–æ—á–≤—ã (loam)
- –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤–æ–¥–Ω–æ-–≤–æ–∑–¥—É—à–Ω—ã–π —Ä–µ–∂–∏–º
- –•–æ—Ä–æ—à–∞—è —É–¥–µ—Ä–∂–∏–º–æ—Å—Ç—å –ø–∏—Ç–∞—Ç–µ–ª—å–Ω—ã—Ö –≤–µ—â–µ—Å—Ç–≤
- –°—Ä–µ–¥–Ω—è—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–æ–≥—Ä–µ–≤–∞
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã –¥–ª—è –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –∫—É–ª—å—Ç—É—Ä

### –ì–ª–∏–Ω–∏—Å—Ç—ã–µ –ø–æ—á–≤—ã (clay)
- –ú–µ–¥–ª–µ–Ω–Ω–æ –ø—Ä–æ–≥—Ä–µ–≤–∞—é—Ç—Å—è
- –í—ã—Å–æ–∫–∞—è –≤–ª–∞–≥–æ—ë–º–∫–æ—Å—Ç—å
- –°–∫–ª–æ–Ω–Ω–æ—Å—Ç—å –∫ —É–ø–ª–æ—Ç–Ω–µ–Ω–∏—é
- –¢—Ä–µ–±—É—é—Ç —É–ª—É—á—à–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –†–∏—Å–∫ –∑–∞–∫–∏—Å–∞–Ω–∏—è

### –¢–æ—Ä—Ñ—è–Ω—ã–µ –ø–æ—á–≤—ã (peat)
- –í—ã—Å–æ–∫–∞—è –≤–ª–∞–≥–æ—ë–º–∫–æ—Å—Ç—å
- –ù–∏–∑–∫–∞—è —Ç–µ–ø–ª–æ–ø—Ä–æ–≤–æ–¥–Ω–æ—Å—Ç—å
- –ë–æ–≥–∞—Ç—ã –æ—Ä–≥–∞–Ω–∏–∫–æ–π
- –¢—Ä–µ–±—É—é—Ç –∏–∑–≤–µ—Å—Ç–∫–æ–≤–∞–Ω–∏—è
- –†–∏—Å–∫ –ø–µ—Ä–µ—Å—ã—Ö–∞–Ω–∏—è –≤–µ—Ä—Ö–Ω–µ–≥–æ —Å–ª–æ—è

[–ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Å–ª–µ–¥—É–µ—Ç... –ë—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥—Ä—É–≥–∏–µ –∫—É–ª—å—Ç—É—Ä—ã]

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON
2. –î–ª—è –∫–∞–∂–¥–æ–π –∫—É–ª—å—Ç—É—Ä—ã –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –¥–∏–∞–ø–∞–∑–æ–Ω—ã –≤—Å–µ—Ö –∏–∑–º–µ—Ä—è–µ–º—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
3. –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Å—Ç–∞–¥–∏–∏ —Ä–∞–∑–≤–∏—Ç–∏—è —Ä–∞—Å—Ç–µ–Ω–∏—è
4. –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –Ω–∞—É—á–Ω—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–º –æ–ø—ã—Ç–µ

## –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã

1. –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–æ–≤—ã—Ö –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π
2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫—É–ª—å—Ç—É—Ä
3. –£—Ç–æ—á–Ω–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ 
# –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π JXCT

## –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

1. **–¶–µ–ª—å —Å–∏—Å—Ç–µ–º—ã:** –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —Ç–æ—á–Ω—ã—Ö –∏ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –ø–æ —É—Ö–æ–¥—É –∑–∞ —Ä–∞—Å—Ç–µ–Ω–∏—è–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–∫–∞–∑–∞–Ω–∏–π –¥–∞—Ç—á–∏–∫–∞ JXCT 1-in-7

2. **–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –¥–∞—Ç—á–∏–∫–∞:**
   - –ü–∏—Ç–∞–Ω–∏–µ: 12-24V DC
   - –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: RS485
   - –ö–ª–∞—Å—Å –∑–∞—â–∏—Ç—ã: IP68
   - –î–∏–∞–ø–∞–∑–æ–Ω—ã –∏–∑–º–µ—Ä–µ–Ω–∏–π:
     * –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: -45¬∞C –¥–æ +115¬∞C (¬±0.5¬∞C)
     * –í–ª–∞–∂–Ω–æ—Å—Ç—å: 0-100% (¬±3% –≤ 0-53%, ¬±5% –≤ 53-100%)
     * pH: 3-9 pH (¬±0.3 pH)
     * NPK: 0-1999 –º–≥/–∫–≥ (¬±2% –ø–æ–ª–Ω–æ–π —à–∫–∞–ª—ã)
     * EC: 0-10000 –º–∫–°–º/—Å–º (—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ 10 –º–∫–°–º/—Å–º)
   - –í—Ä–µ–º—è –æ—Ç–∫–ª–∏–∫–∞: <1—Å

3. **–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∑–∞–º–µ—Ä–∞:**
   - –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞ –∏ –≤–ª–∞–∂–Ω–æ—Å—Ç—å: 
     * –û—Ç–∫—Ä—ã—Ç—ã–π –≥—Ä—É–Ω—Ç: –∑–∞ 30 –º–∏–Ω –¥–æ –≤–æ—Å—Ö–æ–¥–∞ –∏ —á–µ—Ä–µ–∑ 3 —á–∞—Å–∞ –ø–æ—Å–ª–µ –ø–æ–ª—É–¥–Ω—è
     * –¢–µ–ø–ª–∏—Ü–∞: 6:00 –∏ 14:00
   - pH –∏ EC: 
     * –ü–æ—Å–ª–µ –ø–æ–ª–∏–≤–∞: —á–µ—Ä–µ–∑ 2 —á–∞—Å–∞ (—Ç–µ–ø–ª–∏—Ü–∞), —á–µ—Ä–µ–∑ 3 —á–∞—Å–∞ (–æ—Ç–∫—Ä—ã—Ç—ã–π –≥—Ä—É–Ω—Ç)
     * –í –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ: —É—Ç—Ä–æ–º —á–µ—Ä–µ–∑ 2-3 —á–∞—Å–∞ –ø–æ—Å–ª–µ –≤–æ—Å—Ö–æ–¥–∞
   - NPK: —á–µ—Ä–µ–∑ 2-3 —á–∞—Å–∞ –ø–æ—Å–ª–µ –≤–æ—Å—Ö–æ–¥–∞ (–ø–µ—Ä–∏–æ–¥ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–æ—Ä–Ω–µ–π)

4. **–î–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å –ø–æ–∫–∞–∑–∞–Ω–∏–π:**
   - –£—Å—Ä–µ–¥–Ω–µ–Ω–∏–µ 3-5 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π (–∏–Ω—Ç–µ—Ä–≤–∞–ª 1 —Å–µ–∫—É–Ω–¥–∞)
   - –û—Ç–±—Ä–∞–∫–æ–≤–∫–∞ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π:
     * –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –±–æ–ª–µ–µ ¬±2¬∞C –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ
     * –í–ª–∞–∂–Ω–æ—Å—Ç—å: –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –±–æ–ª–µ–µ ¬±10% –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ
     * pH: –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –±–æ–ª–µ–µ ¬±0.5 –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ
     * EC: –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –±–æ–ª–µ–µ ¬±20% –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ
     * NPK: –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –±–æ–ª–µ–µ ¬±15% –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ
   - –£—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–ª–∏–≤–∞
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç–∏ –ø–æ–∫–∞–∑–∞–Ω–∏–π

## –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∏–∑–º–µ—Ä–µ–Ω–∏–π

### 1. –ü–µ—Ä–µ—Å—á–µ—Ç –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –≤ –ü–ü–í
```python
def moisture_to_ppv(raw_moisture, soil_type):
    # –£—á–∏—Ç—ã–≤–∞–µ–º —Ç–æ—á–Ω–æ—Å—Ç—å –¥–∞—Ç—á–∏–∫–∞ ¬±3% –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 0-53%
    # –∏ ¬±5% –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 53-100%
    coefficients = {
        "sand": {"a": 0.68, "b": 0.12},
        "loam": {"a": 0.72, "b": 0.15},
        "clay": {"a": 0.75, "b": 0.18},
        "peat": {"a": 0.82, "b": 0.20}
    }
    
    coef = coefficients[soil_type]
    ppv = raw_moisture * coef["a"] + coef["b"]
    
    # –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –¥–∞—Ç—á–∏–∫–∞
    error = 0.03 if raw_moisture <= 53 else 0.05
    return {
        "value": ppv,
        "min": ppv * (1 - error),
        "max": ppv * (1 + error)
    }
```

### 2. –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è EC
```python
def compensate_ec(ec_value, temp):
    # –£—á–∏—Ç—ã–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞ 10 –º–∫–°–º/—Å–º
    reference_temp = 25.0  # ¬∞C
    compensated = ec_value / (1 + 0.02 * (temp - reference_temp))
    # –û–∫—Ä—É–≥–ª—è–µ–º –¥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–∞
    return round(compensated / 10) * 10
```

### 3. –í–∞–ª–∏–¥–∞—Ü–∏—è NPK
```python
def validate_npk(n, p, k):
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –∑–Ω–∞—á–µ–Ω–∏—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –¥–∞—Ç—á–∏–∫–∞
    if not all(0 <= x <= 1999 for x in [n, p, k]):
        return False
        
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è
    npk_sum = n + p + k
    if npk_sum == 0:
        return False
        
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–∏–ø–∏—á–Ω—ã–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è
    n_ratio = n / npk_sum
    p_ratio = p / npk_sum
    k_ratio = k / npk_sum
    
    return {
        "valid": True,
        "ratios": {
            "N": round(n_ratio, 2),
            "P": round(p_ratio, 2),
            "K": round(k_ratio, 2)
        }
    }
```

## –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –ø–æ–ª–∏–≤–∞

### 1. –î–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–∏–≤–∞
```python
def detect_watering(moisture_readings, timestamp):
    """
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–æ–º–µ–Ω—Ç –ø–æ–ª–∏–≤–∞ –ø–æ —Ä–µ–∑–∫–æ–º—É –∏–∑–º–µ–Ω–µ–Ω–∏—é –≤–ª–∞–∂–Ω–æ—Å—Ç–∏
    
    Args:
        moisture_readings: —Å–ø–∏—Å–æ–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π –≤–ª–∞–∂–Ω–æ—Å—Ç–∏
        timestamp: –≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è
    
    Returns:
        dict: –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª–∏–≤–µ –∏–ª–∏ None –µ—Å–ª–∏ –ø–æ–ª–∏–≤ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω
    """
    # –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª–∏–≤–∞
    MOISTURE_THRESHOLD = 15  # % 
    # –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–≤—ã—à–µ–Ω–Ω–æ–π –≤–ª–∞–∂–Ω–æ—Å—Ç–∏
    MIN_DURATION = 300  # —Å–µ–∫—É–Ω–¥ (5 –º–∏–Ω—É—Ç)
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–∑–∫–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ –≤–ª–∞–∂–Ω–æ—Å—Ç–∏
    if len(moisture_readings) < 2:
        return None
        
    current = moisture_readings[-1]["value"]
    previous = moisture_readings[-2]["value"]
    moisture_change = current - previous
    
    if moisture_change >= MOISTURE_THRESHOLD:
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–µ—Ä–∂–∏—Ç—Å—è –ª–∏ –≤–ª–∞–∂–Ω–æ—Å—Ç—å –Ω–∞ –ø–æ–≤—ã—à–µ–Ω–Ω–æ–º —É—Ä–æ–≤–Ω–µ
        high_moisture_duration = 0
        for reading in reversed(moisture_readings[:-1]):
            if (current - reading["value"]) >= (MOISTURE_THRESHOLD * 0.7):  # 70% –æ—Ç –ø–æ—Ä–æ–≥–∞
                high_moisture_duration += reading["interval"]
            else:
                break
                
        if high_moisture_duration >= MIN_DURATION:
            return {
                "timestamp": timestamp,
                "moisture_before": previous,
                "moisture_after": current,
                "change": moisture_change
            }
    
    return None

def update_watering_history(moisture_data):
    """
    –û–±–Ω–æ–≤–ª—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –ø–æ–ª–∏–≤–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –≤–ª–∞–∂–Ω–æ—Å—Ç–∏
    """
    watering_events = []
    moisture_readings = []
    
    for data in moisture_data:
        moisture_readings.append({
            "value": data["moisture"],
            "timestamp": data["timestamp"],
            "interval": data.get("interval", 60)  # –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏ –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
        })
        
        # –•—Ä–∞–Ω–∏–º –∏—Å—Ç–æ—Ä–∏—é —Ç–æ–ª—å–∫–æ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
        if len(moisture_readings) > 60:
            moisture_readings.pop(0)
            
        watering = detect_watering(moisture_readings, data["timestamp"])
        if watering:
            watering_events.append(watering)
            
    return watering_events
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª–∏–≤–µ

```python
def should_measure_nutrients(last_watering, current_time):
    """
    –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –º–æ–∂–Ω–æ –ª–∏ –∏–∑–º–µ—Ä—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ—á–≤—ã –ø–æ—Å–ª–µ –ø–æ–ª–∏–≤–∞
    
    Args:
        last_watering: –≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –ø–æ–ª–∏–≤–∞
        current_time: —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è
    
    Returns:
        dict: —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∏–∑–º–µ—Ä–µ–Ω–∏—è–º
    """
    if not last_watering:
        return {"can_measure": True, "reason": "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ—Å–ª–µ–¥–Ω–µ–º –ø–æ–ª–∏–≤–µ"}
        
    time_since_watering = current_time - last_watering
    
    recommendations = {
        "can_measure": False,
        "wait_time": None,
        "parameters": []
    }
    
    # –í—Ä–µ–º—è —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
    stabilization_times = {
        "moisture": 0,      # –ú–æ–∂–Ω–æ –∏–∑–º–µ—Ä—è—Ç—å —Å—Ä–∞–∑—É
        "temperature": 30,  # 30 –º–∏–Ω—É—Ç
        "ph": 120,         # 2 —á–∞—Å–∞
        "ec": 120,         # 2 —á–∞—Å–∞
        "npk": 180         # 3 —á–∞—Å–∞
    }
    
    for param, wait_time in stabilization_times.items():
        minutes_passed = time_since_watering / 60
        if minutes_passed >= wait_time:
            recommendations["parameters"].append(param)
            
    recommendations["can_measure"] = len(recommendations["parameters"]) > 0
    
    if not recommendations["can_measure"]:
        # –ù–∞—Ö–æ–¥–∏–º –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è
        min_wait = min([wait - time_since_watering/60 
                       for param, wait in stabilization_times.items()])
        recommendations["wait_time"] = round(min_wait)
        
    return recommendations
```

## –ê–ª–≥–æ—Ä–∏—Ç–º –∞–Ω–∞–ª–∏–∑–∞

### 1. –°–±–æ—Ä –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
```python
def collect_data():
    readings = []
    # –°–æ–±–∏—Ä–∞–µ–º 5 –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π
    for _ in range(5):
        reading = get_sensor_reading()
        if is_valid_reading(reading):
            readings.append(reading)
        time.sleep(30)  # 30 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –∏–∑–º–µ—Ä–µ–Ω–∏—è–º–∏
    
    return {
        "current": calculate_reliable_reading(readings),
        "crop": get_crop_parameters(),
        "stage": get_growth_stage(),
        "environment": get_environment_type(),
        "last_watering": get_last_watering_time()
    }

def is_valid_reading(reading):
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–Ω–æ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
    return (
        is_within_physical_limits(reading) and
        not is_rapid_change(reading) and
        is_sensor_stable(reading)
    )

def calculate_reliable_reading(readings):
    # –û—Ç–±—Ä–∞—Å—ã–≤–∞–µ–º –∫—Ä–∞–π–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏ —É—Å—Ä–µ–¥–Ω—è–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ
    readings.sort()
    return statistics.mean(readings[1:-1])
```

### 2. –ê–Ω–∞–ª–∏–∑ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π
```python
def analyze_deviations(data):
    deviations = []
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤—Ä–µ–º—è –∑–∞–º–µ—Ä–∞
    if not is_optimal_measurement_time(data["param_type"]):
        return {"status": "wait", "next_window": get_next_measurement_window()}
    
    # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
    for param in ["temperature", "moisture", "ph", "ec", "npk"]:
        current = data["current"][param]
        optimal = get_optimal_range(
            data["crop"], 
            param, 
            data["stage"],
            data["environment"]
        )
        
        if current < optimal["min"]:
            deviations.append({
                "param": param,
                "type": "low",
                "value": current,
                "target": optimal["optimal"],
                "severity": calculate_severity(current, optimal)
            })
        elif current > optimal["max"]:
            deviations.append({
                "param": param,
                "type": "high",
                "value": current,
                "target": optimal["optimal"],
                "severity": calculate_severity(current, optimal)
            })
    
    return deviations
```

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

### –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Ç–µ–∫—É—â–∏—Ö –ø–æ–∫–∞–∑–∞–Ω–∏–π
- üü¢ –í –ø—Ä–µ–¥–µ–ª–∞—Ö –Ω–æ—Ä–º—ã (–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ < 10%)
- üü° –õ–µ–≥–∫–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (10-20%)
- üü† –°—Ä–µ–¥–Ω–µ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (20-30%)
- üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ (>30%)

### –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –ø–æ–∫–∞–∑–∞–Ω–∏–π
```json
{
    "timestamp": "2024-03-20T08:15:00",
    "measurement_quality": "reliable|waiting|unstable",
    "readings": {
        "temperature": {
            "value": 23.5,
            "status": "normal",
            "optimal": 22.0,
            "deviation": "+1.5¬∞C"
        },
        "moisture": {
            "value": 65,
            "status": "warning",
            "optimal": 75,
            "deviation": "-10%"
        }
    },
    "recommendations": [
        {
            "parameter": "moisture",
            "action": "increase",
            "details": "–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ª–∏–≤: 2–ª/–º¬≤",
            "priority": "high"
        }
    ]
}
```

## –§–æ—Ä–º–∞—Ç—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

### 1. –°—Ä–æ—á–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
```json
{
    "type": "urgent",
    "title": "–ù–∏–∑–∫–∞—è –≤–ª–∞–∂–Ω–æ—Å—Ç—å –ø–æ—á–≤—ã",
    "description": "–¢—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ª–∏–≤",
    "current_value": 45,
    "optimal_range": {
        "min": 60,
        "optimal": 70,
        "max": 80
    },
    "action": {
        "type": "watering",
        "amount": "2–ª/–º¬≤",
        "urgency": "immediate"
    }
}
```

### 2. –ü–ª–∞–Ω–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
```json
{
    "type": "planned",
    "title": "–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è pH",
    "description": "–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ pH",
    "current_value": 7.8,
    "optimal_range": {
        "min": 6.0,
        "optimal": 6.5,
        "max": 7.0
    },
    "action": {
        "type": "ph_adjustment",
        "method": "add_sulfur",
        "amount": "30–≥/–º¬≤",
        "period": "7 –¥–Ω–µ–π"
    }
}
```

## API Endpoints

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
```http
GET /api/v1/recommendations
Query parameters:
  - crop_id: string
  - growth_stage: string
  - readings: object
```

### 2. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```http
POST /api/v1/recommendations/{id}/complete
Body:
  - action_taken: string
  - notes: string (optional)
```

## –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

1. **–õ–æ–∫–∞–ª—å–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∫—É–ª—å—Ç—É—Ä
   - –ò—Å—Ç–æ—Ä–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
   - –®–∞–±–ª–æ–Ω—ã —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

2. **–ü–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
   - –ü–æ–∫–∞–∑–∞–Ω–∏—è –¥–∞—Ç—á–∏–∫–æ–≤: –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
   - –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–Ω–¥–æ–≤: –∫–∞–∂–¥—ã–π —á–∞—Å
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π: –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–∫–∞–∑–∞–Ω–∏–π
   
3. **–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è:**
   - –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è: –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
   - –ü–ª–∞–Ω–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏: —Ä–∞–∑ –≤ —Å—É—Ç–∫–∏
   - –ü—Ä–æ—Ñ–∏–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ —Å–æ–≤–µ—Ç—ã: –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ

## –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

1. **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:**
   - –û—Å–≤–µ—â–µ–Ω–Ω–æ—Å—Ç—å
   - –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ CO‚ÇÇ
   - –ú–∏–∫—Ä–æ—ç–ª–µ–º–µ–Ω—Ç—ã

2. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏:**
   - –ú–µ—Ç–µ–æ–¥–∞–Ω–Ω—ã–µ
   - –°–∏—Å—Ç–µ–º—ã –ø–æ–ª–∏–≤–∞
   - –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∞–≥—Ä–æ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π

3. **–ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ:**
   - –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–µ–Ω–¥–æ–≤
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
   - –ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π 