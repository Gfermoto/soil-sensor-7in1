<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MODBUS RTU ะัะพัะพะบะพะป ะดะปั JXCT 7-ะฒ-1 ะะฐััะธะบะฐ ะะพัะฒั</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        .header .meta {
            opacity: 0.9;
            font-size: 1.1rem;
        }
        
        .nav {
            background: #f8f9fa;
            padding: 1rem 2rem;
            border-bottom: 1px solid #e9ecef;
        }
        
        .nav a {
            color: #667eea;
            text-decoration: none;
            margin-right: 2rem;
            font-weight: 500;
        }
        
        .nav a:hover {
            color: #764ba2;
        }
        
        .content {
            padding: 2rem;
        }
        
        .toc {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }
        
        .toc h2 {
            color: #667eea;
            margin-bottom: 1rem;
        }
        
        .toc ol {
            list-style: none;
            counter-reset: toc-counter;
        }
        
        .toc li {
            counter-increment: toc-counter;
            margin-bottom: 0.5rem;
        }
        
        .toc li::before {
            content: counter(toc-counter) ". ";
            font-weight: bold;
            color: #667eea;
        }
        
        .toc a {
            color: #333;
            text-decoration: none;
        }
        
        .toc a:hover {
            color: #667eea;
        }
        
        h2 {
            color: #667eea;
            margin: 2rem 0 1rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e9ecef;
        }
        
        h3 {
            color: #764ba2;
            margin: 1.5rem 0 1rem 0;
        }
        
        h4 {
            color: #764ba2;
            margin: 1rem 0 0.5rem 0;
        }
        
        p {
            margin-bottom: 1rem;
        }
        
        ul, ol {
            margin-bottom: 1rem;
            padding-left: 2rem;
        }
        
        li {
            margin-bottom: 0.5rem;
        }
        
        code {
            background: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        
        pre {
            background: #f8f9fa;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
        }
        
        pre code {
            background: none;
            padding: 0;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }
        
        th, td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e9ecef;
        }
        
        th {
            background: #667eea;
            color: white;
        }
        
        tr:nth-child(even) {
            background: #f8f9fa;
        }
        
        .back-link {
            display: inline-block;
            margin-top: 2rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            transition: transform 0.2s;
        }
        
        .back-link:hover {
            transform: translateY(-2px);
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin: 1.5rem 0;
        }
        
        .feature-card {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .feature-card h4 {
            color: #667eea;
            margin-bottom: 1rem;
        }
        
        blockquote {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 1rem;
            margin: 1rem 0;
            font-style: italic;
        }
        
        hr {
            border: none;
            border-top: 2px solid #e9ecef;
            margin: 2rem 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MODBUS RTU ะัะพัะพะบะพะป ะดะปั JXCT 7-ะฒ-1 ะะฐััะธะบะฐ ะะพัะฒั</h1>
            <div class="meta">
                <strong>ะะตััะธั:</strong> 3.4.9 | 
                <strong>ะะฐัะฐ:</strong> ะัะฝั 2025 | 
                <strong>ะะฒัะพั:</strong> JXCT Development Team
            </div>
        </div>
        
        <div class="nav">
            <a href="../index.html">๐ ะะปะฐะฒะฝะฐั</a> <a href="USER_GUIDE.html">๐ค ะัะบะพะฒะพะดััะฒะพ ะฟะพะปัะทะพะฒะฐัะตะปั</a> <a href="TECHNICAL_DOCS.html">๐ง ะขะตัะฝะธัะตัะบะฐั ะดะพะบัะผะตะฝัะฐัะธั</a> <a href="API.html">๐ก API</a> <a href="CONFIG_MANAGEMENT.html">โ๏ธ ะะพะฝัะธะณััะฐัะธั</a> <a href="../html/index.html">๐ API ะดะพะบัะผะตะฝัะฐัะธั</a>
        </div>
        
        <div class="content">
            
**ะะตััะธั:** 3.4.9  
**ะะฐัะฐ:** ะัะฝั 2025  
**ะะฒัะพั:** JXCT Development Team

<p>---</p>

<h2>๐ ะกะพะดะตัะถะฐะฝะธะต</h2>

<ul><li>[๐ ะะฑะทะพั](#-ะพะฑะทะพั)</li><li>[๐ง ะขะตัะฝะธัะตัะบะธะต ัะฐัะฐะบัะตัะธััะธะบะธ](#-ัะตัะฝะธัะตัะบะธะต-ัะฐัะฐะบัะตัะธััะธะบะธ)</li><li>[๐ ะะฐััะฐ ัะตะณะธัััะพะฒ](#-ะบะฐััะฐ-ัะตะณะธัััะพะฒ)</li><li>[๐ ะัะธะผะตัั ะฟัะพัะพะบะพะปะฐ](#-ะฟัะธะผะตัั-ะฟัะพัะพะบะพะปะฐ)</li><li>[๐ง ะกัะตะผะฐ ะฟะพะดะบะปััะตะฝะธั ESP32](#-ััะตะผะฐ-ะฟะพะดะบะปััะตะฝะธั-esp32)</li><li>[โก ะะฟัะธะผะธะทะฐัะธั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ](#-ะพะฟัะธะผะธะทะฐัะธั-ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ)</li><li>[๐ ะัะปะฐะดะบะฐ ะธ ะดะธะฐะณะฝะพััะธะบะฐ](#-ะพัะปะฐะดะบะฐ-ะธ-ะดะธะฐะณะฝะพััะธะบะฐ)</li><li>[๐ ะะตะทะพะฟะฐัะฝะพััั](#-ะฑะตะทะพะฟะฐัะฝะพััั)</li><li>[๐ ะกะฒัะทะฐะฝะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั](#-ัะฒัะทะฐะฝะฝะฐั-ะดะพะบัะผะตะฝัะฐัะธั)</li></ul>

<p>---</p>

<h2>๐ ะะฑะทะพั</h2>

<p>ะะฐััะธะบ JXCT 7-ะฒ-1 ะธัะฟะพะปัะทัะตั ะฟัะพัะพะบะพะป **Modbus RTU** ัะตัะตะท ะธะฝัะตััะตะนั **RS485** ะดะปั ะฟะตัะตะดะฐัะธ ะดะฐะฝะฝัั ะธะทะผะตัะตะฝะธะน ะฟะพัะฒั. ะญัะพั ะดะพะบัะผะตะฝั ัะพะดะตัะถะธั ะฟะพะปะฝัั ัะตัะฝะธัะตัะบัั ัะฟะตัะธัะธะบะฐัะธั ะฟัะพัะพะบะพะปะฐ.</p>

<h2>๐ง ะขะตัะฝะธัะตัะบะธะต ัะฐัะฐะบัะตัะธััะธะบะธ</h2>

<h3>ะะฐัััะพะนะบะธ ะฟะพััะฐ (UART2)</h3>
``<code>
ะะฐัะฐะผะตัั            โ ะะฝะฐัะตะฝะธะต
โโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโ
ะกะบะพัะพััั ะฟะตัะตะดะฐัะธ   โ 9600 baud
ะะธัั ะดะฐะฝะฝัั         โ 8 bits
ะงะตัะฝะพััั            โ None (N)
ะกัะพะฟ ะฑะธัั           โ 1 bit
ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะพัะพะบะพะผ  โ None
ะคะพัะผะฐั              โ 8N1
ะะฝัะตััะตะนั           โ RS485 ะฟะพะปัะดัะฟะปะตะบั
</code>`<code>

<h3>ะะฐัะฐะผะตััั MODBUS</h3>
</code>`<code>
ะะฐัะฐะผะตัั                โ ะะฝะฐัะตะฝะธะต
โโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโ
ะัะพัะพะบะพะป                โ Modbus RTU
ะะดัะตั ััััะพะนััะฒะฐ        โ 1 (ะฟะพ ัะผะพะปัะฐะฝะธั, ะฝะฐัััะฐะธะฒะฐะตััั)
ะคัะฝะบัะธั ััะตะฝะธั          โ 0x03 (Read Holding Registers)
ะคัะฝะบัะธั ะทะฐะฟะธัะธ          โ 0x06 (Write Single Register)
ะขะฐะนะผะฐัั ะพัะฒะตัะฐ          โ 1000 ะผั
ะะฐะบัะธะผัะผ ะฟะพะฟััะพะบ        โ 3
ะะฝัะตััะตะนั               โ RS485 ะฟะพะปัะดัะฟะปะตะบั
</code>`<code>

<h2>๐ ะะฐััะฐ ัะตะณะธัััะพะฒ</h2>

<h3>ะัะฝะพะฒะฝัะต ะธะทะผะตัะตะฝะธั</h3>
</code>`<code>
ะะตะณะธััั โ ะะดัะตั โ ะะฐัะฐะผะตัั           โ ะคะพัะผัะปะฐ        โ ะะดะธะฝะธัั โ ะะธะฐะฟะฐะทะพะฝ
โโโโโโโโโผโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโผโโโโโโโโโโผโโโโโโโโโโโโโโ
0x0006  โ 6     โ pH ะฟะพัะฒั           โ ะทะฝะฐัะตะฝะธะต รท 100 โ pH      โ 0.00-14.00
0x0012  โ 18    โ ะะปะฐะถะฝะพััั ะฟะพัะฒั    โ ะทะฝะฐัะตะฝะธะต รท 10  โ %       โ 0.0-100.0
0x0013  โ 19    โ ะขะตะผะฟะตัะฐัััะฐ ะฟะพัะฒั  โ ะทะฝะฐัะตะฝะธะต รท 10  โ ยฐC      โ -10.0-50.0
0x0015  โ 21    โ ะญะปะตะบััะพะฟัะพะฒะพะดะฝะพััั โ ะบะฐะบ ะตััั       โ ยตS/cm   โ 0-20000
0x001E  โ 30    โ ะะทะพั (N)           โ ะบะฐะบ ะตััั       โ ะผะณ/ะบะณ   โ 0-2000
0x001F  โ 31    โ ะคะพััะพั (P)         โ ะบะฐะบ ะตััั       โ ะผะณ/ะบะณ   โ 0-2000
0x0020  โ 32    โ ะะฐะปะธะน (K)          โ ะบะฐะบ ะตััั       โ ะผะณ/ะบะณ   โ 0-2000
</code>`<code>

<h3>ะกะธััะตะผะฝัะต ัะตะณะธัััั</h3>
</code>`<code>
ะะตะณะธััั โ ะะดัะตั โ ะะฐัะฐะผะตัั           โ ะคะพัะผัะปะฐ        โ ะะดะธะฝะธัั โ ะะพัััะฟ
โโโโโโโโโผโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโผโโโโโโโโโโผโโโโโโโโโโโโ
0x0007  โ 7     โ ะะตััะธั ะฟัะพัะธะฒะบะธ    โ ะบะฐะบ ะตััั       โ ะฒะตััะธั  โ ะขะพะปัะบะพ ััะตะฝะธะต
0x0008  โ 8     โ ะะฐะปะธะฑัะพะฒะบะฐ         โ ะบะฐะบ ะตััั       โ ัะปะฐะณะธ   โ ะงัะตะฝะธะต/ะทะฐะฟะธัั
0x000B  โ 11    โ ะกัะฐััั ะพัะธะฑะพะบ      โ ะบะฐะบ ะตััั       โ ัะปะฐะณะธ   โ ะขะพะปัะบะพ ััะตะฝะธะต
0x000C  โ 12    โ ะะดัะตั ััััะพะนััะฒะฐ   โ ะบะฐะบ ะตััั       โ ะฐะดัะตั   โ ะงัะตะฝะธะต/ะทะฐะฟะธัั
</code>`<code>

<h2>๐ ะัะธะผะตัั ะฟัะพัะพะบะพะปะฐ</h2>

<h3>1. ะงัะตะฝะธะต pH ะฟะพัะฒั (ัะตะณะธััั 0x0006)</h3>

<p>**ะะฐะฟัะพั:**
</code>`<code>
ะะฐะนั โ Hex โ ะะฟะธัะฐะฝะธะต
โโโโโโผโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
0    โ 01  โ ะะดัะตั ััััะพะนััะฒะฐ (1)
1    โ 03  โ ะคัะฝะบัะธั (Read Holding Registers)
2    โ 00  โ ะะดัะตั ัะตะณะธัััะฐ (High byte)
3    โ 06  โ ะะดัะตั ัะตะณะธัััะฐ (Low byte) - 0x0006
4    โ 00  โ ะะพะปะธัะตััะฒะพ ัะตะณะธัััะพะฒ (High byte)
5    โ 01  โ ะะพะปะธัะตััะฒะพ ัะตะณะธัััะพะฒ (Low byte) - 1
6    โ 64  โ CRC16 (High byte)
7    โ 0B  โ CRC16 (Low byte)
</code>`<code></p>

**ะัะฒะตั:**
</code>`<code>
ะะฐะนั โ Hex โ ะะฟะธัะฐะฝะธะต
โโโโโโผโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
0    โ 01  โ ะะดัะตั ััััะพะนััะฒะฐ (1)
1    โ 03  โ ะคัะฝะบัะธั (Read Holding Registers)
2    โ 02  โ ะะพะปะธัะตััะฒะพ ะฑะฐะนั ะดะฐะฝะฝัั (2)
3    โ 02  โ ะะฝะฐัะตะฝะธะต pH (High byte)
4    โ BC  โ ะะฝะฐัะตะฝะธะต pH (Low byte)
5    โ 38  โ CRC16 (High byte)
6    โ 05  โ CRC16 (Low byte)
</code>`<code>

<p>**ะะฐััะตั ะทะฝะฐัะตะฝะธั:**
</code>`<code>
Hex ะทะฝะฐัะตะฝะธะต: 0x02BC = 700 (decimal)
pH = 700 รท 100 = 7.00
</code>`<code></p>

<h3>2. ะงัะตะฝะธะต ัะตะผะฟะตัะฐัััั ะฟะพัะฒั (ัะตะณะธััั 0x0013)</h3>

<p>**ะะฐะฟัะพั:**
</code>`<code>
01 03 00 13 00 01 74 0F
</code>`<code></p>

**ะัะฒะตั:**
</code>`<code>
01 03 02 00 ED 78 B8
</code>`<code>

<p>**ะะฐััะตั ะทะฝะฐัะตะฝะธั:**
</code>`<code>
Hex ะทะฝะฐัะตะฝะธะต: 0x00ED = 237 (decimal)
ะขะตะผะฟะตัะฐัััะฐ = 237 รท 10 = 23.7ยฐC
</code>`<code></p>

<h3>3. ะงัะตะฝะธะต ะฝะตัะบะพะปัะบะธั ัะตะณะธัััะพะฒ (NPK)</h3>

<p>**ะะฐะฟัะพั (ัะตะณะธัััั 0x001E-0x0020):**
</code>`<code>
01 03 00 1E 00 03 65 CC
</code>`<code></p>

**ะัะฒะตั:**
</code>`<code>
01 03 06 01 5E 01 F3 03 D6 XX XX
</code>`<code>

<p>**ะะฐััะตั ะทะฝะฐัะตะฝะธะน:**
</code>`<code>
ะะทะพั (N):    0x015E = 350 ะผะณ/ะบะณ
ะคะพััะพั (P):  0x01F3 = 499 ะผะณ/ะบะณ  
ะะฐะปะธะน (K):   0x03D6 = 982 ะผะณ/ะบะณ
</code>`<code></p>

<h2>๐ง ะกัะตะผะฐ ะฟะพะดะบะปััะตะฝะธั ESP32</h2>

<h3>ะคะธะทะธัะตัะบะพะต ะฟะพะดะบะปััะตะฝะธะต</h3>

<h4>RS-485 ะธะฝัะตััะตะนั</h4>
<ul><li>ะัะฟะพะปัะทัะตััั ััะฐะฝัะธะฒะตั SP3485E</li><li>ะกะบะพัะพััั ะฟะตัะตะดะฐัะธ: ะดะพ 10 Mbps</li><li>ะะฐัะธัะฐ ะพั ESD: ยฑ15kV HBM</li><li>ะะธัะฐะฝะธะต: 3.3V (ะพะฟัะธะผะฐะปัะฝะพ ะดะปั ESP32)</li></ul>

<h4>ะะพะดะบะปััะตะฝะธะต SP3485E</h4>
</code>`<code>
ESP32 GPIO   โ SP3485E Pin โ ะคัะฝะบัะธั
โโโโโโโโโโโโโโผโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
GPIO16       โ RO         โ Receive Output (ะบ UART RX)
GPIO17       โ DI         โ Data Input (ะพั UART TX)
GPIO4        โ DE         โ Driver Enable (ัะฟัะฐะฒะปะตะฝะธะต ะฟะตัะตะดะฐััะธะบะพะผ)
GPIO5        โ RE         โ Receiver Enable (ัะฟัะฐะฒะปะตะฝะธะต ะฟัะธะตะผะฝะธะบะพะผ)
GND          โ GND        โ ะะฑัะธะน ะฟัะพะฒะพะด
3.3V         โ VCC        โ ะะธัะฐะฝะธะต ะผะพะดัะปั
</code>`<code>

<h4>ะะฐะถะฝะพััั ัะฐะทะดะตะปัะฝะพะณะพ ัะฟัะฐะฒะปะตะฝะธั DE ะธ RE</h4>
<ul><li>**DE (Driver Enable)** - ัะฟัะฐะฒะปัะตั ะฟะตัะตะดะฐััะธะบะพะผ:</li></ul>
  - HIGH: ะฟะตัะตะดะฐััะธะบ ะฐะบัะธะฒะตะฝ (ะดะปั ะพัะฟัะฐะฒะบะธ ะดะฐะฝะฝัั)
  - LOW: ะฟะตัะตะดะฐััะธะบ ะฒ ะฒััะพะบะพะธะผะฟะตะดะฐะฝัะฝะพะผ ัะพััะพัะฝะธะธ
<ul><li>**RE (Receiver Enable)** - ัะฟัะฐะฒะปัะตั ะฟัะธะตะผะฝะธะบะพะผ:</li></ul>
  - HIGH: ะฟัะธะตะผะฝะธะบ ะพัะบะปััะตะฝ (ะฒะพ ะฒัะตะผั ะฟะตัะตะดะฐัะธ)
  - LOW: ะฟัะธะตะผะฝะธะบ ะฐะบัะธะฒะตะฝ (ะดะปั ะฟัะธะตะผะฐ ะดะฐะฝะฝัั)

<p>ะะฐะทะดะตะปัะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต ััะธะผะธ ะฟะธะฝะฐะผะธ ะพะฑะตัะฟะตัะธะฒะฐะตั:
<ul><li>ะะพะปะตะต ัะพัะฝัะน ะบะพะฝััะพะปั ะฝะฐะด ะฒัะตะผะตะฝะตะผ ะฟะตัะตะบะปััะตะฝะธั</li><li>ะะพะทะผะพะถะฝะพััั ัะพะฝะบะพะน ะฝะฐัััะพะนะบะธ ะทะฐะดะตัะถะตะบ</li><li>ะัะตะดะพัะฒัะฐัะตะฝะธะต ะบะพะปะปะธะทะธะน ะฝะฐ ัะธะฝะต RS-485</li><li>ะฃะปัััะตะฝะฝัั ะฟะพะผะตัะพะทะฐัะธัะตะฝะฝะพััั</li></ul></p>

<h4>ะัะตะผะตะฝะฝัะต ะดะธะฐะณัะฐะผะผั ะฟะตัะตะบะปััะตะฝะธั</h4>

</code>`<code>
DE โโโ          โโโโโโโโโโ          โโโโโโโโโ
     โ          โ        โ          โ
     โโโโโโโโโโโโ        โโโโโโโโโโโโ

<p>RE โโโ          โโโโโโโโโโ          โโโโโโโโโ
     โ          โ        โ          โ
     โโโโโโโโโโโโ        โโโโโโโโโโโโ
     โโ ะฟัะธะตะผ โโโคโโ ะฟะตัะตะดะฐัะฐ โโคโโ ะฟัะธะตะผ โโโค
     
     โโโ 50ยตs โโบโ          โโโ 50ยตs โโบโ
</code>`<code></p>

ะะฐะดะตัะถะบะธ ะฟะตัะตะบะปััะตะฝะธั:
<ul><li>50 ะผะธะบัะพัะตะบัะฝะด ะฟะตัะตะด ะฟะตัะตะดะฐัะตะน (preTransmission)</li><li>50 ะผะธะบัะพัะตะบัะฝะด ะฟะพัะปะต ะฟะตัะตะดะฐัะธ (postTransmission)</li></ul>

<h3>ะะพะดะบะปััะตะฝะธะต ะบ ะดะฐััะธะบั JXCT</h3>
</code>`<code>
Transceiver  โ JXCT Sensor โ ะฆะฒะตั ะฟัะพะฒะพะดะฐ โ ะคัะฝะบัะธั
โโโโโโโโโโโโโโผโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโ
A+ Terminal  โ A+          โ ะะตะปััะน       โ RS485 Data+
B- Terminal  โ B-          โ ะกะธะฝะธะน        โ RS485 Data-
</code>`<code>

<h3>ะะธัะฐะฝะธะต ะดะฐััะธะบะฐ (ะพัะดะตะปัะฝะพะต!)</h3>
</code>`<code>
ะััะพัะฝะธะบ     โ JXCT Sensor โ ะฆะฒะตั ะฟัะพะฒะพะดะฐ โ ะคัะฝะบัะธั
โโโโโโโโโโโโโโผโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโ
12-24V DC+   โ VCC         โ ะัะฐัะฝัะน      โ ะะธัะฐะฝะธะต ะดะฐััะธะบะฐ
GND          โ GND         โ ะงะตัะฝัะน       โ ะะฑัะธะน ะผะธะฝัั
</code>`<code>

<h2>โ๏ธ ะะตะฐะปะธะทะฐัะธั ะฒ ะบะพะดะต ESP32</h2>

<h3>ะะฝะธัะธะฐะปะธะทะฐัะธั UART ะธ SP3485E</h3>

</code>`<code>cpp
void setupModbus() {
    // ะะฐัััะพะนะบะฐ UART2 ะดะปั Modbus
    Serial2.begin(9600, SERIAL_8N1, MODBUS_RX_PIN, MODBUS_TX_PIN);
    
    // ะะฐัััะพะนะบะฐ ะฟะธะฝะพะฒ SP3485E
    pinMode(MODBUS_DE_PIN, OUTPUT);    // GPIO4
    pinMode(MODBUS_RE_PIN, OUTPUT);    // GPIO5
    digitalWrite(MODBUS_DE_PIN, LOW);  // ะะตัะตะดะฐััะธะบ ะฒัะบะปััะตะฝ
    digitalWrite(MODBUS_RE_PIN, LOW);  // ะัะธะตะผะฝะธะบ ะฒะบะปััะตะฝ
    
    // ะะฝะธัะธะฐะปะธะทะฐัะธั Modbus
    node.begin(SENSOR_ID, Serial2);
    
    // ะะฐัััะพะนะบะฐ ะพะฑัะฐะฑะพััะธะบะพะฒ ะฟะตัะตะบะปััะตะฝะธั ัะตะถะธะผะฐ
    node.preTransmission(preTransmission);   // ะะตัะตะด ะฟะตัะตะดะฐัะตะน
    node.postTransmission(postTransmission); // ะะพัะปะต ะฟะตัะตะดะฐัะธ
}

<p>// ะฃะฟัะฐะฒะปะตะฝะธะต ะฝะฐะฟัะฐะฒะปะตะฝะธะตะผ ะฟะตัะตะดะฐัะธ SP3485E
void preTransmission() {
    digitalWrite(MODBUS_DE_PIN, HIGH);  // ะะตะถะธะผ ะฟะตัะตะดะฐัะธ
    delayMicroseconds(50);
}</p>

void postTransmission() {
    delayMicroseconds(50);
    digitalWrite(MODBUS_RE_PIN, LOW);   // ะะตะถะธะผ ะฟัะธะตะผะฐ
}
</code>`<code>

<h3>ะงัะตะฝะธะต ะดะฐะฝะฝัั</h3>
</code>`<code>cpp
void readSensorData() {
    // ะงัะตะฝะธะต pH
    uint8_t result = modbus.readHoldingRegisters(0x0006, 1);
    if (result == modbus.ku8MBSuccess) {
        uint16_t ph_raw = modbus.getResponseBuffer(0);
        float ph = ph_raw / 100.0;
    }
    
    // ะงัะตะฝะธะต ัะตะผะฟะตัะฐัััั
    result = modbus.readHoldingRegisters(0x0013, 1);
    if (result == modbus.ku8MBSuccess) {
        uint16_t temp_raw = modbus.getResponseBuffer(0);
        float temperature = temp_raw / 10.0;
    }
    
    // ะงัะตะฝะธะต NPK (3 ัะตะณะธัััะฐ ะทะฐ ะพะดะธะฝ ะทะฐะฟัะพั)
    result = modbus.readHoldingRegisters(0x001E, 3);
    if (result == modbus.ku8MBSuccess) {
        uint16_t nitrogen = modbus.getResponseBuffer(0);
        uint16_t phosphorus = modbus.getResponseBuffer(1);
        uint16_t potassium = modbus.getResponseBuffer(2);
    }
}
</code>`<code>

<h2>๐๏ธ ะะธะฐะณะฝะพััะธะบะฐ ะธ ะพัะปะฐะดะบะฐ</h2>

<h3>ะะพะดั ะพัะธะฑะพะบ ModbusMaster</h3>
</code>`<code>
ะะพะด โ ะะพะฝััะฐะฝัะฐ              โ ะะฟะธัะฐะฝะธะต
โโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
0   โ ku8MBSuccess           โ ะฃัะฟะตัะฝะพะต ะฒัะฟะพะปะฝะตะฝะธะต
1   โ ku8MBIllegalFunction   โ ะะตะดะพะฟัััะธะผะฐั ััะฝะบัะธั
2   โ ku8MBIllegalDataAddressโ ะะตะดะพะฟัััะธะผัะน ะฐะดัะตั ะดะฐะฝะฝัั
3   โ ku8MBIllegalDataValue  โ ะะตะดะพะฟัััะธะผะพะต ะทะฝะฐัะตะฝะธะต ะดะฐะฝะฝัั
4   โ ku8MBSlaveDeviceFailureโ ะัะธะฑะบะฐ ะฒะตะดะพะผะพะณะพ ััััะพะนััะฒะฐ
224 โ ku8MBInvalidSlaveID    โ ะะตะดะพะฟัััะธะผัะน ID ััััะพะนััะฒะฐ
225 โ ku8MBInvalidFunction   โ ะะตะดะพะฟัััะธะผะฐั ััะฝะบัะธั
226 โ ku8MBResponseTimedOut  โ ะขะฐะนะผะฐัั ะพัะฒะตัะฐ
227 โ ku8MBInvalidCRC        โ ะัะธะฑะบะฐ CRC
</code>`<code>

<h3>ะัะพะฒะตัะบะฐ ัะฒัะทะธ</h3>
</code>`<code>cpp
bool testModbusConnection() {
    logSystem("ะขะตัั ัะฒัะทะธ ั ะดะฐััะธะบะพะผ JXCT...");
    
    // ะะพะฟััะบะฐ ััะตะฝะธั ะฒะตััะธะธ ะฟัะพัะธะฒะบะธ
    uint8_t result = modbus.readHoldingRegisters(0x0007, 1);
    
    if (result == modbus.ku8MBSuccess) {
        uint16_t version = modbus.getResponseBuffer(0);
        logSuccess("ะะฐััะธะบ ะฝะฐะนะดะตะฝ! ะะตััะธั ะฟัะพัะธะฒะบะธ: %d.%d", 
                  (version >> 8) & 0xFF, version & 0xFF);
        return true;
    } else {
        logError("ะัะธะฑะบะฐ ัะฒัะทะธ ั ะดะฐััะธะบะพะผ: %d", result);
        return false;
    }
}
</code>`<code>

<h2>๐ ะะฐััะตั CRC16</h2>

<p>MODBUS RTU ะธัะฟะพะปัะทัะตั CRC16 ั ะฟะพะปะธะฝะพะผะพะผ 0xA001:</p>

</code>`<code>cpp
uint16_t calculateCRC16(uint8_t* data, size_t length) {
    uint16_t crc = 0xFFFF;
    
    for (size_t i = 0; i < length; i++) {
        crc ^= (uint16_t)data[i];
        for (int j = 0; j < 8; j++) {
            if (crc & 0x0001) {
                crc = (crc >> 1) ^ 0xA001;
            } else {
                crc = crc >> 1;
            }
        }
    }
    
    return crc;
}
</code>`<code>

<h2>๐จ ะขะธะฟะธัะฝัะต ะฟัะพะฑะปะตะผั ะธ ัะตัะตะฝะธั</h2>

<h3>1. ะขะฐะนะผะฐัั ะพัะฒะตัะฐ (ku8MBResponseTimedOut)</h3>
**ะัะธัะธะฝั:**
<ul><li>ะะตะฟัะฐะฒะธะปัะฝะพะต ะฟะพะดะบะปััะตะฝะธะต A+/B-</li><li>ะะตะธัะฟัะฐะฒะฝะพััั ะบะฐะฑะตะปั RS485</li><li>ะะตะฟัะฐะฒะธะปัะฝัะน ะฐะดัะตั ััััะพะนััะฒะฐ</li><li>ะัะพะฑะปะตะผั ั ะฟะธัะฐะฝะธะตะผ ะดะฐััะธะบะฐ</li></ul>

<p>**ะะตัะตะฝะธะต:**
</code>`<code>cpp
// ะัะพะฒะตัะบะฐ ะฟะพะดะบะปััะตะฝะธั
if (!testModbusConnection()) {
    logError("ะัะพะฒะตัััะต ะฟะพะดะบะปััะตะฝะธะต RS485 ะธ ะฟะธัะฐะฝะธะต ะดะฐััะธะบะฐ");
}
</code>`<code></p>

<h3>2. ะัะธะฑะบะฐ CRC (ku8MBInvalidCRC)</h3>
**ะัะธัะธะฝั:**
<ul><li>ะะพะผะตัะธ ะฒ ะปะธะฝะธะธ RS485</li><li>ะะปะพัะพะต ะบะฐัะตััะฒะพ ะบะฐะฑะตะปั</li><li>ะะตะฟัะฐะฒะธะปัะฝะฐั ัะบะพัะพััั ะฟะตัะตะดะฐัะธ</li></ul>

<p>**ะะตัะตะฝะธะต:**
<ul><li>ะัะฟะพะปัะทะพะฒะฐัั ัะบัะฐะฝะธัะพะฒะฐะฝะฝัะน ะบะฐะฑะตะปั</li><li>ะัะพะฒะตัะธัั ะทะฐะทะตะผะปะตะฝะธะต</li><li>ะะพะฑะฐะฒะธัั ัะตัะผะธะฝะฐะปัะฝัะต ัะตะทะธััะพัั (120 ะะผ)</li></ul></p>

<h3>3. ะะตะดะพะฟัััะธะผัะน ะฐะดัะตั ะดะฐะฝะฝัั (ku8MBIllegalDataAddress)</h3>
**ะัะธัะธะฝั:**
<ul><li>ะะฐะฟัะพั ะฝะตัััะตััะฒัััะตะณะพ ัะตะณะธัััะฐ</li><li>ะะฐะทะปะธัะธั ะฒ ะฒะตััะธัั ะฟัะพัะธะฒะบะธ ะดะฐััะธะบะฐ</li></ul>

<p>**ะะตัะตะฝะธะต:**
</code>`<code>cpp
// ะัะพะฒะตัะบะฐ ะฟะพะดะดะตัะถะธะฒะฐะตะผัั ัะตะณะธัััะพะฒ
const uint16_t test_registers[] = {0x0006, 0x0012, 0x0013, 0x0015};
for (int i = 0; i < 4; i++) {
    uint8_t result = modbus.readHoldingRegisters(test_registers[i], 1);
    if (result != modbus.ku8MBSuccess) {
        logWarn("ะะตะณะธััั 0x%04X ะฝะตะดะพัััะฟะตะฝ: %d", test_registers[i], result);
    }
}
</code>`<code></p>

<h2>๐ ะะฐะปะธะดะฐัะธั ะดะฐะฝะฝัั</h2>

<h3>ะะพะฟัััะธะผัะต ะดะธะฐะฟะฐะทะพะฝั</h3>
</code>`<code>cpp
bool validateSensorData(SensorData& data) {
    // ะขะตะผะฟะตัะฐัััะฐ: -10ยฐC ะดะพ +50ยฐC
    if (data.temperature < -10.0 || data.temperature > 50.0) return false;
    
    // ะะปะฐะถะฝะพััั: 0% ะดะพ 100%
    if (data.humidity < 0.0 || data.humidity > 100.0) return false;
    
    // pH: 0 ะดะพ 14
    if (data.ph < 0.0 || data.ph > 14.0) return false;
    
    // EC: 0 ะดะพ 20000 ยตS/cm
    if (data.ec < 0.0 || data.ec > 20000.0) return false;
    
    // NPK: 0 ะดะพ 2000 ะผะณ/ะบะณ
    if (data.nitrogen < 0.0 || data.nitrogen > 2000.0) return false;
    if (data.phosphorus < 0.0 || data.phosphorus > 2000.0) return false;
    if (data.potassium < 0.0 || data.potassium > 2000.0) return false;
    
    return true;
}
</code>`<code>

<h2>๐ ะกะฟัะฐะฒะพัะฝะฐั ะธะฝัะพัะผะฐัะธั</h2>

<h3>ะะพะบัะผะตะฝัะฐัะธั ะฟัะพะธะทะฒะพะดะธัะตะปั</h3>
<ul><li>**ะัะพะธะทะฒะพะดะธัะตะปั:** JXCT (Jingxun Changtong)</li><li>**ะะพะดะตะปั:** JXBS-3001 7-in-1 Soil Sensor</li><li>**ะะฝัะตััะตะนั:** RS485 Modbus RTU</li><li>**ะะธัะฐะฝะธะต:** 12-24V DC</li><li>**ะัะพัะพะบะพะป:** Modbus RTU</li></ul>

<h3>ะกะฒัะทะฐะฝะฝัะต ัะฐะนะปั ะฟัะพะตะบัะฐ</h3>
<ul><li></code>src/modbus_sensor.h<code> - ะะฟัะตะดะตะปะตะฝะธั ะบะพะฝััะฐะฝั ะธ ััััะบััั</li><li></code>src/modbus_sensor.cpp<code> - ะะตะฐะปะธะทะฐัะธั ััะฝะบัะธะน</li><li></code>include/jxct_config_vars.h<code> - ะะฐัััะพะนะบะธ ะฟะธะฝะพะฒ</li><li></code>docs/API.md` - REST API ะดะพะบัะผะตะฝัะฐัะธั</li></ul>

<p>---</p>

*ะะพะบัะผะตะฝั ะพะฑะฝะพะฒะปะตะฝ ะดะปั ะฒะตััะธะธ JXCT v2.4.3*

<h2>๐ ะะพะดะดะตัะถะบะฐ</h2>

<h3>๐ฌ ะกะฒัะทั ั ัะฐะทัะฐะฑะพััะธะบะฐะผะธ</h3>
<ul><li>**Telegram:** [@Gfermoto](https://t.me/Gfermoto)</li><li>**GitHub Issues:** [ะกะพะพะฑัะธัั ะพ ะฟัะพะฑะปะตะผะต](https://github.com/Gfermoto/soil-sensor-7in1/issues)</li><li>**ะะพะบัะผะตะฝัะฐัะธั:** [GitHub Pages](https://gfermoto.github.io/soil-sensor-7in1/)</li></ul>

<h3>๐ ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะตััััั</h3>
<ul><li>[ะัะบะพะฒะพะดััะฒะพ ะฟะพะปัะทะพะฒะฐัะตะปั](USER_GUIDE.md)</li><li>[ะขะตัะฝะธัะตัะบะฐั ะดะพะบัะผะตะฝัะฐัะธั](TECHNICAL_DOCS.md)</li><li>[ะะณัะพะฝะพะผะธัะตัะบะธะต ัะตะบะพะผะตะฝะดะฐัะธะธ](AGRO_RECOMMENDATIONS.md)</li><li>[ะัะบะพะฒะพะดััะฒะพ ะฟะพ ะบะพะผะฟะตะฝัะฐัะธะธ](COMPENSATION_GUIDE.md)</li><li>[API ะดะพะบัะผะตะฝัะฐัะธั](API.md)</li><li>[ะฃะฟัะฐะฒะปะตะฝะธะต ะบะพะฝัะธะณััะฐัะธะตะน](CONFIG_MANAGEMENT.md)</li><li>[ะกัะตะผะฐ ะฟะพะดะบะปััะตะฝะธั](WIRING_DIAGRAM.md)</li><li>[ะฃะฟัะฐะฒะปะตะฝะธะต ะฒะตััะธัะผะธ](VERSION_MANAGEMENT.md)</li></ul>

<h3>๐ ะะพะปะตะทะฝัะต ัััะปะบะธ</h3>

<ul><li>[๐ฑ GitHub ัะตะฟะพะทะธัะพัะธะน](https://github.com/Gfermoto/soil-sensor-7in1) - ะััะพะดะฝัะน ะบะพะด ะฟัะพะตะบัะฐ</li><li>[๐ ะะปะฐะฝ ัะตัะฐะบัะพัะธะฝะณะฐ](../dev/QA_REFACTORING_PLAN_2025H2.md) - ะะปะฐะฝั ัะฐะทะฒะธัะธั ะฝะฐ 2025</li><li>[๐ ะััะตั ะพ ัะตัะฝะธัะตัะบะพะผ ะดะพะปะณะต](../dev/TECH_DEBT_REPORT_2025-06.md) - ะะฝะฐะปะธะท ัะตัะฝะธัะตัะบะธั ะฟัะพะฑะปะตะผ</li><li>[๐๏ธ ะััะธัะตะบัััะฐ ัะธััะตะผั](../dev/ARCH_OVERALL.md) - ะะฑัะฐั ะฐััะธัะตะบัััะฐ ะฟัะพะตะบัะฐ </li></ul>
            <a href="../index.html" class="back-link">โ ะะตัะฝััััั ะฝะฐ ะณะปะฐะฒะฝัั</a>
        </div>
    </div>
</body>
</html>