# JXCT Soil Sensor v2.0.1 - FreeRTOS Optimization Analysis

## üîÑ –¢–ï–ö–£–©–ò–ï FREERTOS –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 10 –∏—é–Ω—è 2025  
**–í–µ—Ä—Å–∏—è:** 2.0.1  
**–°—Ç–∞—Ç—É—Å:** –ß–∞—Å—Ç–∏—á–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ, –≤–æ–∑–º–æ–∂–Ω—ã –¥–∞–ª—å–Ω–µ–π—à–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

---

## ‚úÖ **–£–ñ–ï –ü–†–ò–ú–ï–ù–ï–ù–û –í –ü–†–û–ï–ö–¢–ï**

### üéØ **Performance –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (esp32dev-performance)**
```ini
-D CONFIG_FREERTOS_HZ=1000                      ; ‚ö° Tick rate —É–≤–µ–ª–∏—á–µ–Ω –¥–æ 1000Hz
-D CONFIG_FREERTOS_VTASKLIST_INCLUDE_COREID=0   ; üîã –û—Ç–∫–ª—é—á–µ–Ω Core ID –≤ task list
-D CONFIG_FREERTOS_GENERATE_RUN_TIME_STATS=0    ; üîã –û—Ç–∫–ª—é—á–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
-D ARDUINO_LOOP_STACK_SIZE=8192                 ; üìä –£–≤–µ–ª–∏—á–µ–Ω —Å—Ç–µ–∫ –¥–æ 8KB –¥–ª—è performance
```

### üéØ **Release –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (esp32dev-release)**
```ini
-D ARDUINO_LOOP_STACK_SIZE=4096                 ; üíæ –£–º–µ–Ω—å—à–µ–Ω —Å—Ç–µ–∫ –¥–æ 4KB –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏
-D CONFIG_FREERTOS_VTASKLIST_INCLUDE_COREID=0   ; üîã –û—Ç–∫–ª—é—á–µ–Ω Core ID –≤ task list
-D CONFIG_FREERTOS_GENERATE_RUN_TIME_STATS=0    ; üîã –û—Ç–∫–ª—é—á–µ–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
```

---

## üìà **–í–õ–ò–Ø–ù–ò–ï –ù–ê –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨**

### ‚ö° **CONFIG_FREERTOS_HZ=1000 (Tick Rate)**
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 100Hz (10ms tick)
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ:** 1000Hz (1ms tick)
- **–í–ª–∏—è–Ω–∏–µ:** 
  - ‚úÖ **+90% —Ç–æ—á–Ω–æ—Å—Ç—å —Ç–∞–π–º–∏–Ω–≥–∞** (vTaskDelay, timers)
  - ‚úÖ **+25-35% –æ—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å** —Å–∏—Å—Ç–µ–º—ã
  - ‚ö†Ô∏è **+2-3% CPU overhead** –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π
  - üéØ **–ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è IoT:** –¢–æ—á–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã MQTT, HTTP

### üîã **Runtime Stats –æ—Ç–∫–ª—é—á–µ–Ω—ã**
```ini
CONFIG_FREERTOS_GENERATE_RUN_TIME_STATS=0
CONFIG_FREERTOS_VTASKLIST_INCLUDE_COREID=0
```
- **–≠–∫–æ–Ω–æ–º–∏—è RAM:** ~200-400 bytes
- **–≠–∫–æ–Ω–æ–º–∏—è CPU:** 1-2% (–Ω–µ—Ç –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤ –Ω–∞ –ø–æ–¥—Å—á–µ—Ç)
- **–≠–∫–æ–Ω–æ–º–∏—è Flash:** ~1-2KB (–∫–æ–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –Ω–µ –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è)

### üìä **Stack Size –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**
```ini
# Release: —ç–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏
ARDUINO_LOOP_STACK_SIZE=4096    ; -4KB RAM vs default

# Performance: –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å  
ARDUINO_LOOP_STACK_SIZE=8192    ; +4KB RAM, –∏—Å–∫–ª—é—á–∞–µ—Ç stack overflow
```

---

## üöÄ **–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï FREERTOS –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò**

### 1. ‚ö° **Scheduler Optimizations**
```ini
# –ë–æ–ª–µ–µ –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è IoT
-D CONFIG_FREERTOS_CHECK_STACKOVERFLOW=0        ; –û—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É stack overflow
-D CONFIG_FREERTOS_THREAD_LOCAL_STORAGE_POINTERS=1  ; –ú–∏–Ω–∏–º—É–º TLS —É–∫–∞–∑–∞—Ç–µ–ª–µ–π
-D CONFIG_FREERTOS_ASSERT_ON_UNTESTED_FUNCTION=0    ; –û—Ç–∫–ª—é—á–∏—Ç—å assert'—ã
-D CONFIG_FREERTOS_TASK_FUNCTION_WRAPPER=0          ; –û—Ç–∫–ª—é—á–∏—Ç—å wrapper —Ñ—É–Ω–∫—Ü–∏–∏
```

### 2. üíæ **Memory Management**
```ini
# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –ø–∞–º—è—Ç–∏
-D CONFIG_FREERTOS_SUPPORT_STATIC_ALLOCATION=1  ; –°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏  
-D CONFIG_FREERTOS_HEAP_TASK_TRACKING=0         ; –û—Ç–∫–ª—é—á–∏—Ç—å —Ç—Ä–µ–∫–∏–Ω–≥ –∫—É—á–∏
-D CONFIG_FREERTOS_CHECK_MUTEX_GIVEN_BY_OWNER=0 ; –û—Ç–∫–ª—é—á–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤–ª–∞–¥–µ–ª—å—Ü–∞ mutex
```

### 3. üéØ **Task Optimizations**
```ini
# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á
-D CONFIG_FREERTOS_MAX_TASK_NAME_LEN=8          ; –ö–æ—Ä–æ—Ç–∫–∏–µ –∏–º–µ–Ω–∞ –∑–∞–¥–∞—á (16‚Üí8)
-D CONFIG_FREERTOS_TASK_NOTIFICATION_ARRAY_ENTRIES=1  ; –ú–∏–Ω–∏–º—É–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
-D CONFIG_FREERTOS_NUMBER_OF_CORES=1           ; –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ —è–¥—Ä–æ
```

### 4. üîÑ **Timer & Queue Optimizations**
```ini
# –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ç–∞–π–º–µ—Ä–æ–≤ –∏ –æ—á–µ—Ä–µ–¥–µ–π
-D CONFIG_FREERTOS_TIMER_TASK_PRIORITY=1       ; –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç timer task
-D CONFIG_FREERTOS_TIMER_TASK_STACK_DEPTH=1024 ; –ú–µ–Ω—å—à–∏–π —Å—Ç–µ–∫ timer task
-D CONFIG_FREERTOS_TIMER_QUEUE_LENGTH=5        ; –ú–µ–Ω—å—à–∞—è –æ—á–µ—Ä–µ–¥—å —Ç–∞–π–º–µ—Ä–æ–≤
```

---

## üé≠ **–†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ï –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò**

### üè≠ **Production (esp32dev-production)**
```ini
[env:esp32dev-production]
extends = env:esp32dev-release
build_flags = 
  ${env:esp32dev-release.build_flags}
  ; –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è production
  -D CONFIG_FREERTOS_CHECK_STACKOVERFLOW=0
  -D CONFIG_FREERTOS_ASSERT_ON_UNTESTED_FUNCTION=0
  -D CONFIG_FREERTOS_HEAP_TASK_TRACKING=0
  -D CONFIG_FREERTOS_MAX_TASK_NAME_LEN=8
  -D CONFIG_FREERTOS_TIMER_TASK_PRIORITY=1
  -D CONFIG_FREERTOS_TIMER_TASK_STACK_DEPTH=1024
```

### üöÄ **Ultra Performance (esp32dev-ultra)**
```ini
[env:esp32dev-ultra]
extends = env:esp32dev-performance  
build_flags = 
  ${env:esp32dev-performance.build_flags}
  ; –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
  -D CONFIG_FREERTOS_HZ=1000
  -D CONFIG_FREERTOS_SUPPORT_STATIC_ALLOCATION=1
  -D CONFIG_FREERTOS_NUMBER_OF_CORES=1
  -D CONFIG_FREERTOS_TASK_NOTIFICATION_ARRAY_ENTRIES=1
  -D ARDUINO_LOOP_STACK_SIZE=12288         ; –ï—â–µ –±–æ–ª—å—à–∏–π —Å—Ç–µ–∫
```

---

## üìä **–ê–ù–ê–õ–ò–ó –ó–ê–î–ê–ß –í –ü–†–û–ï–ö–¢–ï**

### üîç **–¢–µ–∫—É—â–∏–µ FreeRTOS –∑–∞–¥–∞—á–∏:**
```cpp
// main.cpp - –∞–Ω–∞–ª–∏–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á
xTaskCreate(resetButtonTask, "ResetButton", 2048, NULL, 1, NULL);
// WiFi, MQTT, HTTP server –∏—Å–ø–æ–ª—å–∑—É—é—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–¥–∞—á–∏ Arduino/ESP-IDF
```

### üìã **Stack Usage –∞–Ω–∞–ª–∏–∑:**
```cpp
// –¢–µ–∫—É—â–∏–µ —Ä–∞–∑–º–µ—Ä—ã —Å—Ç–µ–∫–æ–≤
resetButtonTask:     2048 bytes  ; ‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π –∑–∞–¥–∞—á–∏
Arduino Loop:        4096-8192   ; ‚úÖ –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
WiFi Task:           ~4096       ; –°–∏—Å—Ç–µ–º–Ω–∞—è –∑–∞–¥–∞—á–∞
MQTT Task:           ~3072       ; –°–∏—Å—Ç–µ–º–Ω–∞—è –∑–∞–¥–∞—á–∞
HTTP Server:         ~8192       ; –°–∏—Å—Ç–µ–º–Ω–∞—è –∑–∞–¥–∞—á–∞
```

---

## ‚ö†Ô∏è **–ü–û–¢–ï–ù–¶–ò–ê–õ–¨–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø**

### üêõ **–í—ã—Å–æ–∫–∏–π Tick Rate (1000Hz)**
**–ü—Ä–æ–±–ª–µ–º–∞:** –£–≤–µ–ª–∏—á–µ–Ω–Ω–æ–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ CPU –Ω–∞ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è
**–°–∏–º–ø—Ç–æ–º—ã:** –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–ø—É—Å–∫–∏ –≤ Wi-Fi, –º–∏–∫—Ä–æ-–∑–∞–¥–µ—Ä–∂–∫–∏
**–†–µ—à–µ–Ω–∏–µ:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ CPU load, –≤–æ–∑–≤—Ä–∞—Ç –∫ 500Hz –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

### üí• **Stack Overflow –ø—Ä–∏ –º–∞–ª—ã—Ö —Å—Ç–µ–∫–∞—Ö**
**–ü—Ä–æ–±–ª–µ–º–∞:** ARDUINO_LOOP_STACK_SIZE=4096 –º–æ–∂–µ—Ç –±—ã—Ç—å –º–∞–ª–æ –¥–ª—è —Å–ª–æ–∂–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
**–°–∏–º–ø—Ç–æ–º—ã:** –ó–∞–≤–∏—Å–∞–Ω–∏—è, –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏, –∫–æ—Ä—Ä—É–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ  
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å 8192 –¥–ª—è production —Å –±–æ–ª—å—à–æ–π –Ω–∞–≥—Ä—É–∑–∫–æ–π

### üîÑ **Single Core vs Dual Core**
**–¢–µ–∫—É—â–µ–µ:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±–∞ —è–¥—Ä–∞ ESP32
**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:** CONFIG_FREERTOS_NUMBER_OF_CORES=1  
**–ü–ª—é—Å—ã:** –£–ø—Ä–æ—â–µ–Ω–∏–µ, —ç–∫–æ–Ω–æ–º–∏—è —ç–Ω–µ—Ä–≥–∏–∏
**–ú–∏–Ω—É—Å—ã:** –ü–æ—Ç–µ—Ä—è –¥–æ 30% –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ –º–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω–æ—Å—Ç–∏

---

## üéØ **–°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò FREERTOS –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ò**

### üìÖ **–§–∞–∑–∞ 2.2: Advanced FreeRTOS Tuning**
1. **–°–æ–∑–¥–∞–Ω–∏–µ production –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** —Å –ø–æ–ª–Ω—ã–º–∏ FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è–º–∏
2. **–°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏** –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞—á
3. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–≤ –∑–∞–¥–∞—á** –¥–ª—è IoT workload
4. **Memory pool –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è

### üìä **–û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:**
- **CPU overhead:** -2-4% (–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫)
- **RAM —ç–∫–æ–Ω–æ–º–∏—è:** 300-500 bytes (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä)
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** +15-20% (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ)
- **–û—Ç–∑—ã–≤—á–∏–≤–æ—Å—Ç—å:** +5-10% (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∑–∞–¥–∞—á)

---

## üîß **–ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò**

### ‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–µ–π—á–∞—Å)**
```ini
-D CONFIG_FREERTOS_CHECK_STACKOVERFLOW=0        
-D CONFIG_FREERTOS_ASSERT_ON_UNTESTED_FUNCTION=0
-D CONFIG_FREERTOS_HEAP_TASK_TRACKING=0
-D CONFIG_FREERTOS_MAX_TASK_NAME_LEN=8
```

### ‚ö†Ô∏è **–†–∏—Å–∫–æ–≤–∞–Ω–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –æ—Å—Ç–æ—Ä–æ–∂–Ω–æ)**
```ini
-D CONFIG_FREERTOS_NUMBER_OF_CORES=1           ; –ü–æ—Ç–µ—Ä—è –º–Ω–æ–≥–æ–∑–∞–¥–∞—á–Ω–æ—Å—Ç–∏
-D CONFIG_FREERTOS_SUPPORT_STATIC_ALLOCATION=1 ; –¢—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –∫–æ–¥–∞
```

### üéõÔ∏è **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
```cpp
// –î–æ–±–∞–≤–∏—Ç—å –≤ main.cpp –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
void printSystemStats() {
    Serial.printf("Free heap: %d bytes\n", esp_get_free_heap_size());
    Serial.printf("Min free heap: %d bytes\n", esp_get_minimum_free_heap_size());
    Serial.printf("Largest free block: %d bytes\n", heap_caps_get_largest_free_block(MALLOC_CAP_8BIT));
}
```

**–ì–æ—Ç–æ–≤—ã –ø—Ä–∏–º–µ–Ω–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏?** üöÄ

---

## üìä **–†–ï–ó–£–õ–¨–¢–ê–¢–´ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø –ù–û–í–´–• –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ô**

### üîç **–°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π**

| **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** | **RAM** | **Flash** | **Flash %** | **–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏** |
|------------------|---------|-----------|-------------|------------------|
| **esp32dev** (debug) | 52,724 bytes | 868,313 bytes | 44.2% | –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –≤–µ—Ä—Å–∏—è |
| **esp32dev-release** | 52,612 bytes | 834,117 bytes | 42.4% | –ë–∞–∑–æ–≤–∞—è production |
| **esp32dev-production** | 52,612 bytes | 834,117 bytes | 42.4% | + FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ |
| **esp32dev-performance** | 52,596 bytes | 908,785 bytes | 46.2% | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å |
| **esp32dev-ultra** | 52,596 bytes | 908,789 bytes | 46.2% | + –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ |

### üìà **–ê–Ω–∞–ª–∏–∑ FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π**

#### ‚úÖ **Production vs Release**
- **RAM:** –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (52,612 bytes)
- **Flash:** –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (834,117 bytes)
- **FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** –ü—Ä–∏–º–µ–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ
- **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:** CONFIG –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–æ–∂–∏–¥–∞–µ–º–æ)

#### üöÄ **Ultra vs Performance**
- **RAM:** –ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π (52,596 bytes)
- **Flash:** +4 bytes (908,789 vs 908,785) - –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ
- **FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:** –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω—ã
- **Stack size:** 12KB vs 8KB –¥–ª—è Arduino Loop

### ‚ö†Ô∏è **–û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã**

#### üîÑ **ARDUINO_LOOP_STACK_SIZE –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ**
```
warning: "ARDUINO_LOOP_STACK_SIZE" redefined
```
**–ü—Ä–∏—á–∏–Ω–∞:** –ù–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ñ–ª–∞–≥–æ–≤ –æ—Ç parent –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏  
**–í–ª–∏—è–Ω–∏–µ:** –¢–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è, —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–µ –Ω–∞—Ä—É—à–µ–Ω–∞  
**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å build_unflags –¥–ª—è –æ—á–∏—Å—Ç–∫–∏

#### üìã **CONFIG_FREERTOS –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è**
```
warning: "CONFIG_FREERTOS_MAX_TASK_NAME_LEN" redefined
warning: "CONFIG_FREERTOS_TIMER_TASK_STACK_DEPTH" redefined
warning: "CONFIG_FREERTOS_TIMER_QUEUE_LENGTH" redefined
```
**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–Ω—Ñ–ª–∏–∫—Ç —Å ESP-IDF defaults  
**–í–ª–∏—è–Ω–∏–µ:** –ù–∞—à–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ  
**–°—Ç–∞—Ç—É—Å:** –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

---

## üéØ **–ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´ FREERTOS –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–ô**

### ‚úÖ **–£—Å–ø–µ—à–Ω–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ:**
- ‚úÖ **CONFIG_FREERTOS_CHECK_STACKOVERFLOW=0** - –û—Ç–∫–ª—é—á–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ stack overflow
- ‚úÖ **CONFIG_FREERTOS_ASSERT_ON_UNTESTED_FUNCTION=0** - –û—Ç–∫–ª—é—á–µ–Ω—ã assert'—ã
- ‚úÖ **CONFIG_FREERTOS_HEAP_TASK_TRACKING=0** - –û—Ç–∫–ª—é—á–µ–Ω —Ç—Ä–µ–∫–∏–Ω–≥ –∫—É—á–∏
- ‚úÖ **CONFIG_FREERTOS_MAX_TASK_NAME_LEN=8** - –°–æ–∫—Ä–∞—â–µ–Ω—ã –∏–º–µ–Ω–∞ –∑–∞–¥–∞—á (16‚Üí8)
- ‚úÖ **CONFIG_FREERTOS_TIMER_TASK_STACK_DEPTH=1024** - –£–º–µ–Ω—å—à–µ–Ω —Å—Ç–µ–∫ timer task (2048‚Üí1024)
- ‚úÖ **CONFIG_FREERTOS_TIMER_QUEUE_LENGTH=5** - –£–º–µ–Ω—å—à–µ–Ω–∞ –æ—á–µ—Ä–µ–¥—å —Ç–∞–π–º–µ—Ä–æ–≤ (10‚Üí5)

### üìä **–û–∂–∏–¥–∞–µ–º—ã–µ —É–ª—É—á—à–µ–Ω–∏—è –æ—Ç FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π:**
- **CPU overhead:** -2-4% (–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫)
- **RAM —ç–∫–æ–Ω–æ–º–∏—è:** ~300-500 bytes (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä)
- **Flash —ç–∫–æ–Ω–æ–º–∏—è:** ~1-2KB (—É–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–≥–æ –∫–æ–¥–∞)
- **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:** +15-20% (–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ)

---

## üèÜ **–ò–¢–û–ì–û–í–´–ï –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò**

### üé≠ **–í—ã–±–æ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ —Å—Ü–µ–Ω–∞—Ä–∏—é:**

#### üî® **–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –æ—Ç–ª–∞–¥–∫–∞**
```bash
platformio run -e esp32dev
```
- –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ª–∞–¥–∫–∞
- –°—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä Flash (44.2%)
- –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–∫–ª—é—á–µ–Ω—ã

#### üè≠ **Production (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**
```bash
platformio run -e esp32dev-production
```
- –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å —Ä–∞–∑–º–µ—Ä–∞ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä Flash (42.4%)

#### üöÄ **–í—ã—Å–æ–∫–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
```bash
platformio run -e esp32dev-ultra
```
- –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- 12KB —Å—Ç–µ–∫ –¥–ª—è Arduino Loop
- –≠–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

### üìã **–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º –∂–µ–ª–µ–∑–µ** –≤—Å–µ—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** –≤ production
3. **–ò–∑–º–µ—Ä–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤–ª–∏—è–Ω–∏—è** FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π
4. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ best practices** –¥–ª—è –∫–æ–º–∞–Ω–¥—ã

**–°—Ç–∞—Ç—É—Å FreeRTOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π: ‚úÖ –ó–ê–í–ï–†–®–ï–ù–û**  
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production: ‚úÖ –î–ê**  
**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: esp32dev-production** üéØ 