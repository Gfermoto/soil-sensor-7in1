<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèóÔ∏è –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ JXCT v3.4.9</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            min-height: 100vh;
        }
        .header {
            background: linear-gradient(135deg, #2e7d32 0%, #388e3c 100%);
            color: white;
            padding: 2rem;
            text-align: center;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        .header .meta {
            margin-top: 1rem;
            opacity: 0.9;
            font-size: 0.9em;
        }
        .nav {
            background: #f8f9fa;
            padding: 1rem 2rem;
            border-bottom: 1px solid #e9ecef;
        }
        .nav a {
            color: #2e7d32;
            text-decoration: none;
            margin-right: 2rem;
            font-weight: 500;
        }
        .nav a:hover {
            text-decoration: underline;
        }
        .content {
            padding: 2rem;
        }
        h2 {
            color: #2e7d32;
            border-bottom: 2px solid #4caf50;
            padding-bottom: 0.5rem;
            margin-top: 2rem;
        }
        h3 {
            color: #388e3c;
            margin-top: 1.5rem;
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        .highlight {
            background: #e8f5e8;
            padding: 1rem;
            border-radius: 5px;
            border-left: 4px solid #4caf50;
            margin: 1rem 0;
        }
        .architecture-diagram {
            text-align: center;
            margin: 2rem 0;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 10px;
        }
        .footer {
            background: #f8f9fa;
            padding: 2rem;
            text-align: center;
            border-top: 1px solid #e9ecef;
            margin-top: 3rem;
        }
        .footer a {
            color: #2e7d32;
            text-decoration: none;
        }
        .footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèóÔ∏è –û–±—â–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ JXCT v3.4.9</h1>
            <div class="meta">
                <strong>–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:</strong> 3.4.9<br>
                <strong>–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:</strong> 2025-06-24<br>
                <strong>–°—Ç–∞—Ç—É—Å:</strong> –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å —Ñ–æ–∫—É—Å–æ–º –Ω–∞ —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å
            </div>
        </div>
        
        <div class="nav">
            <a href="../../index.html">üè† –ì–ª–∞–≤–Ω–∞—è</a>
            <a href="../manuals/USER_GUIDE.html">üìñ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</a>
            <a href="../manuals/TECHNICAL_DOCS.html">üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è</a>
            <a href="../../html/index.html">üìö Doxygen API</a>
        </div>
        
        <div class="content">
            <h2>üéØ –ü–†–ò–ù–¶–ò–ü–´ –ê–†–•–ò–¢–ï–ö–¢–£–†–´</h2>
            
            <h3>1. –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å –ø—Ä–µ–≤—ã—à–µ –≤—Å–µ–≥–æ</h3>
            <ul>
                <li>–≠–≤–æ–ª—é—Ü–∏–æ–Ω–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ –±–µ–∑ —Ä–µ–≤–æ–ª—é—Ü–∏–æ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π</li>
                <li>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∫–∞—á–µ—Å—Ç–≤–∞ –∫–æ–¥–∞ –Ω–∞–¥ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–º–∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–º–∏</li>
                <li>–¢—â–∞—Ç–µ–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π</li>
            </ul>
            
            <h3>2. –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ</h3>
            <ul>
                <li>–ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏</li>
                <li>–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π</li>
                <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –¥–ª—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏</li>
            </ul>
            
            <h3>3. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å</h3>
            <ul>
                <li>–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ –∏ Flash</li>
                <li>–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö</li>
                <li>–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –Ω–∞–∫–ª–∞–¥–Ω—ã—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤</li>
            </ul>
            
            <h2>üîß –û–°–ù–û–í–ù–´–ï –ö–û–ú–ü–û–ù–ï–ù–¢–´</h2>
            
            <h3>üì° –°–ò–°–¢–ï–ú–ê –î–ê–¢–ß–ò–ö–û–í</h3>
            
            <h4>üîå –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –¥–∞—Ç—á–∏–∫–æ–≤</h4>
            <div class="code-block">
<pre>// –§–∞–π–ª: include/ISensor.h

class ISensor {
public:
    virtual ~ISensor() = default;
    virtual bool initialize() = 0;
    virtual SensorData read() = 0;
    virtual bool isConnected() const = 0;
    virtual String getSensorInfo() const = 0;
};</pre>
            </div>
            
            <h4>üé≠ –ê–¥–∞–ø—Ç–µ—Ä—ã –¥–∞—Ç—á–∏–∫–æ–≤</h4>
            <div class="code-block">
<pre>// –§–∞–π–ª: src/modbus_sensor.h

class ModbusSensorAdapter : public ISensor {
private:
    ModbusSensor* sensor;
    
public:
    ModbusSensorAdapter(ModbusSensor* s) : sensor(s) {}
    
    bool initialize() override {
        return sensor->begin();
    }
    
    SensorData read() override {
        return sensor->getData();
    }
    
    bool isConnected() const override {
        return sensor->isConnected();
    }
    
    String getSensorInfo() const override {
        return "Modbus Sensor v" + String(sensor->getVersion());
    }
};</pre>
            </div>
            
            <h3>üßÆ –°–ò–°–¢–ï–ú–ê –ö–û–ú–ü–ï–ù–°–ê–¶–ò–ò</h3>
            
            <div class="highlight">
                <h4>‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –î–í–£–•–≠–¢–ê–ü–ù–ê–Ø –ö–û–ú–ü–ï–ù–°–ê–¶–ò–Ø</h4>
            </div>
            
            <div class="code-block">
<pre>// –§–∞–π–ª: src/modbus_sensor.cpp

void applyCompensationIfEnabled(SensorData& d, const SoilProfile& profile) {
    // –®–ê–ì 1: –ü—Ä–∏–º–µ–Ω—è–µ–º –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É CSV (–ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è –ø–æ–≤–µ—Ä–∫–∞)
    float tempCalibrated = CalibrationManager::applyCalibration(d.temperature, profile);
    float humCalibrated = CalibrationManager::applyCalibration(d.humidity, profile);
    float ecCalibrated = CalibrationManager::applyCalibration(d.ec, profile);
    float phCalibrated = CalibrationManager::applyCalibration(d.ph, profile);
    float nCalibrated = CalibrationManager::applyCalibration(d.nitrogen, profile);
    float pCalibrated = CalibrationManager::applyCalibration(d.phosphorus, profile);
    float kCalibrated = CalibrationManager::applyCalibration(d.potassium, profile);

    // –®–ê–ì 2: –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è, –≤–ª–∞–∂–Ω–æ—Å—Ç–Ω–∞—è)
    float ec25 = ecCalibrated / (1.0f + 0.021f * (tempCalibrated - 25.0f));
    d.ec = correctEC(ec25, tempCalibrated, humCalibrated, profile.soilType);
    d.ph = correctPH(phCalibrated, tempCalibrated);
    correctNPK(tempCalibrated, humCalibrated, d.nitrogen, d.phosphorus, d.potassium, profile.soilType);
}</pre>
            </div>
            
            <h4>üîß –ö–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä</h4>
            <div class="code-block">
<pre>// –§–∞–π–ª: src/calibration_manager.cpp

class CalibrationManager {
public:
    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å –ª–∏–Ω–µ–π–Ω–æ–π –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–µ–π
    static float applyCalibration(float rawValue, const CalibrationProfile& profile) {
        if (!profile.isLoaded()) {
            return rawValue; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Å—Ö–æ–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –µ—Å–ª–∏ —Ç–∞–±–ª–∏—Ü–∞ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω–∞
        }
        
        // –ü–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–∏—Ö —Ç–æ—á–µ–∫ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
        CalibrationPoint lower, upper;
        if (profile.findInterpolationPoints(rawValue, lower, upper)) {
            // –õ–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è
            float ratio = (rawValue - lower.raw) / (upper.raw - lower.raw);
            return lower.calibrated + ratio * (upper.calibrated - lower.calibrated);
        }
        
        return rawValue; // –í–Ω–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
    }
};</pre>
            </div>
            
            <h4>1Ô∏è‚É£ –ú–æ–¥–µ–ª—å –ê—Ä—á–∏ - EC –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è</h4>
            <div class="code-block">
<pre>float correctEC(float ec25, float temperature, float humidity, SoilType soilType) {
    // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è (Archie, 1942)
    float tempFactor = 1.0f + 0.021f * (temperature - 25.0f);
    
    // –í–ª–∞–∂–Ω–æ—Å—Ç–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ø–æ –º–æ–¥–µ–ª–∏ –ê—Ä—á–∏
    float porosity = getPorosity(soilType);
    float archieCoeff = getArchieCoefficient(soilType);
    float humFactor = pow(humidity / 100.0f, archieCoeff);
    
    return ec25 * tempFactor * humFactor;
}

float getArchieCoefficient(SoilType soilType) {
    switch (soilType) {
        case SAND: return 0.15f;      // –ü–µ—Å–æ–∫
        case LOAM: return 0.30f;      // –°—É–≥–ª–∏–Ω–æ–∫
        case CLAY: return 0.45f;      // –ì–ª–∏–Ω–∞
        case PEAT: return 0.10f;      // –¢–æ—Ä—Ñ
        case SANDY_PEAT: return 0.18f; // –ü–µ—Å—á–∞–Ω–æ-—Ç–æ—Ä—Ñ—è–Ω–æ–π
        default: return 0.30f;
    }
}</pre>
            </div>
            
            <h4>2Ô∏è‚É£ –£—Ä–∞–≤–Ω–µ–Ω–∏–µ –ù–µ—Ä–Ω—Å—Ç–∞ - pH –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è</h4>
            <div class="code-block">
<pre>float correctPH(float phRaw, float temperature) {
    // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –ø–æ–ø—Ä–∞–≤–∫–∞ pH –ø–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—é –ù–µ—Ä–Ω—Å—Ç–∞
    // dE/dT = -0.003 V/¬∞C –¥–ª—è pH —ç–ª–µ–∫—Ç—Ä–æ–¥–∞
    return phRaw - 0.003f * (temperature - 25.0f);
}</pre>
            </div>
            
            <h4>3Ô∏è‚É£ FAO 56 + Eur. J. Soil Sci. - NPK –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è</h4>
            <div class="code-block">
<pre>void correctNPK(float temperature, float humidity, 
                float& nitrogen, float& phosphorus, float& potassium, 
                SoilType soilType) {
    // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è NPK
    float tempFactor = 1.0f - 0.02f * (temperature - 25.0f);
    
    // –í–ª–∞–∂–Ω–æ—Å—Ç–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ø–æ FAO 56
    float humFactor = 1.0f + 0.05f * (humidity - 50.0f) / 50.0f;
    
    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏
    nitrogen *= tempFactor * humFactor;
    phosphorus *= tempFactor * humFactor;
    potassium *= tempFactor * humFactor;
}</pre>
            </div>
            
            <h2>üåê –í–ï–ë-–ò–ù–¢–ï–†–§–ï–ô–°</h2>
            
            <h3>üì± –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</h3>
            <div class="architecture-diagram">
<pre>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Web Browser   ‚îÇ    ‚îÇ   ESP32 Web     ‚îÇ    ‚îÇ   Data Storage  ‚îÇ
‚îÇ   (Frontend)    ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   Server        ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   (NVS/Flash)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                              ‚îÇ
                              ‚ñº
                       ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                       ‚îÇ   Sensor Data   ‚îÇ
                       ‚îÇ   Processing    ‚îÇ
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</pre>
            </div>
            
            <h3>üõ£Ô∏è –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è</h3>
            <div class="code-block">
<pre>// –§–∞–π–ª: src/web/routes_data.cpp

void setupDataRoutes() {
    // –û—Å–Ω–æ–≤–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã –¥–∞–Ω–Ω—ã—Ö
    server.on("/readings", HTTP_GET, handleReadings);
    server.on("/intervals", HTTP_GET, handleIntervals);
    server.on("/config_manager", HTTP_GET, handleConfigManager);
    server.on("/updates", HTTP_GET, handleUpdates);
    server.on("/service", HTTP_GET, handleService);
}</pre>
            </div>
        </div>
        
        <div class="footer">
            <p>¬© 2025 JXCT Development Team | <a href="../../index.html">üè† –ì–ª–∞–≤–Ω–∞—è</a> | <a href="../../html/index.html">üìö API</a></p>
        </div>
    </div>
</body>
</html> 