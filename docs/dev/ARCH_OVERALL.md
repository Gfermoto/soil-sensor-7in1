# üèõÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ JXCT (v2.7.1)

## üèóÔ∏è **–û–ë–©–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê**

### üìä **–°–∏—Å—Ç–µ–º–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   JXCT Sensor   ‚îÇ    ‚îÇ      ESP32      ‚îÇ    ‚îÇ   Web Browser   ‚îÇ
‚îÇ   (Hardware)    ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   (Controller)  ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   (Interface)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                       ‚îÇ                       ‚îÇ
        ‚îÇ Modbus RTU            ‚îÇ WiFi                  ‚îÇ HTTP/HTTPS
        ‚îÇ 9600 baud             ‚îÇ 802.11 b/g/n          ‚îÇ REST API
        ‚îÇ                       ‚îÇ                       ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Cloud MQTT    ‚îÇ    ‚îÇ   ThingSpeak    ‚îÇ    ‚îÇ   Local Storage ‚îÇ
‚îÇ   (IoT Platform)‚îÇ    ‚îÇ   (Data Log)    ‚îÇ    ‚îÇ   (NVS Flash)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### üîß **–ú–æ–¥—É–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**
```
JXCT/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ main.cpp                 # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ config.cpp               # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ modbus_sensor.cpp        # –†–∞–±–æ—Ç–∞ —Å –¥–∞—Ç—á–∏–∫–æ–º JXCT
‚îÇ   ‚îú‚îÄ‚îÄ calibration_manager.cpp  # ‚úÖ –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∏ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ mqtt_client.cpp          # MQTT –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ thingspeak_client.cpp    # ThingSpeak –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ ota_manager.cpp          # OTA –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ wifi_manager.cpp         # WiFi —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ logger.cpp               # –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ validation_utils.cpp     # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ jxct_format_utils.cpp    # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ jxct_ui_system.cpp       # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ web/                     # –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚îÇ       ‚îú‚îÄ‚îÄ routes_data.cpp      # API –¥–∞–Ω–Ω—ã—Ö
‚îÇ       ‚îú‚îÄ‚îÄ routes_config.cpp    # API –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ routes_calibration.cpp # API –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
‚îÇ       ‚îú‚îÄ‚îÄ routes_service.cpp   # –°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
‚îÇ       ‚îî‚îÄ‚îÄ error_handlers.cpp   # –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
‚îú‚îÄ‚îÄ include/                     # –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ docs/                        # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îú‚îÄ‚îÄ examples/                    # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ scripts/                     # –°–∫—Ä–∏–ø—Ç—ã —Å–±–æ—Ä–∫–∏ –∏ —Ä–µ–ª–∏–∑–∞
```

## üî¨ **–°–ò–°–¢–ï–ú–ê –ö–û–ú–ü–ï–ù–°–ê–¶–ò–ò –ò –ö–ê–õ–ò–ë–†–û–í–ö–ò**

### ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –î–í–£–•–≠–¢–ê–ü–ù–ê–Ø –ö–û–ú–ü–ï–ù–°–ê–¶–ò–Ø**

#### üìä **–ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏**
```cpp
// –§—É–Ω–∫—Ü–∏—è: applyCompensationIfEnabled()
// –§–∞–π–ª: src/modbus_sensor.cpp

void applyCompensationIfEnabled(SensorData& d, const SoilProfile& profile) {
    // –®–ê–ì 1: –ü—Ä–∏–º–µ–Ω—è–µ–º –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—É—é —Ç–∞–±–ª–∏—Ü—É CSV (–ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è –ø–æ–≤–µ—Ä–∫–∞)
    float tempCalibrated = CalibrationManager::applyCalibration(d.temperature, profile);
    float humCalibrated = CalibrationManager::applyCalibration(d.humidity, profile);
    float ecCalibrated = CalibrationManager::applyCalibration(d.ec, profile);
    float phCalibrated = CalibrationManager::applyCalibration(d.ph, profile);
    float nCalibrated = CalibrationManager::applyCalibration(d.nitrogen, profile);
    float pCalibrated = CalibrationManager::applyCalibration(d.phosphorus, profile);
    float kCalibrated = CalibrationManager::applyCalibration(d.potassium, profile);

    // –®–ê–ì 2: –ü—Ä–∏–º–µ–Ω—è–µ–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—é (—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è, –≤–ª–∞–∂–Ω–æ—Å—Ç–Ω–∞—è)
    float ec25 = ecCalibrated / (1.0f + 0.021f * (tempCalibrated - 25.0f));
    d.ec = correctEC(ec25, tempCalibrated, humCalibrated, profile.soilType);
    d.ph = correctPH(phCalibrated, tempCalibrated);
    correctNPK(tempCalibrated, humCalibrated, d.nitrogen, d.phosphorus, d.potassium, profile.soilType);
}
```

#### üîß **–ö–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä**
```cpp
// –§–∞–π–ª: src/calibration_manager.cpp

class CalibrationManager {
public:
    // ‚úÖ –ù–û–í–ê–Ø –§–£–ù–ö–¶–ò–Ø: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ CSV –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
    static float applyCalibration(float rawValue, const SoilProfile& profile) {
        if (!profile.calibrationEnabled) {
            return rawValue; // –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—ã—Ä–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –µ—Å–ª–∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–∞
        }
        
        // –õ–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É —Ç–æ—á–∫–∞–º–∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
        float coefficient = interpolateCalibration(rawValue, profile.calibrationTable);
        return rawValue * coefficient; // ‚úÖ –ö–û–†–†–ï–ö–¢–ù–ê–Ø –§–û–†–ú–£–õ–ê
    }
    
private:
    static float interpolateCalibration(float value, const CalibrationTable& table) {
        // –ü–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–∏—Ö —Ç–æ—á–µ–∫ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
        // –õ–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞
        // –í–æ–∑–≤—Ä–∞—Ç –∏–Ω—Ç–µ—Ä–ø–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞
    }
};
```

### üìä **–ù–∞—É—á–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏**

#### 1Ô∏è‚É£ **–ú–æ–¥–µ–ª—å –ê—Ä—á–∏ (1942) - EC –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è**
```cpp
// –§–∞–π–ª: src/sensor_compensation.cpp

float correctEC(float ec25, float temperature, float humidity, SoilType soilType) {
    // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –∫ 25¬∞C
    float ecTemp = ec25 / (1.0f + 0.021f * (temperature - 25.0f));
    
    // –í–ª–∞–∂–Ω–æ—Å—Ç–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ø–æ –º–æ–¥–µ–ª–∏ –ê—Ä—á–∏
    float k = getArchieCoefficient(soilType);
    float theta = humidity / 100.0f; // –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –≤–ª–∞–∂–Ω–æ—Å—Ç–∏
    float thetaSat = getSaturationMoisture(soilType);
    
    return ecTemp * pow(thetaSat / theta, k);
}

float getArchieCoefficient(SoilType soilType) {
    switch (soilType) {
        case SAND: return 0.15f;      // –ü–µ—Å–æ–∫
        case LOAM: return 0.30f;      // –°—É–≥–ª–∏–Ω–æ–∫
        case CLAY: return 0.45f;      // –ì–ª–∏–Ω–∞
        case PEAT: return 0.10f;      // –¢–æ—Ä—Ñ
        case SANDY_PEAT: return 0.18f; // –ü–µ—Å—á–∞–Ω–æ-—Ç–æ—Ä—Ñ—è–Ω–æ–π
        default: return 0.30f;
    }
}
```

#### 2Ô∏è‚É£ **–£—Ä–∞–≤–Ω–µ–Ω–∏–µ –ù–µ—Ä–Ω—Å—Ç–∞ - pH –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è**
```cpp
float correctPH(float phRaw, float temperature) {
    // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –ø–æ–ø—Ä–∞–≤–∫–∞ pH –ø–æ —É—Ä–∞–≤–Ω–µ–Ω–∏—é –ù–µ—Ä–Ω—Å—Ç–∞
    // dE/dT = -0.003 V/¬∞C –¥–ª—è pH —ç–ª–µ–∫—Ç—Ä–æ–¥–∞
    return phRaw - 0.003f * (temperature - 25.0f);
}
```

#### 3Ô∏è‚É£ **FAO 56 + Eur. J. Soil Sci. - NPK –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è**
```cpp
void correctNPK(float temperature, float humidity, 
                float& nitrogen, float& phosphorus, float& potassium, 
                SoilType soilType) {
    // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è NPK
    float tempFactor = 1.0f - 0.02f * (temperature - 25.0f);
    
    // –í–ª–∞–∂–Ω–æ—Å—Ç–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ø–æ FAO 56
    float humFactor = 1.0f + 0.05f * (humidity - 50.0f) / 50.0f;
    
    // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏
    nitrogen *= tempFactor * humFactor;
    phosphorus *= tempFactor * humFactor;
    potassium *= tempFactor * humFactor;
}
```

## üåê **–í–ï–ë-–ò–ù–¢–ï–†–§–ï–ô–°**

### üì± **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Web Browser   ‚îÇ    ‚îÇ   ESP32 Web     ‚îÇ    ‚îÇ   Data Storage  ‚îÇ
‚îÇ   (Frontend)    ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   Server        ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   (NVS/Flash)   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
        ‚îÇ                       ‚îÇ                       ‚îÇ
        ‚îÇ HTTP/HTTPS            ‚îÇ REST API              ‚îÇ JSON/CSV
        ‚îÇ HTML/CSS/JS           ‚îÇ JSON Responses        ‚îÇ Binary Data
        ‚îÇ                       ‚îÇ                       ‚îÇ
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Static Files  ‚îÇ    ‚îÇ   API Endpoints ‚îÇ    ‚îÇ   Error Handler ‚îÇ
‚îÇ   (CSS/JS/IMG)  ‚îÇ    ‚îÇ   (/api/*)      ‚îÇ    ‚îÇ   (4xx/5xx)     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### üîß **API Endpoints**
```cpp
// –§–∞–π–ª: src/web/routes_data.cpp

// GET /api/readings - –¢–µ–∫—É—â–∏–µ –ø–æ–∫–∞–∑–∞–Ω–∏—è
void handleReadings() {
    // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç JSON —Å —Ç–µ–∫—É—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –¥–∞—Ç—á–∏–∫–∞
    // –í–∫–ª—é—á–∞–µ—Ç –æ–±—ä—è—Å–Ω–µ–Ω–∏—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
}

// GET /api/data - –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
void handleData() {
    // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç CSV —Å –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
    // –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –¥–∞—Ç–∞–º
}

// POST /api/calibration - –ó–∞–≥—Ä—É–∑–∫–∞ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
void handleCalibrationUpload() {
    // –ó–∞–≥—Ä—É–∂–∞–µ—Ç CSV —Ñ–∞–π–ª –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
    // –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ñ–æ—Ä–º–∞—Ç –∏ –ø—Ä–∏–º–µ–Ω—è–µ—Ç –∫–∞–ª–∏–±—Ä–æ–≤–∫—É
}

// GET /api/calibration/example - –ü—Ä–∏–º–µ—Ä CSV —Ñ–∞–π–ª–∞
void handleCalibrationExample() {
    // –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–∏–º–µ—Ä –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
    // –î–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
}
```

### üé® **UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**
```cpp
// –§–∞–π–ª: src/jxct_ui_system.cpp

class UISystem {
public:
    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML —Å—Ç—Ä–∞–Ω–∏—Ü
    static String generateReadingsPage(const SensorData& data);
    static String generateConfigPage(const SystemConfig& config);
    static String generateOTAPage();
    
    // UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
    static String createValueCard(const String& title, float value, 
                                 const String& unit, const String& status);
    static String createCalibrationStatus(bool enabled, const String& profile);
    static String createCompensationInfo(const String& model, const String& source);
};
```

## üîÑ **–°–ò–°–¢–ï–ú–ê –û–ë–ù–û–í–õ–ï–ù–ò–ô (OTA)**

### üì¶ **OTA –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   GitHub        ‚îÇ    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ   ESP32         ‚îÇ
‚îÇ   Releases      ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   Manifest      ‚îÇ‚óÑ‚îÄ‚îÄ‚ñ∫‚îÇ   OTA Client    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ   Server        ‚îÇ    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò              ‚îÇ
                                                        ‚îÇ HTTP
                                                        ‚ñº
                                               ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                                               ‚îÇ   Firmware      ‚îÇ
                                               ‚îÇ   Storage       ‚îÇ
                                               ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### üîß **OTA –ø—Ä–æ—Ü–µ—Å—Å**
```cpp
// –§–∞–π–ª: src/ota_manager.cpp

class OTAManager {
public:
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
    bool checkForUpdates() {
        // 1. –ó–∞–≥—Ä—É–∑–∫–∞ manifest.json
        // 2. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π
        // 3. –í–æ–∑–≤—Ä–∞—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
    }
    
    // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    bool installUpdate(const String& url, const String& sha256) {
        // 1. –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–æ—à–∏–≤–∫–∏
        // 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ SHA256
        // 3. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
        // 4. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–∏—Å—Ç–µ–º—ã
    }
};
```

## üìä **–•–†–ê–ù–ï–ù–ò–ï –î–ê–ù–ù–´–•**

### üíæ **NVS (Non-Volatile Storage)**
```cpp
// –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ NVS
struct NVSData {
    // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
    char wifi_ssid[32];
    char wifi_password[64];
    char mqtt_server[64];
    int mqtt_port;
    
    // –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞
    bool calibration_enabled;
    CalibrationTable calibration_table;
    SoilType soil_type;
    
    // OTA
    char manifest_url[256];
    unsigned long last_check_ts;
    bool auto_update_enabled;
};
```

### üìà **–ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ**
```cpp
// –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö
struct DataRecord {
    unsigned long timestamp;  // Unix timestamp
    float temperature;        // ¬∞C
    float humidity;          // %
    float ec;               // ¬µS/cm
    float ph;               // pH
    float nitrogen;         // –º–≥/–∫–≥
    float phosphorus;       // –º–≥/–∫–≥
    float potassium;        // –º–≥/–∫–≥
    bool compensation_applied; // –§–ª–∞–≥ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏
};
```

## üîå **–ò–ù–¢–ï–ì–†–ê–¶–ò–ò**

### üåê **MQTT –∫–ª–∏–µ–Ω—Ç**
```cpp
// –§–∞–π–ª: src/mqtt_client.cpp

class MQTTClient {
public:
    // –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ MQTT —Å–µ—Ä–≤–µ—Ä—É
    bool connect(const String& server, int port, 
                 const String& username, const String& password);
    
    // –ü—É–±–ª–∏–∫–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
    bool publishData(const SensorData& data);
    
    // –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ –∫–æ–º–∞–Ω–¥—ã
    void subscribeToCommands();
    
private:
    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
    void handleMessage(const String& topic, const String& payload);
};
```

### ‚òÅÔ∏è **ThingSpeak –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**
```cpp
// –§–∞–π–ª: src/thingspeak_client.cpp

class ThingSpeakClient {
public:
    // –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ ThingSpeak
    bool sendData(const SensorData& data);
    
    // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ ThingSpeak
    SensorData getData();
    
private:
    // HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ ThingSpeak API
    bool makeRequest(const String& endpoint, const String& data);
};
```

## üîç **–õ–û–ì–ò–†–û–í–ê–ù–ò–ï –ò –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê**

### üìù **–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è**
```cpp
// –§–∞–π–ª: src/logger.cpp

class Logger {
public:
    // –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
    enum Level { DEBUG, INFO, WARNING, ERROR, CRITICAL };
    
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —É—Ä–æ–≤–Ω–µ–º
    static void log(Level level, const String& message);
    
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–∞—Ç—á–∏–∫–∞
    static void logSensorData(const SensorData& data);
    
    // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
    static void logError(const String& error, const String& context);
    
private:
    // –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
    static String formatTimestamp();
    
    // –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏)
    static String getColorCode(Level level);
};
```

### üîß **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
```cpp
// –§–∞–π–ª: src/validation_utils.cpp

class ValidationUtils {
public:
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–∞—Ç—á–∏–∫–∞
    static bool validateSensorData(const SensorData& data);
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    static bool validateConfig(const SystemConfig& config);
    
    // –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã
    static bool validateCalibrationTable(const CalibrationTable& table);
    
private:
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –∑–Ω–∞—á–µ–Ω–∏–π
    static bool isInRange(float value, float min, float max);
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ CSV
    static bool isValidCSV(const String& csvData);
};
```

## üöÄ **–ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨ –ò –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø**

### üìä **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏**
- **RAM:** ~57KB (17.4% –æ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–π)
- **Flash:** ~1184KB (60.2% –æ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ–π)
- **NVS:** ~4KB –¥–ª—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **Heap:** –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### ‚ö° **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏**
- **–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—É—Ñ–µ—Ä—ã:** –î–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **–ü—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π:** –î–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- **–°–∂–∞—Ç–∏–µ:** JSON –æ—Ç–≤–µ—Ç–æ–≤

### üîÑ **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –∑–∞–¥–∞—á**
```cpp
// –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –∑–∞–¥–∞—á
void loop() {
    // 1. –ß—Ç–µ–Ω–∏–µ –¥–∞—Ç—á–∏–∫–∞ (–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥)
    if (millis() - lastSensorRead > SENSOR_READ_INTERVAL) {
        readSensorData();
        lastSensorRead = millis();
    }
    
    // 2. –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö (–∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç)
    if (millis() - lastDataSend > DATA_SEND_INTERVAL) {
        sendDataToCloud();
        lastDataSend = millis();
    }
    
    // 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ OTA (–∫–∞–∂–¥—ã–π —á–∞—Å)
    if (millis() - lastOtaCheck > OTA_CHECK_INTERVAL) {
        checkForUpdates();
        lastOtaCheck = millis();
    }
    
    // 4. –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ–±-–∑–∞–ø—Ä–æ—Å–æ–≤
    webServer.handleClient();
    
    // 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ MQTT
    mqttClient.loop();
}
```

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏:** 3.4.6  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2025-06-24  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ê–∫—Ç—É–∞–ª—å–Ω–æ 