# –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –¥–∞—Ç—á–∏–∫–∞ JXCT 7-–≤-1

## üéØ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

–î–∞–Ω–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—é —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ESP32-–ø—Ä–æ–µ–∫—Ç–∞ –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –ø–æ–∫–∞–∑–∞–Ω–∏–π –¥–∞—Ç—á–∏–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É—Å–ª–æ–≤–∏–π –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏—è.

> ‚ö° **–í–∞–∂–Ω–æ**: –î–æ–∫—É–º–µ–Ω—Ç —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –Ω–∞ **–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –ø–æ–∫–∞–∑–∞–Ω–∏–π**. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è, –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–µ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç—Å—è, –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ.

## üéõÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

### **1. –û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å—Ä–µ–¥—ã (–∑–∞–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)**

```html
<div class='section'>
  <h2>üåø –ü—Ä–æ—Ñ–∏–ª—å –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏—è</h2>
  
  <div class='form-group'>
    <label>–¢–∏–ø —Å—Ä–µ–¥—ã –≤—ã—Ä–∞—â–∏–≤–∞–Ω–∏—è:</label>
    <input type='radio' name='environment' value='0' id='greenhouse'> 
    <label for='greenhouse'>üè† –¢–µ–ø–ª–∏—Ü–∞</label>
    <input type='radio' name='environment' value='1' id='field'> 
    <label for='field'>üåæ –û—Ç–∫—Ä—ã—Ç—ã–π –≥—Ä—É–Ω—Ç</label>
  </div>
  
  <div class='form-group'>
    <label for='soil_type'>–¢–∏–ø –ø–æ—á–≤—ã:</label>
    <select name='soil_type' id='soil_type'>
      <option value='0'>üèñÔ∏è –ü–µ—Å—á–∞–Ω–∞—è (–ö–û–ï < 5 –º—ç–∫–≤/100–≥)</option>
      <option value='1'>üß± –ì–ª–∏–Ω–∏—Å—Ç–∞—è (–ö–û–ï > 25 –º—ç–∫–≤/100–≥)</option>
      <option value='2'>üåø –¢–æ—Ä—Ñ—è–Ω–∞—è (–æ—Ä–≥–∞–Ω–∏–∫–∞ > 80%)</option>
    </select>
  </div>
  
  <div class='form-group'>
    <label for='latitude'>–ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</label>
    <input type='number' name='latitude' step='0.000001' min='-90' max='90' 
           value='55.7558' placeholder='–®–∏—Ä–æ—Ç–∞'>
    <input type='number' name='longitude' step='0.000001' min='-180' max='180' 
           value='37.6176' placeholder='–î–æ–ª–≥–æ—Ç–∞'>
    <small>–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–µ–∑–æ–Ω–æ–≤</small>
  </div>
  
  <div class='form-group'>
    <label for='timezone'>–ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å:</label>
    <select name='timezone' id='timezone'>
      <option value='-12'>UTC-12 (–ë–µ–π–∫–µ—Ä)</option>
      <option value='-11'>UTC-11 (–°–∞–º–æ–∞)</option>
      <!-- ... –¥—Ä—É–≥–∏–µ –ø–æ—è—Å–∞ -->
      <option value='3' selected>UTC+3 (–ú–æ—Å–∫–≤–∞)</option>
      <option value='7'>UTC+7 (–ù–æ–≤–æ—Å–∏–±–∏—Ä—Å–∫)</option>
      <option value='12'>UTC+12 (–ö–∞–º—á–∞—Ç–∫–∞)</option>
    </select>
  </div>
  
  <div class='form-group'>
    <label for='weather_api'>–ö–ª—é—á OpenWeatherMap API:</label>
    <input type='text' name='weather_api' maxlength='32' 
           placeholder='–í–∞—à API –∫–ª—é—á –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –æ—Å–∞–¥–∫–æ–≤'>
    <small>
      <a href='https://openweathermap.org/api' target='_blank'>–ü–æ–ª—É—á–∏—Ç—å –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∫–ª—é—á</a>
      (1000 –∑–∞–ø—Ä–æ—Å–æ–≤/–¥–µ–Ω—å)
    </small>
  </div>
</div>

<div class='section'>
  <h2>‚öôÔ∏è –†–µ–∂–∏–º –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏</h2>
  
  <div class='form-group'>
    <label>–¢–∏–ø –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏:</label>
    <input type='radio' name='calibration_mode' value='0' id='auto_cal' checked> 
    <label for='auto_cal'>ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)</label>
    <input type='radio' name='calibration_mode' value='1' id='manual_cal'> 
    <label for='manual_cal'>‚úã –†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞</label>
  </div>
  
  <div id='manual_coefficients' style='display:none'>
    <h3>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã</h3>
    <div class='coeff-grid'>
      <label>EC —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è:</label>
      <input type='number' name='k_temp_ec' step='0.001' value='0.019'>
      
      <label>N —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è:</label>
      <input type='number' name='k_temp_n' step='0.0001' value='0.0025'>
      
      <label>P —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è:</label>
      <input type='number' name='k_temp_p' step='0.0001' value='0.003'>
      
      <label>K —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è:</label>
      <input type='number' name='k_temp_k' step='0.0001' value='0.0018'>
    </div>
  </div>
</div>
```

## ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã

### **1. –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∏ —Å–µ–∑–æ–Ω–∞ (NTP)**

```cpp
// –§—É–Ω–∫—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–µ–∑–æ–Ω–∞ –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º –∏ –¥–∞—Ç–µ
String getCurrentSeason(float latitude, int month) {
    bool northernHemisphere = (latitude >= 0);
    
    if (northernHemisphere) {
        if (month >= 3 && month <= 5) return "–í–µ—Å–Ω–∞";
        if (month >= 6 && month <= 8) return "–õ–µ—Ç–æ"; 
        if (month >= 9 && month <= 11) return "–û—Å–µ–Ω—å";
        return "–ó–∏–º–∞";
    } else {
        // –Æ–∂–Ω–æ–µ –ø–æ–ª—É—à–∞—Ä–∏–µ - —Å–µ–∑–æ–Ω—ã —Å–º–µ—â–µ–Ω—ã –Ω–∞ 6 –º–µ—Å—è—Ü–µ–≤
        if (month >= 3 && month <= 5) return "–û—Å–µ–Ω—å";
        if (month >= 6 && month <= 8) return "–ó–∏–º–∞"; 
        if (month >= 9 && month <= 11) return "–í–µ—Å–Ω–∞";
        return "–õ–µ—Ç–æ";
    }
}

// API endpoint –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–∏—Ö —É—Å–ª–æ–≤–∏–π
void handleCalibrationStatus() {
    StaticJsonDocument<512> doc;
    
    time_t now = time(nullptr);
    struct tm *timeinfo = localtime(&now);
    
    int currentHour = timeinfo->tm_hour;
    int currentMonth = timeinfo->tm_mon + 1;
    
    doc["current_time"] = String(currentHour) + ":00";
    doc["current_month"] = currentMonth;
    doc["current_season"] = getCurrentSeason(config.calibration.latitude, currentMonth);
    
    // –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–º–µ—Ä–æ–≤
    bool isOptimalTime = false;
    String recommendation = "";
    
    if (config.calibration.growingEnvironment == 0) { // –¢–µ–ø–ª–∏—Ü–∞
        isOptimalTime = (currentHour == 7); // 7:00 —É—Ç—Ä–∞
        recommendation = isOptimalTime ? 
            "‚úÖ –û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –∑–∞–º–µ—Ä–æ–≤ –≤ —Ç–µ–ø–ª–∏—Ü–µ" :
            "‚è∞ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–º–µ—Ä –≤ 7:00 (—Å—Ç–∞–±–∏–ª—å–Ω—ã–µ T/Œ∏)";
    } else { // –û—Ç–∫—Ä—ã—Ç—ã–π –≥—Ä—É–Ω—Ç
        isOptimalTime = (currentHour >= 9 && currentHour <= 16);
        recommendation = isOptimalTime ? 
            "‚úÖ –ü–æ–¥—Ö–æ–¥—è—â–µ–µ –≤—Ä–µ–º—è –¥–ª—è –∑–∞–º–µ—Ä–æ–≤" :
            "‚è∞ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∑–∞–º–µ—Ä —Å 9:00 –¥–æ 16:00";
    }
    
    doc["optimal_time"] = isOptimalTime;
    doc["recommendation"] = recommendation;
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≥–æ–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
    if (strlen(config.calibration.weatherApiKey) > 0) {
        bool recentRain = checkRecentRainfall();
        doc["recent_rainfall"] = recentRain;
        
        if (recentRain && config.calibration.growingEnvironment == 1) {
            doc["measurement_blocked"] = true;
            doc["rain_warning"] = "‚ö†Ô∏è –ó–∞–º–µ—Ä—ã –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã: –¥–æ–∂–¥—å –º–µ–Ω–µ–µ 12 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥";
        }
    }
    
    String response;
    serializeJson(doc, response);
    webServer.send(200, "application/json", response);
}
```

### **2. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenWeatherMap API**

```cpp
#include <HTTPClient.h>
#include <ArduinoJson.h>

// –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
struct WeatherData {
    bool hasRain;
    float precipitation;  // –º–º –æ—Å–∞–¥–∫–æ–≤ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 —á–∞—Å–∞
    unsigned long lastUpdate;
    bool dataValid;
};

WeatherData weatherData = {false, 0.0, 0, false};

// –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –æ –ø–æ–≥–æ–¥–µ
bool updateWeatherData() {
    if (strlen(config.calibration.weatherApiKey) == 0) {
        return false;
    }
    
    HTTPClient http;
    String url = "http://api.openweathermap.org/data/2.5/weather?lat=" + 
                String(config.calibration.latitude, 6) + 
                "&lon=" + String(config.calibration.longitude, 6) + 
                "&appid=" + String(config.calibration.weatherApiKey) + 
                "&units=metric";
    
    http.begin(url);
    int httpCode = http.GET();
    
    if (httpCode == HTTP_CODE_OK) {
        String payload = http.getString();
        StaticJsonDocument<1024> doc;
        
        if (deserializeJson(doc, payload) == DeserializationError::Ok) {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –¥–æ–∂–¥—è
            if (doc["weather"][0]["main"] == "Rain") {
                weatherData.hasRain = true;
                if (doc["rain"]["3h"].is<float>()) {
                    weatherData.precipitation = doc["rain"]["3h"];
                }
            } else {
                weatherData.hasRain = false;
                weatherData.precipitation = 0.0;
            }
            
            weatherData.lastUpdate = millis();
            weatherData.dataValid = true;
            
            logSuccess("–ü–æ–≥–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω—ã: –¥–æ–∂–¥—å=%s, –æ—Å–∞–¥–∫–∏=%.1f–º–º", 
                      weatherData.hasRain ? "–¥–∞" : "–Ω–µ—Ç", 
                      weatherData.precipitation);
            return true;
        }
    }
    
    http.end();
    logError("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: –∫–æ–¥ %d", httpCode);
    return false;
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ–¥–∞–≤–Ω–∏—Ö –æ—Å–∞–¥–∫–æ–≤ (–¥–ª—è –æ—Ç–∫—Ä—ã—Ç–æ–≥–æ –≥—Ä—É–Ω—Ç–∞)
bool checkRecentRainfall() {
    // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –∫–∞–∂–¥—ã–µ 30 –º–∏–Ω—É—Ç
    if (millis() - weatherData.lastUpdate > 1800000) { // 30 –º–∏–Ω
        updateWeatherData();
    }
    
    return weatherData.dataValid && weatherData.hasRain;
}
```

## üìä –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### **–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ `jxct_config_vars.h`:**

```cpp
struct __attribute__((packed)) CalibrationSettings {
    // –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (12 –±–∞–π—Ç)
    uint8_t growingEnvironment;    // 0=—Ç–µ–ø–ª–∏—Ü–∞, 1=–æ—Ç–∫—Ä—ã—Ç—ã–π –≥—Ä—É–Ω—Ç
    uint8_t soilType;             // 0=–ø–µ—Å–æ–∫, 1=–≥–ª–∏–Ω–∞, 2=—Ç–æ—Ä—Ñ  
    uint8_t calibrationMode;      // 0=–∞–≤—Ç–æ, 1=—Ä—É—á–Ω–∞—è
    uint8_t weatherEnabled;       // 0=–æ—Ç–∫–ª—é—á–µ–Ω–æ, 1=–≤–∫–ª—é—á–µ–Ω–æ
    int8_t timezone;              // –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å (-12 –¥–æ +12)
    uint8_t reserved[3];          // –†–µ–∑–µ—Ä–≤ –¥–ª—è –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏—è
    
    // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã (8 –±–∞–π—Ç)
    float latitude;               // –®–∏—Ä–æ—Ç–∞ (-90 –¥–æ +90)
    float longitude;              // –î–æ–ª–≥–æ—Ç–∞ (-180 –¥–æ +180)
    
    // API –∫–ª—é—á–∏ (32 –±–∞–π—Ç–∞)
    char weatherApiKey[32];       // –ö–ª—é—á OpenWeatherMap API
    
    // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (16 –±–∞–π—Ç) - —Ç–æ–ª—å–∫–æ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
    float kTempEC;                // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è EC
    float kTempN;                 // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è N
    float kTempP;                 // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è P  
    float kTempK;                 // –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è K
    
} calibration;

// –î–æ–±–∞–≤–ª—è–µ–º –≤ –æ—Å–Ω–æ–≤–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É Config:
struct __attribute__((packed)) Config {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è ...
    
    // v2.4.0: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ (68 –±–∞–π—Ç)
    CalibrationSettings calibration;
    
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–æ–ª—è ...
};
```

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –≤–µ–±-—Å–µ—Ä–≤–µ—Ä

### **1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏—é (`wifi_manager.cpp`):**

```cpp
String navHtml()
{
    String html = "<div class='nav'>";
    html += "<a href='/'>" UI_ICON_CONFIG " –ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>";
    if (currentWiFiMode == WiFiMode::STA)
    {
        html += "<a href='/readings'>" UI_ICON_DATA " –ü–æ–∫–∞–∑–∞–Ω–∏—è</a>";
        html += "<a href='/calibration'>" UI_ICON_CALIBRATION " –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞</a>";  // –ù–û–í–û–ï
        html += "<a href='/intervals'>" UI_ICON_INTERVALS " –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã</a>";
        html += "<a href='/config_manager'>" UI_ICON_FOLDER " –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è</a>";
        html += "<a href='/service'>" UI_ICON_SERVICE " –°–µ—Ä–≤–∏—Å</a>";
    }
    html += "</div>";
    return html;
}
```

### **2. –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü:**

```cpp
void setupWebServer() {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ ...
    
    // –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
    webServer.on("/calibration", HTTP_GET, handleCalibration);
    webServer.on("/calibration", HTTP_POST, handleCalibrationSave);
    
    // API –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
    webServer.on("/api/calibration/status", HTTP_GET, handleCalibrationStatus);
    
    // API –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
    webServer.on("/api/calibration/test", HTTP_POST, handleCalibrationTest);
    
    // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ ...
}

// –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
void handleCalibration() {
    if (!checkWebAuth()) return;
    
    String html = buildCalibrationPage();
    webServer.send(200, "text/html; charset=utf-8", html);
}

// –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ HTML —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏
String buildCalibrationPage() {
    String html = "<!DOCTYPE html><html><head>";
    html += "<meta charset='UTF-8'>";
    html += "<meta name='viewport' content='width=device-width, initial-scale=1.0'>";
    html += "<title>üîß –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –¥–∞—Ç—á–∏–∫–∞ JXCT</title>";
    html += "<style>" + String(getUnifiedCSS()) + "</style>";
    html += "</head><body><div class='container'>";
    
    html += navHtml();
    html += "<h1>üîß –ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –¥–∞—Ç—á–∏–∫–∞</h1>";
    
    // –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å
    html += "<div class='section' id='current_status'>";
    html += "<h2>üìä –¢–µ–∫—É—â–∏–µ —É—Å–ª–æ–≤–∏—è</h2>";
    html += "<div class='status-loading'>–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...</div>";
    html += "</div>";
    
    // –§–æ—Ä–º–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫
    html += "<form action='/calibration' method='post'>";
    html += buildCalibrationForm();
    html += "<button type='submit' class='btn-primary'>üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>";
    html += "</form>";
    
    // JavaScript –¥–ª—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
    html += "<script>";
    html += "function updateStatus() {";
    html += "  fetch('/api/calibration/status')";
    html += "    .then(r => r.json())";
    html += "    .then(data => {";
    html += "      const status = document.getElementById('current_status');";
    html += "      status.innerHTML = `";
    html += "        <h2>üìä –¢–µ–∫—É—â–∏–µ —É—Å–ª–æ–≤–∏—è</h2>";
    html += "        <div class='status-grid'>";
    html += "          <div>–°–µ–∑–æ–Ω: <span class='badge'>${data.current_season}</span></div>";
    html += "          <div>–í—Ä–µ–º—è: <span class='badge'>${data.current_time}</span></div>";
    html += "          <div>–°—Ç–∞—Ç—É—Å: <span class='${data.optimal_time ? 'badge-success' : 'badge-warning'}'>";
    html += "            ${data.optimal_time ? '–û–ø—Ç–∏–º–∞–ª—å–Ω–æ' : '–ù–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ'}</span></div>";
    html += "        </div>";
    html += "        <div class='recommendation'>${data.recommendation}</div>";
    html += "        ${data.rain_warning ? `<div class='alert-warning'>${data.rain_warning}</div>` : ''}`;";
    html += "    });";
    html += "}";
    html += "updateStatus(); setInterval(updateStatus, 30000);"; // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫
    html += "</script>";
    
    html += "</div></body></html>";
    return html;
}
```

## üîÑ –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏

### **–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏:**

```cpp
#include "calibration_algorithms.h"

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ –∫ –ø–æ–∫–∞–∑–∞–Ω–∏—è–º –¥–∞—Ç—á–∏–∫–∞
SensorData applyMathematicalCompensation(SensorData rawData) {
    if (config.calibration.calibrationMode == 0) {
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Ñ–∏–ª—é —Å—Ä–µ–¥—ã
        return applyAutomaticCompensation(rawData);
    } else {
        // –†—É—á–Ω–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º–∏
        return applyManualCompensation(rawData);
    }
}

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø—Ä–æ—Ñ–∏–ª—è
SensorData applyAutomaticCompensation(SensorData raw) {
    SensorData compensated = raw;
    
    // –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â–∏–µ —É—Å–ª–æ–≤–∏—è
    time_t now = time(nullptr);
    struct tm *timeinfo = localtime(&now);
    int month = timeinfo->tm_mon + 1;
    
    // –í—ã–±–∏—Ä–∞–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏
    if (config.calibration.growingEnvironment == 0) {
        // –¢–µ–ø–ª–∏—Ü–∞ - –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ê
        compensated = applyGreenhouseCompensation(raw, month);
    } else {
        // –û—Ç–∫—Ä—ã—Ç—ã–π –≥—Ä—É–Ω—Ç - –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Ñ–∏–ª—å –ë
        compensated = applyFieldCompensation(raw, month, config.calibration.soilType);
    }
    
    return compensated;
}

// –ö–æ—Ä—Ä–µ–∫—Ü–∏—è –¥–ª—è —Ç–µ–ø–ª–∏—Ü (–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ SENSOR_COMPENSATION.md)
SensorData applyGreenhouseCorrection(SensorData raw, int month) {
    SensorData corrected = raw;
    
    // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –¥–ª—è —Ç–µ–ø–ª–∏—Ü
    const float K_TEMP_EC = 0.021;
    const float K_TEMP_N = 0.0028;
    const float K_TEMP_P = 0.0032;
    const float K_TEMP_K = 0.002;
    const float K_HUMIDITY_PH = 0.025;
    const float K_EC_N = 0.00025;
    const float K_EC_P = 0.00025;
    const float K_EC_K = 0.00012;
    
    // 1. –¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ
    float T_limited = min(raw.temperature, 45.0f);
    
    // 2. –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—É—â—É—é –≤–ª–∞–∂–Ω–æ—Å—Ç—å
    float theta_current = raw.humidity;
    
    // 3. –ö–æ—Ä—Ä–µ–∫—Ü–∏—è EC
    float EC_temp = raw.ec / (1 + K_TEMP_EC * (T_limited - 25));
    corrected.ec = (theta_current > 20) ? EC_temp * (45.0f / theta_current) : EC_temp;
    
    // 4. –ö–æ—Ä—Ä–µ–∫—Ü–∏—è pH
    float pH_temp = raw.ph - 0.003f * (T_limited - 25);
    corrected.ph = pH_temp + K_HUMIDITY_PH * (50 - theta_current);
    
    // 5. –ö–æ—Ä—Ä–µ–∫—Ü–∏—è NPK
    float N_temp = raw.nitrogen * (1 - K_TEMP_N * (T_limited - 25));
    float N_theta = N_temp / (1 + 0.018f * (theta_current - 45));
    float N_ec = N_theta * (1 - K_EC_N * corrected.ec);
    corrected.nitrogen = N_ec * (corrected.ph < 6.0f ? 1.1f : 1.0f);
    
    // –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è P –∏ K...
    
    // 6. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è –∑–∞—Å–æ–ª–µ–Ω–∏—è
    if (corrected.ec > 3000) {
        corrected.potassium *= 0.85f;
    }
    
    return corrected;
}
```

## üì± CSS —Å—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã

```css
/* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏ –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ */
.status-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin: 15px 0;
}

.status-grid > div {
    background: #f8f9fa;
    padding: 10px;
    border-radius: 5px;
    border-left: 4px solid #007bff;
}

.badge {
    background: #007bff;
    color: white;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: bold;
}

.badge-success {
    background: #28a745;
    color: white;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 12px;
}

.badge-warning {
    background: #ffc107;
    color: #212529;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 12px;
}

.recommendation {
    background: #e3f2fd;
    border: 1px solid #2196f3;
    border-radius: 5px;
    padding: 10px;
    margin: 10px 0;
    font-weight: 500;
}

.alert-warning {
    background: #fff3cd;
    border: 1px solid #ffeaa7;
    color: #856404;
    padding: 10px;
    border-radius: 5px;
    margin: 10px 0;
}

.coeff-grid {
    display: grid;
    grid-template-columns: 1fr auto;
    gap: 10px;
    align-items: center;
}

.btn-primary {
    background: #007bff;
    color: white;
    border: none;
    padding: 12px 24px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 16px;
    font-weight: 500;
}

.btn-primary:hover {
    background: #0056b3;
}
```

## üöÄ –ü–ª–∞–Ω –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

### **–≠—Ç–∞–ø 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (1-2 –¥–Ω—è)**
1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä—É `Config`
2. –û–±–Ω–æ–≤–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ `loadConfig()` / `saveConfig()`
3. –î–æ–±–∞–≤–∏—Ç—å –∏–∫–æ–Ω–∫—É –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –≤ UI –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

### **–≠—Ç–∞–ø 2: –ë–∞–∑–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (2-3 –¥–Ω—è)**
1. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É `/calibration` —Å —Ñ–æ—Ä–º–æ–π –Ω–∞—Å—Ç—Ä–æ–µ–∫
2. –î–æ–±–∞–≤–∏—Ç—å API endpoint `/api/calibration/status`
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ –Ω–∞–≤–∏–≥–∞—Ü–∏–æ–Ω–Ω–æ–µ –º–µ–Ω—é

### **–≠—Ç–∞–ø 3: –õ–æ–≥–∏–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ (3-4 –¥–Ω—è)**
1. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
2. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ä—É—á–Ω—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Ü–∏–∫–ª–æ–º —á—Ç–µ–Ω–∏—è –¥–∞—Ç—á–∏–∫–∞

### **–≠—Ç–∞–ø 4: –ü–æ–≥–æ–¥–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (2-3 –¥–Ω—è)**
1. –î–æ–±–∞–≤–∏—Ç—å HTTP-–∫–ª–∏–µ–Ω—Ç –¥–ª—è OpenWeatherMap
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–≥–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∑–∞–º–µ—Ä–æ–≤ –ø–æ—Å–ª–µ –¥–æ–∂–¥—è

### **–≠—Ç–∞–ø 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (1-2 –¥–Ω—è)**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º—ã –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫—É –Ω–∞—Å—Ç—Ä–æ–µ–∫
3. –í–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ—á–Ω–æ—Å—Ç–∏ –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–∏ —Å —ç—Ç–∞–ª–æ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

**–û–±—â–µ–µ –≤—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è: 8-12 –¥–Ω–µ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [OpenWeatherMap API Documentation](https://openweathermap.org/api)
- [ESP32 HTTP Client Library](https://github.com/espressif/arduino-esp32/tree/master/libraries/HTTPClient)
- [ArduinoJson Library](https://arduinojson.org/)
- [NTP Time Synchronization](https://github.com/arduino-libraries/NTPClient)

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –ø—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–ü–∞–º—è—Ç—å ESP32**: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–ª–∏–±—Ä–æ–≤–æ—á–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–ª–∏—á–∏—Ç —Ä–∞–∑–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –Ω–∞ ~68 –±–∞–π—Ç
2. **HTTP –∑–∞–ø—Ä–æ—Å—ã**: –ü–æ–≥–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —É–≤–µ–ª–∏—á–∞—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ WiFi, —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 30 –º–∏–Ω—É—Ç
3. **–¢–æ—á–Ω–æ—Å—Ç—å –≤—Ä–µ–º–µ–Ω–∏**: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è NTP –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–µ–∑–æ–Ω–æ–≤
4. **–ß–∏—Å—Ç–∞—è –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏—è**: –î–æ–∫—É–º–µ–Ω—Ç —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∫–æ—Ä—Ä–µ–∫—Ü–∏–∏ –ø–æ–∫–∞–∑–∞–Ω–∏–π –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω –¥–ª—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∫–∞–ª–∏–±—Ä–æ–≤–∫–∏ –¥–∞—Ç—á–∏–∫–∞ JXCT 7-–≤-1* 