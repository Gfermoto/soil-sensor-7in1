# JXCT Scripts

–°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ —Ä–µ–ª–∏–∑–æ–≤ JXCT Soil Sensor.

## üöÄ Release Manager

**–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–∫—Ä–∏–ø—Ç** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏—è–º–∏ –∏ —Ä–µ–ª–∏–∑–∞–º–∏: `release_manager.py`

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ Python –∏ Git —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
python --version
git --version
```

### –ö–æ–º–∞–Ω–¥—ã

#### 1. `version` - –ü–æ–¥–Ω—è—Ç—å –≤–µ—Ä—Å–∏—é –±–µ–∑ —Ä–µ–ª–∏–∑–∞
```powershell
# –£–≤–µ–ª–∏—á–∏—Ç—å patch –≤–µ—Ä—Å–∏—é (3.6.2 -> 3.6.3)
.\scripts\release.ps1 version -Type patch

# –£–≤–µ–ª–∏—á–∏—Ç—å minor –≤–µ—Ä—Å–∏—é (3.6.2 -> 3.7.0)
.\scripts\release.ps1 version -Type minor

# –£–≤–µ–ª–∏—á–∏—Ç—å major –≤–µ—Ä—Å–∏—é (3.6.2 -> 4.0.0)
.\scripts\release.ps1 version -Type major

# –¢–æ–ª—å–∫–æ –æ–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª—ã, –±–µ–∑ –∫–æ–º–º–∏—Ç–∞
.\scripts\release.ps1 version -Type patch -NoCommit

# –û–±–Ω–æ–≤–∏—Ç—å —Ñ–∞–π–ª—ã –∏ –∑–∞–∫–æ–º–º–∏—Ç–∏—Ç—å, –Ω–æ –Ω–µ –ø—É—à–∏—Ç—å
.\scripts\release.ps1 version -Type patch -NoPush
```

#### 2. `release` - –°–æ–∑–¥–∞—Ç—å —Ä–µ–ª–∏–∑ —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –≤–µ—Ä—Å–∏–µ–π
```powershell
# –°–æ–∑–¥–∞—Ç—å —Ä–µ–ª–∏–∑ 3.6.3
.\scripts\release.ps1 release -Version "3.6.3" -Message "–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏"

# –°–æ–∑–¥–∞—Ç—å —Ä–µ–ª–∏–∑ –±–µ–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—É—à–∞
.\scripts\release.ps1 release -Version "3.6.3" -NoPush
```

#### 3. `bump` - –£–≤–µ–ª–∏—á–∏—Ç—å –≤–µ—Ä—Å–∏—é –∏ —Å–æ–∑–¥–∞—Ç—å —Ä–µ–ª–∏–∑
```powershell
# –£–≤–µ–ª–∏—á–∏—Ç—å patch –∏ —Å–æ–∑–¥–∞—Ç—å —Ä–µ–ª–∏–∑ (3.6.2 -> 3.6.3)
.\scripts\release.ps1 bump -Type patch

# –£–≤–µ–ª–∏—á–∏—Ç—å minor –∏ —Å–æ–∑–¥–∞—Ç—å —Ä–µ–ª–∏–∑ (3.6.2 -> 3.7.0)
.\scripts\release.ps1 bump -Type minor
```

#### 4. `sync` - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏–∏ –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏
```powershell
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏–∏
.\scripts\release.ps1 sync
```

### Python –Ω–∞–ø—Ä—è–º—É—é

```bash
# –ü–æ–¥–Ω—è—Ç—å –≤–µ—Ä—Å–∏—é
python scripts/release_manager.py version --type patch

# –°–æ–∑–¥–∞—Ç—å —Ä–µ–ª–∏–∑
python scripts/release_manager.py release --version "3.6.3"

# –£–≤–µ–ª–∏—á–∏—Ç—å –≤–µ—Ä—Å–∏—é –∏ —Å–æ–∑–¥–∞—Ç—å —Ä–µ–ª–∏–∑
python scripts/release_manager.py bump --type minor

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Ä—Å–∏–∏
python scripts/release_manager.py sync
```

### –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥–∞—è –∫–æ–º–∞–Ω–¥–∞

| –ö–æ–º–∞–Ω–¥–∞ | –î–µ–π—Å—Ç–≤–∏–µ | Git —Ç–µ–≥ | –ü—É—à |
|---------|----------|---------|-----|
| `version` | –û–±–Ω–æ–≤–ª—è–µ—Ç —Ñ–∞–π–ª—ã –≤–µ—Ä—Å–∏–∏ | ‚ùå | –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ |
| `release` | –°–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω—ã–π —Ä–µ–ª–∏–∑ | ‚úÖ | –î–∞ |
| `bump` | –£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –≤–µ—Ä—Å–∏—é + —Ä–µ–ª–∏–∑ | ‚úÖ | –î–∞ |
| `sync` | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã | ‚ùå | ‚ùå |

### –§–∞–π–ª—ã –≤–µ—Ä—Å–∏–π

- **`VERSION`** - –æ—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª –≤–µ—Ä—Å–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "3.6.2")
- **`include/version.h`** - C++ –∑–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª —Å –º–∞–∫—Ä–æ—Å–∞–º–∏
- **`platformio.ini`** - –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å –≤–µ—Ä—Å–∏–µ–π –∏ –¥–∞—Ç–æ–π –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### GitHub Actions

–ü—Ä–∏ –ø—É—à–µ —Ç–µ–≥–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è workflow, –∫–æ—Ç–æ—Ä—ã–π:

1. ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç –≤–µ—Ä—Å–∏–∏ –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –≤–µ—Ä—Å–∏–π
3. ‚úÖ –°–æ–±–∏—Ä–∞–µ—Ç –ø—Ä–æ—à–∏–≤–∫—É –¥–ª—è production
4. ‚úÖ –°–æ–∑–¥–∞–µ—Ç GitHub Release —Å —Ñ–∞–π–ª–∞–º–∏:
   - `firmware.bin` - –ø—Ä–æ—à–∏–≤–∫–∞ –¥–ª—è ESP32
   - `manifest.json` - –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—à–∏–≤–∫–∏

### –¢–∏–ø–∏—á–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

#### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (–ø–æ–¥–Ω—è—Ç—å –≤–µ—Ä—Å–∏—é –±–µ–∑ —Ä–µ–ª–∏–∑–∞)
```powershell
# –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
.\scripts\release.ps1 version -Type minor -Message "–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –∫—É–ª—å—Ç—É—Ä—ã"
```

#### –†–µ–ª–∏–∑ (—Å–æ–∑–¥–∞—Ç—å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π —Ä–µ–ª–∏–∑)
```powershell
# –ö–æ–≥–¥–∞ –≥–æ—Ç–æ–≤—ã –∫ —Ä–µ–ª–∏–∑—É
.\scripts\release.ps1 release -Version "3.6.3" -Message "–†–µ–ª–∏–∑ —Å –Ω–æ–≤—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏"
```

#### –ë—ã—Å—Ç—Ä—ã–π patch —Ä–µ–ª–∏–∑
```powershell
# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞
.\scripts\release.ps1 bump -Type patch
```

### –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

#### –û—à–∏–±–∫–∞ "Python –Ω–µ –Ω–∞–π–¥–µ–Ω"
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Python –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ PATH
# https://www.python.org/downloads/
```

#### –û—à–∏–±–∫–∞ "Git –Ω–µ –Ω–∞–π–¥–µ–Ω"
```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Git
# https://git-scm.com/downloads
```

#### –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –≤–µ—Ä—Å–∏–π
```bash
# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ –≤–µ—Ä—Å–∏–∏
.\scripts\release.ps1 sync
```

#### –û—à–∏–±–∫–∞ –∫–æ–º–º–∏—Ç–∞
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ git —Å—Ç–∞—Ç—É—Å
git status

# –î–æ–±–∞–≤—å—Ç–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Ä—É—á–Ω—É—é
git add VERSION include/version.h platformio.ini
git commit -m "version: –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ X.X.X"
```

## üìã –î—Ä—É–≥–∏–µ —Å–∫—Ä–∏–ø—Ç—ã

### `auto_version.py`
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `include/version.h` –∏–∑ —Ñ–∞–π–ª–∞ `VERSION` –ø—Ä–∏ —Å–±–æ—Ä–∫–µ PlatformIO.

### `format_all.ps1`
–§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç –≤–µ—Å—å –∫–æ–¥ –ø—Ä–æ–µ–∫—Ç–∞.

### `gen_docs.ps1`
–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é —Å –ø–æ–º–æ—â—å—é Doxygen.

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø—ã

1. **–û–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã** - –≤—Å—è –ª–æ–≥–∏–∫–∞ –≤–µ—Ä—Å–∏–π –≤ `release_manager.py`
2. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏** - –ø–æ–¥–Ω—è—Ç–∏–µ –≤–µ—Ä—Å–∏–∏ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–ª–∏–∑–∞ –æ—Ç–¥–µ–ª—å–Ω–æ
3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - –º–∏–Ω–∏–º—É–º —Ä—É—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
4. **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å** - –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ 