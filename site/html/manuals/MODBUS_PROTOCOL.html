<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MODBUS RTU ะัะพัะพะบะพะป ะดะปั JXCT 7-ะฒ-1 ะะฐััะธะบะฐ ะะพัะฒั</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
            border-radius: 10px;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        .header {
            background: linear-gradient(135deg, #2e7d32 0%, #388e3c 100%);
            color: white;
            padding: 20px;
            border-radius: 10px 10px 0 0;
            margin: -20px -20px 20px -20px;
        }
        .navigation {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
        }
        .navigation a {
            color: #1976d2;
            text-decoration: none;
            margin-right: 15px;
            padding: 5px 10px;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        .navigation a:hover {
            background-color: #e3f2fd;
        }
        .content {
            padding: 20px 0;
        }
        h1, h2, h3, h4 {
            color: #2e7d32;
        }
        h1 {
            border-bottom: 3px solid #4caf50;
            padding-bottom: 10px;
        }
        h2 {
            border-bottom: 2px solid #81c784;
            padding-bottom: 5px;
            margin-top: 30px;
        }
        code {
            background: #f5f5f5;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        pre {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            border-left: 4px solid #4caf50;
        }
        .back-link {
            display: inline-block;
            margin-top: 20px;
            padding: 10px 20px;
            background: #4caf50;
            color: white;
            text-decoration: none;
            border-radius: 5px;
            transition: background-color 0.3s;
        }
        .back-link:hover {
            background: #388e3c;
        }
        .status-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9em;
            font-weight: bold;
        }
        .status-success { background: #4caf50; color: white; }
        .status-warning { background: #ff9800; color: white; }
        .status-error { background: #f44336; color: white; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MODBUS RTU ะัะพัะพะบะพะป ะดะปั JXCT 7-ะฒ-1 ะะฐััะธะบะฐ ะะพัะฒั</h1>
            <p>JXCT 7-ะฒ-1 ะะฐััะธะบ ะะพัะฒั - ะัะพัะตััะธะพะฝะฐะปัะฝะฐั IoT ัะธััะตะผะฐ ะผะพะฝะธัะพัะธะฝะณะฐ</p>
        </div>
        
        <div class="navigation">
            
        <a href="../../index.html">๐ ะะปะฐะฒะฝะฐั</a>
        <a href="USER_GUIDE.html">๐ ะัะบะพะฒะพะดััะฒะพ</a>
        <a href="TECHNICAL_DOCS.html">๐ง ะขะตัะฝะธัะตัะบะฐั ะดะพะบัะผะตะฝัะฐัะธั</a>
        <a href="API.html">๐ก API</a>
        <a href="../../html/index.html">๐ API ะดะพะบัะผะตะฝัะฐัะธั</a>
    
        </div>
        
        <div class="content">
            <h1>MODBUS RTU ะัะพัะพะบะพะป ะดะปั JXCT 7-ะฒ-1 ะะฐััะธะบะฐ ะะพัะฒั</h1>

<strong>ะะตััะธั:</strong> 3.4.9  
<strong>ะะฐัะฐ:</strong> ะัะฝั 2025  
<strong>ะะฒัะพั:</strong> JXCT Development Team

<p>---</p>

<h2>๐ ะกะพะดะตัะถะฐะฝะธะต</h2>

<p>1. <a href="#-ะพะฑะทะพั">๐ ะะฑะทะพั</a>
2. <a href="#-ัะตัะฝะธัะตัะบะธะต-ัะฐัะฐะบัะตัะธััะธะบะธ">๐ง ะขะตัะฝะธัะตัะบะธะต ัะฐัะฐะบัะตัะธััะธะบะธ</a>
3. <a href="#-ะบะฐััะฐ-ัะตะณะธัััะพะฒ">๐ ะะฐััะฐ ัะตะณะธัััะพะฒ</a>
4. <a href="#-ะฟัะธะผะตัั-ะฟัะพัะพะบะพะปะฐ">๐ ะัะธะผะตัั ะฟัะพัะพะบะพะปะฐ</a>
5. <a href="#-ััะตะผะฐ-ะฟะพะดะบะปััะตะฝะธั-esp32">๐ง ะกัะตะผะฐ ะฟะพะดะบะปััะตะฝะธั ESP32</a>
6. <a href="#-ะพะฟัะธะผะธะทะฐัะธั-ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ">โก ะะฟัะธะผะธะทะฐัะธั ะฟัะพะธะทะฒะพะดะธัะตะปัะฝะพััะธ</a>
7. <a href="#-ะพัะปะฐะดะบะฐ-ะธ-ะดะธะฐะณะฝะพััะธะบะฐ">๐ ะัะปะฐะดะบะฐ ะธ ะดะธะฐะณะฝะพััะธะบะฐ</a>
8. <a href="#-ะฑะตะทะพะฟะฐัะฝะพััั">๐ ะะตะทะพะฟะฐัะฝะพััั</a>
9. <a href="#-ัะฒัะทะฐะฝะฝะฐั-ะดะพะบัะผะตะฝัะฐัะธั">๐ ะกะฒัะทะฐะฝะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั</a></p>

---

<h2>๐ ะะฑะทะพั</h2>

<p>ะะฐััะธะบ JXCT 7-ะฒ-1 ะธัะฟะพะปัะทัะตั ะฟัะพัะพะบะพะป <strong>Modbus RTU</strong> ัะตัะตะท ะธะฝัะตััะตะนั <strong>RS485</strong> ะดะปั ะฟะตัะตะดะฐัะธ ะดะฐะฝะฝัั ะธะทะผะตัะตะฝะธะน ะฟะพัะฒั. ะญัะพั ะดะพะบัะผะตะฝั ัะพะดะตัะถะธั ะฟะพะปะฝัั ัะตัะฝะธัะตัะบัั ัะฟะตัะธัะธะบะฐัะธั ะฟัะพัะพะบะพะปะฐ.</p>

<h2>๐ง ะขะตัะฝะธัะตัะบะธะต ัะฐัะฐะบัะตัะธััะธะบะธ</h2>

<h3>ะะฐัััะพะนะบะธ ะฟะพััะฐ (UART2)</h3>
<code></code>`
ะะฐัะฐะผะตัั            โ ะะฝะฐัะตะฝะธะต
โโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโ
ะกะบะพัะพััั ะฟะตัะตะดะฐัะธ   โ 9600 baud
ะะธัั ะดะฐะฝะฝัั         โ 8 bits
ะงะตัะฝะพััั            โ None (N)
ะกัะพะฟ ะฑะธัั           โ 1 bit
ะฃะฟัะฐะฒะปะตะฝะธะต ะฟะพัะพะบะพะผ  โ None
ะคะพัะผะฐั              โ 8N1
ะะฝัะตััะตะนั           โ RS485 ะฟะพะปัะดัะฟะปะตะบั
<code></code>`

<h3>ะะฐัะฐะผะตััั MODBUS</h3>
<code></code>`
ะะฐัะฐะผะตัั                โ ะะฝะฐัะตะฝะธะต
โโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโ
ะัะพัะพะบะพะป                โ Modbus RTU
ะะดัะตั ััััะพะนััะฒะฐ        โ 1 (ะฟะพ ัะผะพะปัะฐะฝะธั, ะฝะฐัััะฐะธะฒะฐะตััั)
ะคัะฝะบัะธั ััะตะฝะธั          โ 0x03 (Read Holding Registers)
ะคัะฝะบัะธั ะทะฐะฟะธัะธ          โ 0x06 (Write Single Register)
ะขะฐะนะผะฐัั ะพัะฒะตัะฐ          โ 1000 ะผั
ะะฐะบัะธะผัะผ ะฟะพะฟััะพะบ        โ 3
ะะฝัะตััะตะนั               โ RS485 ะฟะพะปัะดัะฟะปะตะบั
<code></code>`

<h2>๐ ะะฐััะฐ ัะตะณะธัััะพะฒ</h2>

<h3>ะัะฝะพะฒะฝัะต ะธะทะผะตัะตะฝะธั</h3>
<code></code>`
ะะตะณะธััั โ ะะดัะตั โ ะะฐัะฐะผะตัั           โ ะคะพัะผัะปะฐ        โ ะะดะธะฝะธัั โ ะะธะฐะฟะฐะทะพะฝ
โโโโโโโโโผโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโผโโโโโโโโโโผโโโโโโโโโโโโโโ
0x0006  โ 6     โ pH ะฟะพัะฒั           โ ะทะฝะฐัะตะฝะธะต รท 100 โ pH      โ 0.00-14.00
0x0012  โ 18    โ ะะปะฐะถะฝะพััั ะฟะพัะฒั    โ ะทะฝะฐัะตะฝะธะต รท 10  โ %       โ 0.0-100.0
0x0013  โ 19    โ ะขะตะผะฟะตัะฐัััะฐ ะฟะพัะฒั  โ ะทะฝะฐัะตะฝะธะต รท 10  โ ยฐC      โ -10.0-50.0
0x0015  โ 21    โ ะญะปะตะบััะพะฟัะพะฒะพะดะฝะพััั โ ะบะฐะบ ะตััั       โ ยตS/cm   โ 0-20000
0x001E  โ 30    โ ะะทะพั (N)           โ ะบะฐะบ ะตััั       โ ะผะณ/ะบะณ   โ 0-2000
0x001F  โ 31    โ ะคะพััะพั (P)         โ ะบะฐะบ ะตััั       โ ะผะณ/ะบะณ   โ 0-2000
0x0020  โ 32    โ ะะฐะปะธะน (K)          โ ะบะฐะบ ะตััั       โ ะผะณ/ะบะณ   โ 0-2000
<code></code>`

<h3>ะกะธััะตะผะฝัะต ัะตะณะธัััั</h3>
<code></code>`
ะะตะณะธััั โ ะะดัะตั โ ะะฐัะฐะผะตัั           โ ะคะพัะผัะปะฐ        โ ะะดะธะฝะธัั โ ะะพัััะฟ
โโโโโโโโโผโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโผโโโโโโโโโโผโโโโโโโโโโโโ
0x0007  โ 7     โ ะะตััะธั ะฟัะพัะธะฒะบะธ    โ ะบะฐะบ ะตััั       โ ะฒะตััะธั  โ ะขะพะปัะบะพ ััะตะฝะธะต
0x0008  โ 8     โ ะะฐะปะธะฑัะพะฒะบะฐ         โ ะบะฐะบ ะตััั       โ ัะปะฐะณะธ   โ ะงัะตะฝะธะต/ะทะฐะฟะธัั
0x000B  โ 11    โ ะกัะฐััั ะพัะธะฑะพะบ      โ ะบะฐะบ ะตััั       โ ัะปะฐะณะธ   โ ะขะพะปัะบะพ ััะตะฝะธะต
0x000C  โ 12    โ ะะดัะตั ััััะพะนััะฒะฐ   โ ะบะฐะบ ะตััั       โ ะฐะดัะตั   โ ะงัะตะฝะธะต/ะทะฐะฟะธัั
<code></code>`

<h2>๐ ะัะธะผะตัั ะฟัะพัะพะบะพะปะฐ</h2>

<h3>1. ะงัะตะฝะธะต pH ะฟะพัะฒั (ัะตะณะธััั 0x0006)</h3>

<strong>ะะฐะฟัะพั:</strong>
<code></code>`
ะะฐะนั โ Hex โ ะะฟะธัะฐะฝะธะต
โโโโโโผโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
0    โ 01  โ ะะดัะตั ััััะพะนััะฒะฐ (1)
1    โ 03  โ ะคัะฝะบัะธั (Read Holding Registers)
2    โ 00  โ ะะดัะตั ัะตะณะธัััะฐ (High byte)
3    โ 06  โ ะะดัะตั ัะตะณะธัััะฐ (Low byte) - 0x0006
4    โ 00  โ ะะพะปะธัะตััะฒะพ ัะตะณะธัััะพะฒ (High byte)
5    โ 01  โ ะะพะปะธัะตััะฒะพ ัะตะณะธัััะพะฒ (Low byte) - 1
6    โ 64  โ CRC16 (High byte)
7    โ 0B  โ CRC16 (Low byte)
<code></code>`

<strong>ะัะฒะตั:</strong>
<code></code>`
ะะฐะนั โ Hex โ ะะฟะธัะฐะฝะธะต
โโโโโโผโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
0    โ 01  โ ะะดัะตั ััััะพะนััะฒะฐ (1)
1    โ 03  โ ะคัะฝะบัะธั (Read Holding Registers)
2    โ 02  โ ะะพะปะธัะตััะฒะพ ะฑะฐะนั ะดะฐะฝะฝัั (2)
3    โ 02  โ ะะฝะฐัะตะฝะธะต pH (High byte)
4    โ BC  โ ะะฝะฐัะตะฝะธะต pH (Low byte)
5    โ 38  โ CRC16 (High byte)
6    โ 05  โ CRC16 (Low byte)
<code></code>`

<strong>ะะฐััะตั ะทะฝะฐัะตะฝะธั:</strong>
<code></code>`
Hex ะทะฝะฐัะตะฝะธะต: 0x02BC = 700 (decimal)
pH = 700 รท 100 = 7.00
<code></code>`

<h3>2. ะงัะตะฝะธะต ัะตะผะฟะตัะฐัััั ะฟะพัะฒั (ัะตะณะธััั 0x0013)</h3>

<strong>ะะฐะฟัะพั:</strong>
<code></code>`
01 03 00 13 00 01 74 0F
<code></code>`

<strong>ะัะฒะตั:</strong>
<code></code>`
01 03 02 00 ED 78 B8
<code></code>`

<strong>ะะฐััะตั ะทะฝะฐัะตะฝะธั:</strong>
<code></code>`
Hex ะทะฝะฐัะตะฝะธะต: 0x00ED = 237 (decimal)
ะขะตะผะฟะตัะฐัััะฐ = 237 รท 10 = 23.7ยฐC
<code></code>`

<h3>3. ะงัะตะฝะธะต ะฝะตัะบะพะปัะบะธั ัะตะณะธัััะพะฒ (NPK)</h3>

<strong>ะะฐะฟัะพั (ัะตะณะธัััั 0x001E-0x0020):</strong>
<code></code>`
01 03 00 1E 00 03 65 CC
<code></code>`

<strong>ะัะฒะตั:</strong>
<code></code>`
01 03 06 01 5E 01 F3 03 D6 XX XX
<code></code>`

<strong>ะะฐััะตั ะทะฝะฐัะตะฝะธะน:</strong>
<code></code>`
ะะทะพั (N):    0x015E = 350 ะผะณ/ะบะณ
ะคะพััะพั (P):  0x01F3 = 499 ะผะณ/ะบะณ  
ะะฐะปะธะน (K):   0x03D6 = 982 ะผะณ/ะบะณ
<code></code>`

<h2>๐ง ะกัะตะผะฐ ะฟะพะดะบะปััะตะฝะธั ESP32</h2>

<h3>ะคะธะทะธัะตัะบะพะต ะฟะพะดะบะปััะตะฝะธะต</h3>

<p>#### RS-485 ะธะฝัะตััะตะนั<ul>
<li>ะัะฟะพะปัะทัะตััั ััะฐะฝัะธะฒะตั SP3485E</li>
</ul><li>ะกะบะพัะพััั ะฟะตัะตะดะฐัะธ: ะดะพ 10 Mbps</li><ul>
<li>ะะฐัะธัะฐ ะพั ESD: ยฑ15kV HBM</li>
</ul><li>ะะธัะฐะฝะธะต: 3.3V (ะพะฟัะธะผะฐะปัะฝะพ ะดะปั ESP32)</li></p>

#### ะะพะดะบะปััะตะฝะธะต SP3485E
<code></code>`
ESP32 GPIO   โ SP3485E Pin โ ะคัะฝะบัะธั
โโโโโโโโโโโโโโผโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
GPIO16       โ RO         โ Receive Output (ะบ UART RX)
GPIO17       โ DI         โ Data Input (ะพั UART TX)
GPIO4        โ DE         โ Driver Enable (ัะฟัะฐะฒะปะตะฝะธะต ะฟะตัะตะดะฐััะธะบะพะผ)
GPIO5        โ RE         โ Receiver Enable (ัะฟัะฐะฒะปะตะฝะธะต ะฟัะธะตะผะฝะธะบะพะผ)
GND          โ GND        โ ะะฑัะธะน ะฟัะพะฒะพะด
3.3V         โ VCC        โ ะะธัะฐะฝะธะต ะผะพะดัะปั
<code></code>`

<p>#### ะะฐะถะฝะพััั ัะฐะทะดะตะปัะฝะพะณะพ ัะฟัะฐะฒะปะตะฝะธั DE ะธ RE<ul>
<li><strong>DE (Driver Enable)</strong> - ัะฟัะฐะฒะปัะตั ะฟะตัะตะดะฐััะธะบะพะผ:</li>
</ul>  - HIGH: ะฟะตัะตะดะฐััะธะบ ะฐะบัะธะฒะตะฝ (ะดะปั ะพัะฟัะฐะฒะบะธ ะดะฐะฝะฝัั)
  - LOW: ะฟะตัะตะดะฐััะธะบ ะฒ ะฒััะพะบะพะธะผะฟะตะดะฐะฝัะฝะพะผ ัะพััะพัะฝะธะธ<ul>
<li><strong>RE (Receiver Enable)</strong> - ัะฟัะฐะฒะปัะตั ะฟัะธะตะผะฝะธะบะพะผ:</li>
</ul>  - HIGH: ะฟัะธะตะผะฝะธะบ ะพัะบะปััะตะฝ (ะฒะพ ะฒัะตะผั ะฟะตัะตะดะฐัะธ)
  - LOW: ะฟัะธะตะผะฝะธะบ ะฐะบัะธะฒะตะฝ (ะดะปั ะฟัะธะตะผะฐ ะดะฐะฝะฝัั)</p>

ะะฐะทะดะตะปัะฝะพะต ัะฟัะฐะฒะปะตะฝะธะต ััะธะผะธ ะฟะธะฝะฐะผะธ ะพะฑะตัะฟะตัะธะฒะฐะตั:
1. ะะพะปะตะต ัะพัะฝัะน ะบะพะฝััะพะปั ะฝะฐะด ะฒัะตะผะตะฝะตะผ ะฟะตัะตะบะปััะตะฝะธั
2. ะะพะทะผะพะถะฝะพััั ัะพะฝะบะพะน ะฝะฐัััะพะนะบะธ ะทะฐะดะตัะถะตะบ
3. ะัะตะดะพัะฒัะฐัะตะฝะธะต ะบะพะปะปะธะทะธะน ะฝะฐ ัะธะฝะต RS-485
4. ะฃะปัััะตะฝะฝัั ะฟะพะผะตัะพะทะฐัะธัะตะฝะฝะพััั

<p>#### ะัะตะผะตะฝะฝัะต ะดะธะฐะณัะฐะผะผั ะฟะตัะตะบะปััะตะฝะธั</p>

<code></code>`
DE โโโ          โโโโโโโโโโ          โโโโโโโโโ
     โ          โ        โ          โ
     โโโโโโโโโโโโ        โโโโโโโโโโโโ

<p>RE โโโ          โโโโโโโโโโ          โโโโโโโโโ
     โ          โ        โ          โ
     โโโโโโโโโโโโ        โโโโโโโโโโโโ
     โโ ะฟัะธะตะผ โโโคโโ ะฟะตัะตะดะฐัะฐ โโคโโ ะฟัะธะตะผ โโโค
     
     โโโ 50ยตs โโบโ          โโโ 50ยตs โโบโ
<code></code>`</p>

ะะฐะดะตัะถะบะธ ะฟะตัะตะบะปััะตะฝะธั:<ul>
<li>50 ะผะธะบัะพัะตะบัะฝะด ะฟะตัะตะด ะฟะตัะตะดะฐัะตะน (preTransmission)</li>
</ul><li>50 ะผะธะบัะพัะตะบัะฝะด ะฟะพัะปะต ะฟะตัะตะดะฐัะธ (postTransmission)</li>

<h3>ะะพะดะบะปััะตะฝะธะต ะบ ะดะฐััะธะบั JXCT</h3>
<code></code>`
Transceiver  โ JXCT Sensor โ ะฆะฒะตั ะฟัะพะฒะพะดะฐ โ ะคัะฝะบัะธั
โโโโโโโโโโโโโโผโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโ
A+ Terminal  โ A+          โ ะะตะปััะน       โ RS485 Data+
B- Terminal  โ B-          โ ะกะธะฝะธะน        โ RS485 Data-
<code></code>`

<h3>ะะธัะฐะฝะธะต ะดะฐััะธะบะฐ (ะพัะดะตะปัะฝะพะต!)</h3>
<code></code>`
ะััะพัะฝะธะบ     โ JXCT Sensor โ ะฆะฒะตั ะฟัะพะฒะพะดะฐ โ ะคัะฝะบัะธั
โโโโโโโโโโโโโโผโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโ
12-24V DC+   โ VCC         โ ะัะฐัะฝัะน      โ ะะธัะฐะฝะธะต ะดะฐััะธะบะฐ
GND          โ GND         โ ะงะตัะฝัะน       โ ะะฑัะธะน ะผะธะฝัั
<code></code>`

<h2>โ๏ธ ะะตะฐะปะธะทะฐัะธั ะฒ ะบะพะดะต ESP32</h2>

<h3>ะะฝะธัะธะฐะปะธะทะฐัะธั UART ะธ SP3485E</h3>

<code></code>`cpp
void setupModbus() {
    // ะะฐัััะพะนะบะฐ UART2 ะดะปั Modbus
    Serial2.begin(9600, SERIAL_8N1, MODBUS_RX_PIN, MODBUS_TX_PIN);
    
    // ะะฐัััะพะนะบะฐ ะฟะธะฝะพะฒ SP3485E
    pinMode(MODBUS_DE_PIN, OUTPUT);    // GPIO4
    pinMode(MODBUS_RE_PIN, OUTPUT);    // GPIO5
    digitalWrite(MODBUS_DE_PIN, LOW);  // ะะตัะตะดะฐััะธะบ ะฒัะบะปััะตะฝ
    digitalWrite(MODBUS_RE_PIN, LOW);  // ะัะธะตะผะฝะธะบ ะฒะบะปััะตะฝ
    
    // ะะฝะธัะธะฐะปะธะทะฐัะธั Modbus
    node.begin(SENSOR_ID, Serial2);
    
    // ะะฐัััะพะนะบะฐ ะพะฑัะฐะฑะพััะธะบะพะฒ ะฟะตัะตะบะปััะตะฝะธั ัะตะถะธะผะฐ
    node.preTransmission(preTransmission);   // ะะตัะตะด ะฟะตัะตะดะฐัะตะน
    node.postTransmission(postTransmission); // ะะพัะปะต ะฟะตัะตะดะฐัะธ
}

<p>// ะฃะฟัะฐะฒะปะตะฝะธะต ะฝะฐะฟัะฐะฒะปะตะฝะธะตะผ ะฟะตัะตะดะฐัะธ SP3485E
void preTransmission() {
    digitalWrite(MODBUS_DE_PIN, HIGH);  // ะะตะถะธะผ ะฟะตัะตะดะฐัะธ
    delayMicroseconds(50);
}</p>

void postTransmission() {
    delayMicroseconds(50);
    digitalWrite(MODBUS_RE_PIN, LOW);   // ะะตะถะธะผ ะฟัะธะตะผะฐ
}
<code></code>`

<h3>ะงัะตะฝะธะต ะดะฐะฝะฝัั</h3>
<code></code>`cpp
void readSensorData() {
    // ะงัะตะฝะธะต pH
    uint8_t result = modbus.readHoldingRegisters(0x0006, 1);
    if (result == modbus.ku8MBSuccess) {
        uint16_t ph_raw = modbus.getResponseBuffer(0);
        float ph = ph_raw / 100.0;
    }
    
    // ะงัะตะฝะธะต ัะตะผะฟะตัะฐัััั
    result = modbus.readHoldingRegisters(0x0013, 1);
    if (result == modbus.ku8MBSuccess) {
        uint16_t temp_raw = modbus.getResponseBuffer(0);
        float temperature = temp_raw / 10.0;
    }
    
    // ะงัะตะฝะธะต NPK (3 ัะตะณะธัััะฐ ะทะฐ ะพะดะธะฝ ะทะฐะฟัะพั)
    result = modbus.readHoldingRegisters(0x001E, 3);
    if (result == modbus.ku8MBSuccess) {
        uint16_t nitrogen = modbus.getResponseBuffer(0);
        uint16_t phosphorus = modbus.getResponseBuffer(1);
        uint16_t potassium = modbus.getResponseBuffer(2);
    }
}
<code></code>`

<h2>๐๏ธ ะะธะฐะณะฝะพััะธะบะฐ ะธ ะพัะปะฐะดะบะฐ</h2>

<h3>ะะพะดั ะพัะธะฑะพะบ ModbusMaster</h3>
<code></code>`
ะะพะด โ ะะพะฝััะฐะฝัะฐ              โ ะะฟะธัะฐะฝะธะต
โโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
0   โ ku8MBSuccess           โ ะฃัะฟะตัะฝะพะต ะฒัะฟะพะปะฝะตะฝะธะต
1   โ ku8MBIllegalFunction   โ ะะตะดะพะฟัััะธะผะฐั ััะฝะบัะธั
2   โ ku8MBIllegalDataAddressโ ะะตะดะพะฟัััะธะผัะน ะฐะดัะตั ะดะฐะฝะฝัั
3   โ ku8MBIllegalDataValue  โ ะะตะดะพะฟัััะธะผะพะต ะทะฝะฐัะตะฝะธะต ะดะฐะฝะฝัั
4   โ ku8MBSlaveDeviceFailureโ ะัะธะฑะบะฐ ะฒะตะดะพะผะพะณะพ ััััะพะนััะฒะฐ
224 โ ku8MBInvalidSlaveID    โ ะะตะดะพะฟัััะธะผัะน ID ััััะพะนััะฒะฐ
225 โ ku8MBInvalidFunction   โ ะะตะดะพะฟัััะธะผะฐั ััะฝะบัะธั
226 โ ku8MBResponseTimedOut  โ ะขะฐะนะผะฐัั ะพัะฒะตัะฐ
227 โ ku8MBInvalidCRC        โ ะัะธะฑะบะฐ CRC
<code></code>`

<h3>ะัะพะฒะตัะบะฐ ัะฒัะทะธ</h3>
<code></code>`cpp
bool testModbusConnection() {
    logSystem("ะขะตัั ัะฒัะทะธ ั ะดะฐััะธะบะพะผ JXCT...");
    
    // ะะพะฟััะบะฐ ััะตะฝะธั ะฒะตััะธะธ ะฟัะพัะธะฒะบะธ
    uint8_t result = modbus.readHoldingRegisters(0x0007, 1);
    
    if (result == modbus.ku8MBSuccess) {
        uint16_t version = modbus.getResponseBuffer(0);
        logSuccess("ะะฐััะธะบ ะฝะฐะนะดะตะฝ! ะะตััะธั ะฟัะพัะธะฒะบะธ: %d.%d", 
                  (version >> 8) & 0xFF, version & 0xFF);
        return true;
    } else {
        logError("ะัะธะฑะบะฐ ัะฒัะทะธ ั ะดะฐััะธะบะพะผ: %d", result);
        return false;
    }
}
<code></code>`

<h2>๐ ะะฐััะตั CRC16</h2>

<p>MODBUS RTU ะธัะฟะพะปัะทัะตั CRC16 ั ะฟะพะปะธะฝะพะผะพะผ 0xA001:</p>

<code></code>`cpp
uint16_t calculateCRC16(uint8_t* data, size_t length) {
    uint16_t crc = 0xFFFF;
    
    for (size_t i = 0; i < length; i++) {
        crc ^= (uint16_t)data[i];
        for (int j = 0; j < 8; j++) {
            if (crc & 0x0001) {
                crc = (crc >> 1) ^ 0xA001;
            } else {
                crc = crc >> 1;
            }
        }
    }
    
    return crc;
}
<code></code>`

<h2>๐จ ะขะธะฟะธัะฝัะต ะฟัะพะฑะปะตะผั ะธ ัะตัะตะฝะธั</h2>

<h3>1. ะขะฐะนะผะฐัั ะพัะฒะตัะฐ (ku8MBResponseTimedOut)</h3>
<strong>ะัะธัะธะฝั:</strong><ul>
<li>ะะตะฟัะฐะฒะธะปัะฝะพะต ะฟะพะดะบะปััะตะฝะธะต A+/B-</li>
</ul><li>ะะตะธัะฟัะฐะฒะฝะพััั ะบะฐะฑะตะปั RS485</li><ul>
<li>ะะตะฟัะฐะฒะธะปัะฝัะน ะฐะดัะตั ััััะพะนััะฒะฐ</li>
</ul><li>ะัะพะฑะปะตะผั ั ะฟะธัะฐะฝะธะตะผ ะดะฐััะธะบะฐ</li>

<strong>ะะตัะตะฝะธะต:</strong>
<code></code>`cpp
// ะัะพะฒะตัะบะฐ ะฟะพะดะบะปััะตะฝะธั
if (!testModbusConnection()) {
    logError("ะัะพะฒะตัััะต ะฟะพะดะบะปััะตะฝะธะต RS485 ะธ ะฟะธัะฐะฝะธะต ะดะฐััะธะบะฐ");
}
<code></code>`

<h3>2. ะัะธะฑะบะฐ CRC (ku8MBInvalidCRC)</h3>
<strong>ะัะธัะธะฝั:</strong><ul>
<li>ะะพะผะตัะธ ะฒ ะปะธะฝะธะธ RS485</li>
</ul><li>ะะปะพัะพะต ะบะฐัะตััะฒะพ ะบะฐะฑะตะปั</li><ul>
<li>ะะตะฟัะฐะฒะธะปัะฝะฐั ัะบะพัะพััั ะฟะตัะตะดะฐัะธ</li>
</ul>
<strong>ะะตัะตะฝะธะต:</strong><ul>
<li>ะัะฟะพะปัะทะพะฒะฐัั ัะบัะฐะฝะธัะพะฒะฐะฝะฝัะน ะบะฐะฑะตะปั</li>
</ul><li>ะัะพะฒะตัะธัั ะทะฐะทะตะผะปะตะฝะธะต</li><ul>
<li>ะะพะฑะฐะฒะธัั ัะตัะผะธะฝะฐะปัะฝัะต ัะตะทะธััะพัั (120 ะะผ)</li>
</ul>
<h3>3. ะะตะดะพะฟัััะธะผัะน ะฐะดัะตั ะดะฐะฝะฝัั (ku8MBIllegalDataAddress)</h3>
<strong>ะัะธัะธะฝั:</strong><ul>
<li>ะะฐะฟัะพั ะฝะตัััะตััะฒัััะตะณะพ ัะตะณะธัััะฐ</li>
</ul><li>ะะฐะทะปะธัะธั ะฒ ะฒะตััะธัั ะฟัะพัะธะฒะบะธ ะดะฐััะธะบะฐ</li>

<strong>ะะตัะตะฝะธะต:</strong>
<code></code>`cpp
// ะัะพะฒะตัะบะฐ ะฟะพะดะดะตัะถะธะฒะฐะตะผัั ัะตะณะธัััะพะฒ
const uint16_t test_registers[] = {0x0006, 0x0012, 0x0013, 0x0015};
for (int i = 0; i < 4; i++) {
    uint8_t result = modbus.readHoldingRegisters(test_registers[i], 1);
    if (result != modbus.ku8MBSuccess) {
        logWarn("ะะตะณะธััั 0x%04X ะฝะตะดะพัััะฟะตะฝ: %d", test_registers[i], result);
    }
}
<code></code>`

<h2>๐ ะะฐะปะธะดะฐัะธั ะดะฐะฝะฝัั</h2>

<h3>ะะพะฟัััะธะผัะต ะดะธะฐะฟะฐะทะพะฝั</h3>
<code></code>`cpp
bool validateSensorData(SensorData& data) {
    // ะขะตะผะฟะตัะฐัััะฐ: -10ยฐC ะดะพ +50ยฐC
    if (data.temperature < -10.0 || data.temperature > 50.0) return false;
    
    // ะะปะฐะถะฝะพััั: 0% ะดะพ 100%
    if (data.humidity < 0.0 || data.humidity > 100.0) return false;
    
    // pH: 0 ะดะพ 14
    if (data.ph < 0.0 || data.ph > 14.0) return false;
    
    // EC: 0 ะดะพ 20000 ยตS/cm
    if (data.ec < 0.0 || data.ec > 20000.0) return false;
    
    // NPK: 0 ะดะพ 2000 ะผะณ/ะบะณ
    if (data.nitrogen < 0.0 || data.nitrogen > 2000.0) return false;
    if (data.phosphorus < 0.0 || data.phosphorus > 2000.0) return false;
    if (data.potassium < 0.0 || data.potassium > 2000.0) return false;
    
    return true;
}
<code></code>`

<h2>๐ ะกะฟัะฐะฒะพัะฝะฐั ะธะฝัะพัะผะฐัะธั</h2>

<h3>ะะพะบัะผะตะฝัะฐัะธั ะฟัะพะธะทะฒะพะดะธัะตะปั</h3><ul>
<li><strong>ะัะพะธะทะฒะพะดะธัะตะปั:</strong> JXCT (Jingxun Changtong)</li>
</ul><li><strong>ะะพะดะตะปั:</strong> JXBS-3001 7-in-1 Soil Sensor</li><ul>
<li><strong>ะะฝัะตััะตะนั:</strong> RS485 Modbus RTU</li>
</ul><li><strong>ะะธัะฐะฝะธะต:</strong> 12-24V DC</li><ul>
<li><strong>ะัะพัะพะบะพะป:</strong> Modbus RTU</li>
</ul>
<h3>ะกะฒัะทะฐะฝะฝัะต ัะฐะนะปั ะฟัะพะตะบัะฐ</h3><ul>
<li><code>src/modbus_sensor.h</code> - ะะฟัะตะดะตะปะตะฝะธั ะบะพะฝััะฐะฝั ะธ ััััะบััั</li>
</ul><li><code>src/modbus_sensor.cpp</code> - ะะตะฐะปะธะทะฐัะธั ััะฝะบัะธะน</li><ul>
<li><code>include/jxct_config_vars.h</code> - ะะฐัััะพะนะบะธ ะฟะธะฝะพะฒ</li>
</ul><li><code>docs/API.md</code> - REST API ะดะพะบัะผะตะฝัะฐัะธั</li>

<p>---</p>

<em>ะะพะบัะผะตะฝั ะพะฑะฝะพะฒะปะตะฝ ะดะปั ะฒะตััะธะธ JXCT v2.4.3</em>

<h2>๐ ะะพะดะดะตัะถะบะฐ</h2>

<h3>๐ฌ ะกะฒัะทั ั ัะฐะทัะฐะฑะพััะธะบะฐะผะธ</h3><ul>
<li><strong>Telegram:</strong> <a href="https://t.me/Gfermoto">@Gfermoto</a></li>
</ul><li><strong>GitHub Issues:</strong> <a href="https://github.com/Gfermoto/soil-sensor-7in1/issues">ะกะพะพะฑัะธัั ะพ ะฟัะพะฑะปะตะผะต</a></li><ul>
<li><strong>ะะพะบัะผะตะฝัะฐัะธั:</strong> <a href="https://gfermoto.github.io/soil-sensor-7in1/">GitHub Pages</a></li>
</ul>
<h3>๐ ะะพะฟะพะปะฝะธัะตะปัะฝัะต ัะตััััั</h3><ul>
<li><a href="USER_GUIDE.md">ะัะบะพะฒะพะดััะฒะพ ะฟะพะปัะทะพะฒะฐัะตะปั</a></li>
</ul><li><a href="TECHNICAL_DOCS.md">ะขะตัะฝะธัะตัะบะฐั ะดะพะบัะผะตะฝัะฐัะธั</a></li><ul>
<li><a href="AGRO_RECOMMENDATIONS.md">ะะณัะพะฝะพะผะธัะตัะบะธะต ัะตะบะพะผะตะฝะดะฐัะธะธ</a></li>
</ul><li><a href="COMPENSATION_GUIDE.md">ะัะบะพะฒะพะดััะฒะพ ะฟะพ ะบะพะผะฟะตะฝัะฐัะธะธ</a></li><ul>
<li><a href="API.md">API ะดะพะบัะผะตะฝัะฐัะธั</a></li>
</ul><li><a href="CONFIG_MANAGEMENT.md">ะฃะฟัะฐะฒะปะตะฝะธะต ะบะพะฝัะธะณััะฐัะธะตะน</a></li><ul>
<li><a href="WIRING_DIAGRAM.md">ะกัะตะผะฐ ะฟะพะดะบะปััะตะฝะธั</a></li>
</ul><li><a href="VERSION_MANAGEMENT.md">ะฃะฟัะฐะฒะปะตะฝะธะต ะฒะตััะธัะผะธ</a></li>

<h3>๐ ะะพะปะตะทะฝัะต ัััะปะบะธ</h3>
<ul>
<li><a href="https://github.com/Gfermoto/soil-sensor-7in1">๐ฑ GitHub ัะตะฟะพะทะธัะพัะธะน</a> - ะััะพะดะฝัะน ะบะพะด ะฟัะพะตะบัะฐ</li>
</ul><li><a href="../dev/QA_REFACTORING_PLAN_2025H2.md">๐ ะะปะฐะฝ ัะตัะฐะบัะพัะธะฝะณะฐ</a> - ะะปะฐะฝั ัะฐะทะฒะธัะธั ะฝะฐ 2025</li><ul>
<li><a href="../dev/TECH_DEBT_REPORT_2025-06.md">๐ ะััะตั ะพ ัะตัะฝะธัะตัะบะพะผ ะดะพะปะณะต</a> - ะะฝะฐะปะธะท ัะตัะฝะธัะตัะบะธั ะฟัะพะฑะปะตะผ</li>
</ul><li><a href="../dev/ARCH_OVERALL.md">๐๏ธ ะััะธัะตะบัััะฐ ัะธััะตะผั</a> - ะะฑัะฐั ะฐััะธัะตะบัััะฐ ะฟัะพะตะบัะฐ </li>
        </div>
        
        <a href="../../index.html" class="back-link">โ ะะตัะฝััััั ะฝะฐ ะณะปะฐะฒะฝัั</a>
    </div>
</body>
</html>